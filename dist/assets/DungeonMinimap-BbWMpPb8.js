import{p as z,G as R,z as E,i,B as F,C as W,m as B,c as Y,f as D,h as q,H,K,s as N,a as j,t as G,r as Z,y as u,l as J,j as X}from"./threlte-Cn4q_HKN.js";import{f as Q}from"./main-B6bQ8p85.js";import"./threejs-D-3vx0wo.js";import"./vendor-CHMVvq2h.js";/* empty css            */var U=J('<div class="dungeon-minimap svelte-753byz"><canvas class="svelte-753byz"></canvas> <div class="money-display svelte-753byz"> </div></div>');function ie(L,e){z(e,!0);const v=R(e,"visible",3,!0),P=R(e,"money",3,0),s=220,C="#ffffff",O="#ffd700",S="#cc44ff",m=.3,T="#3a3a3a",V="#c8b89a";let c=q(void 0);const l=u(()=>Math.min(s/e.width,s/e.height)),y=u(()=>(s-e.width*i(l))/2),h=u(()=>(s-e.height*i(l))/2);function A(a){return Q.get(a)??!1?V:T}function M(a){a.clearRect(0,0,s,s),a.fillStyle="rgba(0, 0, 0, 0)",a.fillRect(0,0,s,s),a.globalAlpha=m;for(let t=0;t<e.height;t++)for(let n=0;n<e.width;n++)if(!e.explorationTracker.isVisible(n,t,e.playerX,e.playerY)&&e.explorationTracker.isVisited(n,t)){const o=e.tiles[t][n];a.fillStyle=A(o),a.fillRect(i(y)+n*i(l),i(h)+t*i(l),i(l),i(l))}a.globalAlpha=1;for(let t=0;t<e.height;t++)for(let n=0;n<e.width;n++)if(e.explorationTracker.isVisible(n,t,e.playerX,e.playerY)){const o=e.tiles[t][n];a.fillStyle=A(o),a.fillRect(i(y)+n*i(l),i(h)+t*i(l),i(l),i(l))}if(e.stairsX!==void 0&&e.stairsY!==void 0){const t=e.explorationTracker.isVisible(e.stairsX,e.stairsY,e.playerX,e.playerY),n=e.explorationTracker.isVisited(e.stairsX,e.stairsY);if(t||n){a.globalAlpha=t?1:m,a.fillStyle=O;const o=i(y)+e.stairsX*i(l)+i(l)/2,b=i(h)+e.stairsY*i(l)+i(l)/2,g=Math.max(i(l)*.6,2);a.beginPath(),a.arc(o,b,g,0,Math.PI*2),a.fill(),a.globalAlpha=1}}if(e.legendaryPortals)for(const t of e.legendaryPortals){const n=e.explorationTracker.isVisible(t.x,t.y,e.playerX,e.playerY),o=e.explorationTracker.isVisited(t.x,t.y);if(n||o){a.globalAlpha=n?1:m,a.fillStyle=S;const b=i(y)+t.x*i(l)+i(l)/2,g=i(h)+t.y*i(l)+i(l)/2,I=Math.max(i(l)*.6,2);a.beginPath(),a.arc(b,g,I,0,Math.PI*2),a.fill(),a.globalAlpha=1}}a.fillStyle=C;const r=i(y)+e.playerX*i(l)+i(l)/2,f=i(h)+e.playerY*i(l)+i(l)/2,d=Math.max(i(l)*.7,2.5);a.beginPath(),a.arc(r,f,d,0,Math.PI*2),a.fill(),a.fillStyle="#ffffff",a.font="10px monospace",a.textAlign="right",a.textBaseline="top",a.fillText(`F${e.floorNumber}`,24,4)}E(()=>{if(!i(c)||!v())return;const a=window.devicePixelRatio||1;i(c).width=s*a,i(c).height=s*a;const r=i(c).getContext("2d");if(!r)return;r.scale(a,a);let f,d=-1,t=-1;function n(){r&&((e.playerX!==d||e.playerY!==t)&&(d=e.playerX,t=e.playerY,M(r)),f=requestAnimationFrame(n))}return f=requestAnimationFrame(n),()=>{cancelAnimationFrame(f)}});var _=F(),k=W(_);{var w=a=>{var r=U(),f=X(r);H(f,"width: 220px; height: 220px;"),K(f,n=>N(c,n),()=>i(c));var d=j(f,2),t=X(d);G(()=>Z(t,`${P()??""}$`)),Y(a,r)};B(k,a=>{v()&&a(w)})}Y(L,_),D()}export{ie as default};
