const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./threlte-C_AO4nNd.css","./AdminPage-DAmtqN73.css","./app-BIV1_Gf5.css","./Modal-B7z7aJ1G.css","./ThrelteWorld-DoXpMsis.css","./Battle-CUUxipiA.css","./Intro-wbGedcWj.css"])))=>i.map(i=>d[i]);
import{i as v,r as _,a as ht,s as Xo,b as Ko,g as qo,c as zo,h as ti}from"./vendor-CHMVvq2h.js";/* empty css            */import{w as N,g as _e,d as Jo,p as bi,o as Si,s as K,e as tt,a as ne,b as Je,c as z,f as Ei,h as fe,i as M,j as he,k as rt,l as de,m as Pe,t as $t,n as Ye,q as Zo,r as ri,u as si,v as Qo,x as el,y as Oe,z as Ni,A as tl,B as Ee,C as ve,D as gt,E as wt,F as rl}from"./threlte-Cn4q_HKN.js";import"./threejs-D-3vx0wo.js";const sl=(function(){const e=typeof document<"u"&&document.createElement("link").relList;return e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"})(),nl=function(t,e){return new URL(t,e).href},Bi={},vt=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};const i=document.getElementsByTagName("link"),c=document.querySelector("meta[property=csp-nonce]"),o=c?.nonce||c?.getAttribute("nonce");s=d(r.map(h=>{if(h=nl(h,n),h in Bi)return;Bi[h]=!0;const u=h.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(n)for(let g=i.length-1;g>=0;g--){const y=i[g];if(y.href===h&&(!u||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":sl,u||(p.as="script"),p.crossOrigin="",p.href=h,o&&p.setAttribute("nonce",o),document.head.appendChild(p),u)return new Promise((g,y)=>{p.addEventListener("load",g),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(i){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=i,window.dispatchEvent(c),!c.defaultPrevented)throw i}return s.then(i=>{for(const c of i||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};class C{x;y;constructor(e=0,r=0){this.x=e,this.y=r}}class ni{id;mapIdx;positions;start;constructor(e,r,n,s){this.id=e,this.mapIdx=r,this.positions=n,this.start=s}}class ai{position;width;height;constructor(e,r=16,n=16){this.position=e,this.width=r,this.height=n}debug(e,r,n,s,a,i="red"){e.fillStyle=i,e.fillRect(s+this.position.x*16*n,a+this.position.y*16*n,this.width*n,this.height*n)}}const al=JSON.parse('[{"growth_rate_id":1,"level":1,"experience":0},{"growth_rate_id":1,"level":2,"experience":10},{"growth_rate_id":1,"level":3,"experience":33},{"growth_rate_id":1,"level":4,"experience":80},{"growth_rate_id":1,"level":5,"experience":156},{"growth_rate_id":1,"level":6,"experience":270},{"growth_rate_id":1,"level":7,"experience":428},{"growth_rate_id":1,"level":8,"experience":640},{"growth_rate_id":1,"level":9,"experience":911},{"growth_rate_id":1,"level":10,"experience":1250},{"growth_rate_id":1,"level":11,"experience":1663},{"growth_rate_id":1,"level":12,"experience":2160},{"growth_rate_id":1,"level":13,"experience":2746},{"growth_rate_id":1,"level":14,"experience":3430},{"growth_rate_id":1,"level":15,"experience":4218},{"growth_rate_id":1,"level":16,"experience":5120},{"growth_rate_id":1,"level":17,"experience":6141},{"growth_rate_id":1,"level":18,"experience":7290},{"growth_rate_id":1,"level":19,"experience":8573},{"growth_rate_id":1,"level":20,"experience":10000},{"growth_rate_id":1,"level":21,"experience":11576},{"growth_rate_id":1,"level":22,"experience":13310},{"growth_rate_id":1,"level":23,"experience":15208},{"growth_rate_id":1,"level":24,"experience":17280},{"growth_rate_id":1,"level":25,"experience":19531},{"growth_rate_id":1,"level":26,"experience":21970},{"growth_rate_id":1,"level":27,"experience":24603},{"growth_rate_id":1,"level":28,"experience":27440},{"growth_rate_id":1,"level":29,"experience":30486},{"growth_rate_id":1,"level":30,"experience":33750},{"growth_rate_id":1,"level":31,"experience":37238},{"growth_rate_id":1,"level":32,"experience":40960},{"growth_rate_id":1,"level":33,"experience":44921},{"growth_rate_id":1,"level":34,"experience":49130},{"growth_rate_id":1,"level":35,"experience":53593},{"growth_rate_id":1,"level":36,"experience":58320},{"growth_rate_id":1,"level":37,"experience":63316},{"growth_rate_id":1,"level":38,"experience":68590},{"growth_rate_id":1,"level":39,"experience":74148},{"growth_rate_id":1,"level":40,"experience":80000},{"growth_rate_id":1,"level":41,"experience":86151},{"growth_rate_id":1,"level":42,"experience":92610},{"growth_rate_id":1,"level":43,"experience":99383},{"growth_rate_id":1,"level":44,"experience":106480},{"growth_rate_id":1,"level":45,"experience":113906},{"growth_rate_id":1,"level":46,"experience":121670},{"growth_rate_id":1,"level":47,"experience":129778},{"growth_rate_id":1,"level":48,"experience":138240},{"growth_rate_id":1,"level":49,"experience":147061},{"growth_rate_id":1,"level":50,"experience":156250},{"growth_rate_id":1,"level":51,"experience":165813},{"growth_rate_id":1,"level":52,"experience":175760},{"growth_rate_id":1,"level":53,"experience":186096},{"growth_rate_id":1,"level":54,"experience":196830},{"growth_rate_id":1,"level":55,"experience":207968},{"growth_rate_id":1,"level":56,"experience":219520},{"growth_rate_id":1,"level":57,"experience":231491},{"growth_rate_id":1,"level":58,"experience":243890},{"growth_rate_id":1,"level":59,"experience":256723},{"growth_rate_id":1,"level":60,"experience":270000},{"growth_rate_id":1,"level":61,"experience":283726},{"growth_rate_id":1,"level":62,"experience":297910},{"growth_rate_id":1,"level":63,"experience":312558},{"growth_rate_id":1,"level":64,"experience":327680},{"growth_rate_id":1,"level":65,"experience":343281},{"growth_rate_id":1,"level":66,"experience":359370},{"growth_rate_id":1,"level":67,"experience":375953},{"growth_rate_id":1,"level":68,"experience":393040},{"growth_rate_id":1,"level":69,"experience":410636},{"growth_rate_id":1,"level":70,"experience":428750},{"growth_rate_id":1,"level":71,"experience":447388},{"growth_rate_id":1,"level":72,"experience":466560},{"growth_rate_id":1,"level":73,"experience":486271},{"growth_rate_id":1,"level":74,"experience":506530},{"growth_rate_id":1,"level":75,"experience":527343},{"growth_rate_id":1,"level":76,"experience":548720},{"growth_rate_id":1,"level":77,"experience":570666},{"growth_rate_id":1,"level":78,"experience":593190},{"growth_rate_id":1,"level":79,"experience":616298},{"growth_rate_id":1,"level":80,"experience":640000},{"growth_rate_id":1,"level":81,"experience":664301},{"growth_rate_id":1,"level":82,"experience":689210},{"growth_rate_id":1,"level":83,"experience":714733},{"growth_rate_id":1,"level":84,"experience":740880},{"growth_rate_id":1,"level":85,"experience":767656},{"growth_rate_id":1,"level":86,"experience":795070},{"growth_rate_id":1,"level":87,"experience":823128},{"growth_rate_id":1,"level":88,"experience":851840},{"growth_rate_id":1,"level":89,"experience":881211},{"growth_rate_id":1,"level":90,"experience":911250},{"growth_rate_id":1,"level":91,"experience":941963},{"growth_rate_id":1,"level":92,"experience":973360},{"growth_rate_id":1,"level":93,"experience":1005446},{"growth_rate_id":1,"level":94,"experience":1038230},{"growth_rate_id":1,"level":95,"experience":1071718},{"growth_rate_id":1,"level":96,"experience":1105920},{"growth_rate_id":1,"level":97,"experience":1140841},{"growth_rate_id":1,"level":98,"experience":1176490},{"growth_rate_id":1,"level":99,"experience":1212873},{"growth_rate_id":1,"level":100,"experience":1250000},{"growth_rate_id":2,"level":1,"experience":0},{"growth_rate_id":2,"level":2,"experience":8},{"growth_rate_id":2,"level":3,"experience":27},{"growth_rate_id":2,"level":4,"experience":64},{"growth_rate_id":2,"level":5,"experience":125},{"growth_rate_id":2,"level":6,"experience":216},{"growth_rate_id":2,"level":7,"experience":343},{"growth_rate_id":2,"level":8,"experience":512},{"growth_rate_id":2,"level":9,"experience":729},{"growth_rate_id":2,"level":10,"experience":1000},{"growth_rate_id":2,"level":11,"experience":1331},{"growth_rate_id":2,"level":12,"experience":1728},{"growth_rate_id":2,"level":13,"experience":2197},{"growth_rate_id":2,"level":14,"experience":2744},{"growth_rate_id":2,"level":15,"experience":3375},{"growth_rate_id":2,"level":16,"experience":4096},{"growth_rate_id":2,"level":17,"experience":4913},{"growth_rate_id":2,"level":18,"experience":5832},{"growth_rate_id":2,"level":19,"experience":6859},{"growth_rate_id":2,"level":20,"experience":8000},{"growth_rate_id":2,"level":21,"experience":9261},{"growth_rate_id":2,"level":22,"experience":10648},{"growth_rate_id":2,"level":23,"experience":12167},{"growth_rate_id":2,"level":24,"experience":13824},{"growth_rate_id":2,"level":25,"experience":15625},{"growth_rate_id":2,"level":26,"experience":17576},{"growth_rate_id":2,"level":27,"experience":19683},{"growth_rate_id":2,"level":28,"experience":21952},{"growth_rate_id":2,"level":29,"experience":24389},{"growth_rate_id":2,"level":30,"experience":27000},{"growth_rate_id":2,"level":31,"experience":29791},{"growth_rate_id":2,"level":32,"experience":32768},{"growth_rate_id":2,"level":33,"experience":35937},{"growth_rate_id":2,"level":34,"experience":39304},{"growth_rate_id":2,"level":35,"experience":42875},{"growth_rate_id":2,"level":36,"experience":46656},{"growth_rate_id":2,"level":37,"experience":50653},{"growth_rate_id":2,"level":38,"experience":54872},{"growth_rate_id":2,"level":39,"experience":59319},{"growth_rate_id":2,"level":40,"experience":64000},{"growth_rate_id":2,"level":41,"experience":68921},{"growth_rate_id":2,"level":42,"experience":74088},{"growth_rate_id":2,"level":43,"experience":79507},{"growth_rate_id":2,"level":44,"experience":85184},{"growth_rate_id":2,"level":45,"experience":91125},{"growth_rate_id":2,"level":46,"experience":97336},{"growth_rate_id":2,"level":47,"experience":103823},{"growth_rate_id":2,"level":48,"experience":110592},{"growth_rate_id":2,"level":49,"experience":117649},{"growth_rate_id":2,"level":50,"experience":125000},{"growth_rate_id":2,"level":51,"experience":132651},{"growth_rate_id":2,"level":52,"experience":140608},{"growth_rate_id":2,"level":53,"experience":148877},{"growth_rate_id":2,"level":54,"experience":157464},{"growth_rate_id":2,"level":55,"experience":166375},{"growth_rate_id":2,"level":56,"experience":175616},{"growth_rate_id":2,"level":57,"experience":185193},{"growth_rate_id":2,"level":58,"experience":195112},{"growth_rate_id":2,"level":59,"experience":205379},{"growth_rate_id":2,"level":60,"experience":216000},{"growth_rate_id":2,"level":61,"experience":226981},{"growth_rate_id":2,"level":62,"experience":238328},{"growth_rate_id":2,"level":63,"experience":250047},{"growth_rate_id":2,"level":64,"experience":262144},{"growth_rate_id":2,"level":65,"experience":274625},{"growth_rate_id":2,"level":66,"experience":287496},{"growth_rate_id":2,"level":67,"experience":300763},{"growth_rate_id":2,"level":68,"experience":314432},{"growth_rate_id":2,"level":69,"experience":328509},{"growth_rate_id":2,"level":70,"experience":343000},{"growth_rate_id":2,"level":71,"experience":357911},{"growth_rate_id":2,"level":72,"experience":373248},{"growth_rate_id":2,"level":73,"experience":389017},{"growth_rate_id":2,"level":74,"experience":405224},{"growth_rate_id":2,"level":75,"experience":421875},{"growth_rate_id":2,"level":76,"experience":438976},{"growth_rate_id":2,"level":77,"experience":456533},{"growth_rate_id":2,"level":78,"experience":474552},{"growth_rate_id":2,"level":79,"experience":493039},{"growth_rate_id":2,"level":80,"experience":512000},{"growth_rate_id":2,"level":81,"experience":531441},{"growth_rate_id":2,"level":82,"experience":551368},{"growth_rate_id":2,"level":83,"experience":571787},{"growth_rate_id":2,"level":84,"experience":592704},{"growth_rate_id":2,"level":85,"experience":614125},{"growth_rate_id":2,"level":86,"experience":636056},{"growth_rate_id":2,"level":87,"experience":658503},{"growth_rate_id":2,"level":88,"experience":681472},{"growth_rate_id":2,"level":89,"experience":704969},{"growth_rate_id":2,"level":90,"experience":729000},{"growth_rate_id":2,"level":91,"experience":753571},{"growth_rate_id":2,"level":92,"experience":778688},{"growth_rate_id":2,"level":93,"experience":804357},{"growth_rate_id":2,"level":94,"experience":830584},{"growth_rate_id":2,"level":95,"experience":857375},{"growth_rate_id":2,"level":96,"experience":884736},{"growth_rate_id":2,"level":97,"experience":912673},{"growth_rate_id":2,"level":98,"experience":941192},{"growth_rate_id":2,"level":99,"experience":970299},{"growth_rate_id":2,"level":100,"experience":1000000},{"growth_rate_id":3,"level":1,"experience":0},{"growth_rate_id":3,"level":2,"experience":6},{"growth_rate_id":3,"level":3,"experience":21},{"growth_rate_id":3,"level":4,"experience":51},{"growth_rate_id":3,"level":5,"experience":100},{"growth_rate_id":3,"level":6,"experience":172},{"growth_rate_id":3,"level":7,"experience":274},{"growth_rate_id":3,"level":8,"experience":409},{"growth_rate_id":3,"level":9,"experience":583},{"growth_rate_id":3,"level":10,"experience":800},{"growth_rate_id":3,"level":11,"experience":1064},{"growth_rate_id":3,"level":12,"experience":1382},{"growth_rate_id":3,"level":13,"experience":1757},{"growth_rate_id":3,"level":14,"experience":2195},{"growth_rate_id":3,"level":15,"experience":2700},{"growth_rate_id":3,"level":16,"experience":3276},{"growth_rate_id":3,"level":17,"experience":3930},{"growth_rate_id":3,"level":18,"experience":4665},{"growth_rate_id":3,"level":19,"experience":5487},{"growth_rate_id":3,"level":20,"experience":6400},{"growth_rate_id":3,"level":21,"experience":7408},{"growth_rate_id":3,"level":22,"experience":8518},{"growth_rate_id":3,"level":23,"experience":9733},{"growth_rate_id":3,"level":24,"experience":11059},{"growth_rate_id":3,"level":25,"experience":12500},{"growth_rate_id":3,"level":26,"experience":14060},{"growth_rate_id":3,"level":27,"experience":15746},{"growth_rate_id":3,"level":28,"experience":17561},{"growth_rate_id":3,"level":29,"experience":19511},{"growth_rate_id":3,"level":30,"experience":21600},{"growth_rate_id":3,"level":31,"experience":23832},{"growth_rate_id":3,"level":32,"experience":26214},{"growth_rate_id":3,"level":33,"experience":28749},{"growth_rate_id":3,"level":34,"experience":31443},{"growth_rate_id":3,"level":35,"experience":34300},{"growth_rate_id":3,"level":36,"experience":37324},{"growth_rate_id":3,"level":37,"experience":40522},{"growth_rate_id":3,"level":38,"experience":43897},{"growth_rate_id":3,"level":39,"experience":47455},{"growth_rate_id":3,"level":40,"experience":51200},{"growth_rate_id":3,"level":41,"experience":55136},{"growth_rate_id":3,"level":42,"experience":59270},{"growth_rate_id":3,"level":43,"experience":63605},{"growth_rate_id":3,"level":44,"experience":68147},{"growth_rate_id":3,"level":45,"experience":72900},{"growth_rate_id":3,"level":46,"experience":77868},{"growth_rate_id":3,"level":47,"experience":83058},{"growth_rate_id":3,"level":48,"experience":88473},{"growth_rate_id":3,"level":49,"experience":94119},{"growth_rate_id":3,"level":50,"experience":100000},{"growth_rate_id":3,"level":51,"experience":106120},{"growth_rate_id":3,"level":52,"experience":112486},{"growth_rate_id":3,"level":53,"experience":119101},{"growth_rate_id":3,"level":54,"experience":125971},{"growth_rate_id":3,"level":55,"experience":133100},{"growth_rate_id":3,"level":56,"experience":140492},{"growth_rate_id":3,"level":57,"experience":148154},{"growth_rate_id":3,"level":58,"experience":156089},{"growth_rate_id":3,"level":59,"experience":164303},{"growth_rate_id":3,"level":60,"experience":172800},{"growth_rate_id":3,"level":61,"experience":181584},{"growth_rate_id":3,"level":62,"experience":190662},{"growth_rate_id":3,"level":63,"experience":200037},{"growth_rate_id":3,"level":64,"experience":209715},{"growth_rate_id":3,"level":65,"experience":219700},{"growth_rate_id":3,"level":66,"experience":229996},{"growth_rate_id":3,"level":67,"experience":240610},{"growth_rate_id":3,"level":68,"experience":251545},{"growth_rate_id":3,"level":69,"experience":262807},{"growth_rate_id":3,"level":70,"experience":274400},{"growth_rate_id":3,"level":71,"experience":286328},{"growth_rate_id":3,"level":72,"experience":298598},{"growth_rate_id":3,"level":73,"experience":311213},{"growth_rate_id":3,"level":74,"experience":324179},{"growth_rate_id":3,"level":75,"experience":337500},{"growth_rate_id":3,"level":76,"experience":351180},{"growth_rate_id":3,"level":77,"experience":365226},{"growth_rate_id":3,"level":78,"experience":379641},{"growth_rate_id":3,"level":79,"experience":394431},{"growth_rate_id":3,"level":80,"experience":409600},{"growth_rate_id":3,"level":81,"experience":425152},{"growth_rate_id":3,"level":82,"experience":441094},{"growth_rate_id":3,"level":83,"experience":457429},{"growth_rate_id":3,"level":84,"experience":474163},{"growth_rate_id":3,"level":85,"experience":491300},{"growth_rate_id":3,"level":86,"experience":508844},{"growth_rate_id":3,"level":87,"experience":526802},{"growth_rate_id":3,"level":88,"experience":545177},{"growth_rate_id":3,"level":89,"experience":563975},{"growth_rate_id":3,"level":90,"experience":583200},{"growth_rate_id":3,"level":91,"experience":602856},{"growth_rate_id":3,"level":92,"experience":622950},{"growth_rate_id":3,"level":93,"experience":643485},{"growth_rate_id":3,"level":94,"experience":664467},{"growth_rate_id":3,"level":95,"experience":685900},{"growth_rate_id":3,"level":96,"experience":707788},{"growth_rate_id":3,"level":97,"experience":730138},{"growth_rate_id":3,"level":98,"experience":752953},{"growth_rate_id":3,"level":99,"experience":776239},{"growth_rate_id":3,"level":100,"experience":800000},{"growth_rate_id":4,"level":1,"experience":0},{"growth_rate_id":4,"level":2,"experience":9},{"growth_rate_id":4,"level":3,"experience":57},{"growth_rate_id":4,"level":4,"experience":96},{"growth_rate_id":4,"level":5,"experience":135},{"growth_rate_id":4,"level":6,"experience":179},{"growth_rate_id":4,"level":7,"experience":236},{"growth_rate_id":4,"level":8,"experience":314},{"growth_rate_id":4,"level":9,"experience":419},{"growth_rate_id":4,"level":10,"experience":560},{"growth_rate_id":4,"level":11,"experience":742},{"growth_rate_id":4,"level":12,"experience":973},{"growth_rate_id":4,"level":13,"experience":1261},{"growth_rate_id":4,"level":14,"experience":1612},{"growth_rate_id":4,"level":15,"experience":2035},{"growth_rate_id":4,"level":16,"experience":2535},{"growth_rate_id":4,"level":17,"experience":3120},{"growth_rate_id":4,"level":18,"experience":3798},{"growth_rate_id":4,"level":19,"experience":4575},{"growth_rate_id":4,"level":20,"experience":5460},{"growth_rate_id":4,"level":21,"experience":6458},{"growth_rate_id":4,"level":22,"experience":7577},{"growth_rate_id":4,"level":23,"experience":8825},{"growth_rate_id":4,"level":24,"experience":10208},{"growth_rate_id":4,"level":25,"experience":11735},{"growth_rate_id":4,"level":26,"experience":13411},{"growth_rate_id":4,"level":27,"experience":15244},{"growth_rate_id":4,"level":28,"experience":17242},{"growth_rate_id":4,"level":29,"experience":19411},{"growth_rate_id":4,"level":30,"experience":21760},{"growth_rate_id":4,"level":31,"experience":24294},{"growth_rate_id":4,"level":32,"experience":27021},{"growth_rate_id":4,"level":33,"experience":29949},{"growth_rate_id":4,"level":34,"experience":33084},{"growth_rate_id":4,"level":35,"experience":36435},{"growth_rate_id":4,"level":36,"experience":40007},{"growth_rate_id":4,"level":37,"experience":43808},{"growth_rate_id":4,"level":38,"experience":47846},{"growth_rate_id":4,"level":39,"experience":52127},{"growth_rate_id":4,"level":40,"experience":56660},{"growth_rate_id":4,"level":41,"experience":61450},{"growth_rate_id":4,"level":42,"experience":66505},{"growth_rate_id":4,"level":43,"experience":71833},{"growth_rate_id":4,"level":44,"experience":77440},{"growth_rate_id":4,"level":45,"experience":83335},{"growth_rate_id":4,"level":46,"experience":89523},{"growth_rate_id":4,"level":47,"experience":96012},{"growth_rate_id":4,"level":48,"experience":102810},{"growth_rate_id":4,"level":49,"experience":109923},{"growth_rate_id":4,"level":50,"experience":117360},{"growth_rate_id":4,"level":51,"experience":125126},{"growth_rate_id":4,"level":52,"experience":133229},{"growth_rate_id":4,"level":53,"experience":141677},{"growth_rate_id":4,"level":54,"experience":150476},{"growth_rate_id":4,"level":55,"experience":159635},{"growth_rate_id":4,"level":56,"experience":169159},{"growth_rate_id":4,"level":57,"experience":179056},{"growth_rate_id":4,"level":58,"experience":189334},{"growth_rate_id":4,"level":59,"experience":199999},{"growth_rate_id":4,"level":60,"experience":211060},{"growth_rate_id":4,"level":61,"experience":222522},{"growth_rate_id":4,"level":62,"experience":234393},{"growth_rate_id":4,"level":63,"experience":246681},{"growth_rate_id":4,"level":64,"experience":259392},{"growth_rate_id":4,"level":65,"experience":272535},{"growth_rate_id":4,"level":66,"experience":286115},{"growth_rate_id":4,"level":67,"experience":300140},{"growth_rate_id":4,"level":68,"experience":314618},{"growth_rate_id":4,"level":69,"experience":329555},{"growth_rate_id":4,"level":70,"experience":344960},{"growth_rate_id":4,"level":71,"experience":360838},{"growth_rate_id":4,"level":72,"experience":377197},{"growth_rate_id":4,"level":73,"experience":394045},{"growth_rate_id":4,"level":74,"experience":411388},{"growth_rate_id":4,"level":75,"experience":429235},{"growth_rate_id":4,"level":76,"experience":447591},{"growth_rate_id":4,"level":77,"experience":466464},{"growth_rate_id":4,"level":78,"experience":485862},{"growth_rate_id":4,"level":79,"experience":505791},{"growth_rate_id":4,"level":80,"experience":526260},{"growth_rate_id":4,"level":81,"experience":547274},{"growth_rate_id":4,"level":82,"experience":568841},{"growth_rate_id":4,"level":83,"experience":590969},{"growth_rate_id":4,"level":84,"experience":613664},{"growth_rate_id":4,"level":85,"experience":636935},{"growth_rate_id":4,"level":86,"experience":660787},{"growth_rate_id":4,"level":87,"experience":685228},{"growth_rate_id":4,"level":88,"experience":710266},{"growth_rate_id":4,"level":89,"experience":735907},{"growth_rate_id":4,"level":90,"experience":762160},{"growth_rate_id":4,"level":91,"experience":789030},{"growth_rate_id":4,"level":92,"experience":816525},{"growth_rate_id":4,"level":93,"experience":844653},{"growth_rate_id":4,"level":94,"experience":873420},{"growth_rate_id":4,"level":95,"experience":902835},{"growth_rate_id":4,"level":96,"experience":932903},{"growth_rate_id":4,"level":97,"experience":963632},{"growth_rate_id":4,"level":98,"experience":995030},{"growth_rate_id":4,"level":99,"experience":1027103},{"growth_rate_id":4,"level":100,"experience":1059860},{"growth_rate_id":5,"level":1,"experience":0},{"growth_rate_id":5,"level":2,"experience":15},{"growth_rate_id":5,"level":3,"experience":52},{"growth_rate_id":5,"level":4,"experience":122},{"growth_rate_id":5,"level":5,"experience":237},{"growth_rate_id":5,"level":6,"experience":406},{"growth_rate_id":5,"level":7,"experience":637},{"growth_rate_id":5,"level":8,"experience":942},{"growth_rate_id":5,"level":9,"experience":1326},{"growth_rate_id":5,"level":10,"experience":1800},{"growth_rate_id":5,"level":11,"experience":2369},{"growth_rate_id":5,"level":12,"experience":3041},{"growth_rate_id":5,"level":13,"experience":3822},{"growth_rate_id":5,"level":14,"experience":4719},{"growth_rate_id":5,"level":15,"experience":5737},{"growth_rate_id":5,"level":16,"experience":6881},{"growth_rate_id":5,"level":17,"experience":8155},{"growth_rate_id":5,"level":18,"experience":9564},{"growth_rate_id":5,"level":19,"experience":11111},{"growth_rate_id":5,"level":20,"experience":12800},{"growth_rate_id":5,"level":21,"experience":14632},{"growth_rate_id":5,"level":22,"experience":16610},{"growth_rate_id":5,"level":23,"experience":18737},{"growth_rate_id":5,"level":24,"experience":21012},{"growth_rate_id":5,"level":25,"experience":23437},{"growth_rate_id":5,"level":26,"experience":26012},{"growth_rate_id":5,"level":27,"experience":28737},{"growth_rate_id":5,"level":28,"experience":31610},{"growth_rate_id":5,"level":29,"experience":34632},{"growth_rate_id":5,"level":30,"experience":37800},{"growth_rate_id":5,"level":31,"experience":41111},{"growth_rate_id":5,"level":32,"experience":44564},{"growth_rate_id":5,"level":33,"experience":48155},{"growth_rate_id":5,"level":34,"experience":51881},{"growth_rate_id":5,"level":35,"experience":55737},{"growth_rate_id":5,"level":36,"experience":59719},{"growth_rate_id":5,"level":37,"experience":63822},{"growth_rate_id":5,"level":38,"experience":68041},{"growth_rate_id":5,"level":39,"experience":72369},{"growth_rate_id":5,"level":40,"experience":76800},{"growth_rate_id":5,"level":41,"experience":81326},{"growth_rate_id":5,"level":42,"experience":85942},{"growth_rate_id":5,"level":43,"experience":90637},{"growth_rate_id":5,"level":44,"experience":95406},{"growth_rate_id":5,"level":45,"experience":100237},{"growth_rate_id":5,"level":46,"experience":105122},{"growth_rate_id":5,"level":47,"experience":110052},{"growth_rate_id":5,"level":48,"experience":115015},{"growth_rate_id":5,"level":49,"experience":120001},{"growth_rate_id":5,"level":50,"experience":125000},{"growth_rate_id":5,"level":51,"experience":131324},{"growth_rate_id":5,"level":52,"experience":137795},{"growth_rate_id":5,"level":53,"experience":144410},{"growth_rate_id":5,"level":54,"experience":151165},{"growth_rate_id":5,"level":55,"experience":158056},{"growth_rate_id":5,"level":56,"experience":165079},{"growth_rate_id":5,"level":57,"experience":172229},{"growth_rate_id":5,"level":58,"experience":179503},{"growth_rate_id":5,"level":59,"experience":186894},{"growth_rate_id":5,"level":60,"experience":194400},{"growth_rate_id":5,"level":61,"experience":202013},{"growth_rate_id":5,"level":62,"experience":209728},{"growth_rate_id":5,"level":63,"experience":217540},{"growth_rate_id":5,"level":64,"experience":225443},{"growth_rate_id":5,"level":65,"experience":233431},{"growth_rate_id":5,"level":66,"experience":241496},{"growth_rate_id":5,"level":67,"experience":249633},{"growth_rate_id":5,"level":68,"experience":257834},{"growth_rate_id":5,"level":69,"experience":267406},{"growth_rate_id":5,"level":70,"experience":276458},{"growth_rate_id":5,"level":71,"experience":286328},{"growth_rate_id":5,"level":72,"experience":296358},{"growth_rate_id":5,"level":73,"experience":305767},{"growth_rate_id":5,"level":74,"experience":316074},{"growth_rate_id":5,"level":75,"experience":326531},{"growth_rate_id":5,"level":76,"experience":336255},{"growth_rate_id":5,"level":77,"experience":346965},{"growth_rate_id":5,"level":78,"experience":357812},{"growth_rate_id":5,"level":79,"experience":367807},{"growth_rate_id":5,"level":80,"experience":378880},{"growth_rate_id":5,"level":81,"experience":390077},{"growth_rate_id":5,"level":82,"experience":400293},{"growth_rate_id":5,"level":83,"experience":411686},{"growth_rate_id":5,"level":84,"experience":423190},{"growth_rate_id":5,"level":85,"experience":433572},{"growth_rate_id":5,"level":86,"experience":445239},{"growth_rate_id":5,"level":87,"experience":457001},{"growth_rate_id":5,"level":88,"experience":467489},{"growth_rate_id":5,"level":89,"experience":479378},{"growth_rate_id":5,"level":90,"experience":491346},{"growth_rate_id":5,"level":91,"experience":501878},{"growth_rate_id":5,"level":92,"experience":513934},{"growth_rate_id":5,"level":93,"experience":526049},{"growth_rate_id":5,"level":94,"experience":536557},{"growth_rate_id":5,"level":95,"experience":548720},{"growth_rate_id":5,"level":96,"experience":560922},{"growth_rate_id":5,"level":97,"experience":571333},{"growth_rate_id":5,"level":98,"experience":583539},{"growth_rate_id":5,"level":99,"experience":591882},{"growth_rate_id":5,"level":100,"experience":600000},{"growth_rate_id":6,"level":1,"experience":0},{"growth_rate_id":6,"level":2,"experience":4},{"growth_rate_id":6,"level":3,"experience":13},{"growth_rate_id":6,"level":4,"experience":32},{"growth_rate_id":6,"level":5,"experience":65},{"growth_rate_id":6,"level":6,"experience":112},{"growth_rate_id":6,"level":7,"experience":178},{"growth_rate_id":6,"level":8,"experience":276},{"growth_rate_id":6,"level":9,"experience":393},{"growth_rate_id":6,"level":10,"experience":540},{"growth_rate_id":6,"level":11,"experience":745},{"growth_rate_id":6,"level":12,"experience":967},{"growth_rate_id":6,"level":13,"experience":1230},{"growth_rate_id":6,"level":14,"experience":1591},{"growth_rate_id":6,"level":15,"experience":1957},{"growth_rate_id":6,"level":16,"experience":2457},{"growth_rate_id":6,"level":17,"experience":3046},{"growth_rate_id":6,"level":18,"experience":3732},{"growth_rate_id":6,"level":19,"experience":4526},{"growth_rate_id":6,"level":20,"experience":5440},{"growth_rate_id":6,"level":21,"experience":6482},{"growth_rate_id":6,"level":22,"experience":7666},{"growth_rate_id":6,"level":23,"experience":9003},{"growth_rate_id":6,"level":24,"experience":10506},{"growth_rate_id":6,"level":25,"experience":12187},{"growth_rate_id":6,"level":26,"experience":14060},{"growth_rate_id":6,"level":27,"experience":16140},{"growth_rate_id":6,"level":28,"experience":18439},{"growth_rate_id":6,"level":29,"experience":20974},{"growth_rate_id":6,"level":30,"experience":23760},{"growth_rate_id":6,"level":31,"experience":26811},{"growth_rate_id":6,"level":32,"experience":30146},{"growth_rate_id":6,"level":33,"experience":33780},{"growth_rate_id":6,"level":34,"experience":37731},{"growth_rate_id":6,"level":35,"experience":42017},{"growth_rate_id":6,"level":36,"experience":46656},{"growth_rate_id":6,"level":37,"experience":50653},{"growth_rate_id":6,"level":38,"experience":55969},{"growth_rate_id":6,"level":39,"experience":60505},{"growth_rate_id":6,"level":40,"experience":66560},{"growth_rate_id":6,"level":41,"experience":71677},{"growth_rate_id":6,"level":42,"experience":78533},{"growth_rate_id":6,"level":43,"experience":84277},{"growth_rate_id":6,"level":44,"experience":91998},{"growth_rate_id":6,"level":45,"experience":98415},{"growth_rate_id":6,"level":46,"experience":107069},{"growth_rate_id":6,"level":47,"experience":114205},{"growth_rate_id":6,"level":48,"experience":123863},{"growth_rate_id":6,"level":49,"experience":131766},{"growth_rate_id":6,"level":50,"experience":142500},{"growth_rate_id":6,"level":51,"experience":151222},{"growth_rate_id":6,"level":52,"experience":163105},{"growth_rate_id":6,"level":53,"experience":172697},{"growth_rate_id":6,"level":54,"experience":185807},{"growth_rate_id":6,"level":55,"experience":196322},{"growth_rate_id":6,"level":56,"experience":210739},{"growth_rate_id":6,"level":57,"experience":222231},{"growth_rate_id":6,"level":58,"experience":238036},{"growth_rate_id":6,"level":59,"experience":250562},{"growth_rate_id":6,"level":60,"experience":267840},{"growth_rate_id":6,"level":61,"experience":281456},{"growth_rate_id":6,"level":62,"experience":300293},{"growth_rate_id":6,"level":63,"experience":315059},{"growth_rate_id":6,"level":64,"experience":335544},{"growth_rate_id":6,"level":65,"experience":351520},{"growth_rate_id":6,"level":66,"experience":373744},{"growth_rate_id":6,"level":67,"experience":390991},{"growth_rate_id":6,"level":68,"experience":415050},{"growth_rate_id":6,"level":69,"experience":433631},{"growth_rate_id":6,"level":70,"experience":459620},{"growth_rate_id":6,"level":71,"experience":479600},{"growth_rate_id":6,"level":72,"experience":507617},{"growth_rate_id":6,"level":73,"experience":529063},{"growth_rate_id":6,"level":74,"experience":559209},{"growth_rate_id":6,"level":75,"experience":582187},{"growth_rate_id":6,"level":76,"experience":614566},{"growth_rate_id":6,"level":77,"experience":639146},{"growth_rate_id":6,"level":78,"experience":673863},{"growth_rate_id":6,"level":79,"experience":700115},{"growth_rate_id":6,"level":80,"experience":737280},{"growth_rate_id":6,"level":81,"experience":765275},{"growth_rate_id":6,"level":82,"experience":804997},{"growth_rate_id":6,"level":83,"experience":834809},{"growth_rate_id":6,"level":84,"experience":877201},{"growth_rate_id":6,"level":85,"experience":908905},{"growth_rate_id":6,"level":86,"experience":954084},{"growth_rate_id":6,"level":87,"experience":987754},{"growth_rate_id":6,"level":88,"experience":1035837},{"growth_rate_id":6,"level":89,"experience":1071552},{"growth_rate_id":6,"level":90,"experience":1122660},{"growth_rate_id":6,"level":91,"experience":1160499},{"growth_rate_id":6,"level":92,"experience":1214753},{"growth_rate_id":6,"level":93,"experience":1254796},{"growth_rate_id":6,"level":94,"experience":1312322},{"growth_rate_id":6,"level":95,"experience":1354652},{"growth_rate_id":6,"level":96,"experience":1415577},{"growth_rate_id":6,"level":97,"experience":1460276},{"growth_rate_id":6,"level":98,"experience":1524731},{"growth_rate_id":6,"level":99,"experience":1571884},{"growth_rate_id":6,"level":100,"experience":1640000}]');class il{ready=!0;chartById=new Map;constructor(){al.forEach(e=>{this.chartById.has(e.growth_rate_id)||this.chartById.set(e.growth_rate_id,[]),this.chartById.get(e.growth_rate_id).push(new ol(e.level,e.experience))})}howMuchINeed(e,r){return!this.ready||e<1||e>=100||!this.chartById.has(r)?(console.error("ERROR",e,r),Number.MAX_SAFE_INTEGER):this.chartById.get(r)?.find(a=>a.level===e)?.experience||0}howMuchIGet(e,r,n=!1,s=!1){const a=e.baseXp,i=e.level,c=n?1.5:1,o=s?2*r:r;return Math.floor(a*i/7*c*(1/o)*1*1*1*1*1)*2}}class ol{level;experience;constructor(e,r){this.level=e,this.experience=r}}const qe=new il;var ae=(t=>(t.CONFUSED="confused",t.FLINCH="flinch",t.INFATUATION="infatuation",t.BOUND="bound",t.SEEDED="seeded",t.CURSED="cursed",t.DROWSY="drowsy",t.NIGHTMARE="nightmare",t.PERISH_SONG="perish_song",t.TAUNT="taunt",t.ENCORE="encore",t.TORMENT="torment",t.DISABLE="disable",t.SEMI_INVULNERABLE="semi_invulnerable",t.CHARGING="charging",t.RECHARGING="recharging",t.RAMPAGE="rampage",t.PROTECTED="protected",t.UNNERVED="unnerved",t.SLOW_START="slow_start",t.TRUANT="truant",t))(ae||{});class ii{volatiles=new Map;boundData;seededBy;protectStaleCounter=0;add(e,r=0){this.volatiles.set(e,{turns:r})}remove(e){this.volatiles.delete(e),e==="bound"&&(this.boundData=void 0),e==="seeded"&&(this.seededBy=void 0)}has(e){return this.volatiles.has(e)}getTurns(e){return this.volatiles.get(e)?.turns??0}setTurns(e,r){const n=this.volatiles.get(e);n&&(n.turns=r)}getAll(){return Array.from(this.volatiles.keys())}clear(){this.volatiles.clear(),this.boundData=void 0,this.seededBy=void 0,this.protectStaleCounter=0}tickTurn(){for(const[e,r]of this.volatiles)r.turns>0&&(r.turns--,r.turns===0&&this.remove(e))}endTurn(){this.remove("flinch"),this.remove("protected")}setBoundData(e,r){this.boundData={sourceId:e,damagePerTurn:r}}getBoundData(){if(this.has("bound"))return this.boundData}setSeededBy(e){this.seededBy=e}getSeededBy(){return this.seededBy}checkConfusionSelfHit(){return this.has("confused")?Math.random()<.33:!1}isFlinched(){return this.has("flinch")}checkInfatuationImmobilize(){return this.has("infatuation")?Math.random()<.5:!1}getProtectStaleCounter(){return this.protectStaleCounter}incrementProtectStale(){this.protectStaleCounter++}resetProtectStale(){this.protectStaleCounter=0}}class $i{owner;constructor(e){this.owner=e}computeFromBaseStats(){const{ivs:e,stats:r,evs:n,nature:s,level:a}=this.owner,i=c=>s.increasedStatId===c?1.1:s.decreasedStatId===c?.9:1;return new me(Math.floor((e.hp+r.hp*2+n.hp/4)*a/100+10+a),Math.floor(((e.attack+r.attack*2+n.attack/4)*a/100+5)*i("attack")),Math.floor(((e.defense+r.defense*2+n.defense/4)*a/100+5)*i("defense")),Math.floor(((e.specialAttack+r.specialAttack*2+n.specialAttack/4)*a/100+5)*i("specialAttack")),Math.floor(((e.specialDefense+r.specialDefense*2+n.specialDefense/4)*a/100+5)*i("specialDefense")),Math.floor(((e.speed+r.speed*2+n.speed/4)*a/100+5)*i("speed")))}computeBattleStats(){const{currentStats:e,statsChanges:r,status:n}=this.owner,s=c=>c>=0?(2+c)/2:2/(2-c),a=c=>c>=0?(3+c)/3:3/(3-c),i=n==="paralysis"?.5:1;return new me(e.hp,Math.floor(e.attack*s(r.attack)),Math.floor(e.defense*s(r.defense)),Math.floor(e.specialAttack*s(r.specialAttack)),Math.floor(e.specialDefense*s(r.specialDefense)),Math.floor(e.speed*s(r.speed)*i),Math.floor(e.evasion*a(r.evasion)),Math.floor(e.accuracy*a(r.accuracy)))}changeBattleStats(e,r){const n=this.owner.statsChanges[e],s=Math.min(6,Math.max(-6,n+r));s!==n&&(this.owner.statsChanges[e]=s)}resetBattleStats(){this.owner.statsChanges=new me}computeTotalEvs(){const{evs:e}=this.owner;return e.attack+e.defense+e.specialAttack+e.specialDefense+e.speed+e.hp}}class Li{owner;constructor(e){this.owner=e}computeXpToNextLevel(){return qe.howMuchINeed(this.owner.level,this.owner.growthRateId)}howMuchXpWon(e=1,r=!1,n){return qe.howMuchIGet(this.owner,e,r,n)}addXpResult(e,r){if(this.owner.evsToDistribute+=this.owner.totalEvs+r<=510?r:this.owner.totalEvs+r-510,this.owner.level<100){let n=0;if(this.owner.xpToNextLevel<this.owner.currentXp+e){n=e-(this.owner.xpToNextLevel-this.owner.currentXp);const s=e-n;return this.owner.currentXp+=s,{levelup:!0,xpLeft:n,newMove:[]}}else this.owner.currentXp+=e}return{levelup:!1,xpLeft:0,newMove:[]}}addEv(e,r){const n=this.owner.totalEvs;if(this.owner.evsToDistribute>=r&&this.owner.evs[e]+r<=252&&this.owner.evs[e]+r>0&&n+r<=510){const s=this.owner.evs[e]+r<=252&&n+r<=510?r:0;this.owner.evs[e]+=s,this.owner.evsToDistribute-=s,this.owner.updateCurrentStats()}}canEvolve(){return this.owner.evolution?.filter(e=>e.method==="level"&&e.level<=this.owner.level)?.length>0}levelUp(){if(this.owner.level>=100)return{};const e={...this.owner.currentStats};let r=this.owner.currentStats.hp;this.owner.level+=1,this.owner.updateCurrentStats();const n={...this.owner.currentStats};return r=this.owner.currentStats.hp-r,this.owner.currentHp+=r,this.owner.currentXp=0,{oldStats:e,newStats:n,moves:this.checkForNewMoves()}}checkForNewMoves(){return this.owner.moves.filter(e=>e.level===this.owner.level)}}class Hi{owner;constructor(e){this.owner=e}selectMove(e,r){const n=Math.floor(Math.random()*this.owner.moves.length),s=this.owner.moves[n];if(e==="Easy"&&r){const a=r?.types.length===2?this.owner.moves.find(i=>i.type===r.types[0]&&i.power>0):this.owner.moves.find(i=>(i.type===r.types[0]||i.type===r.types[1])&&i.power>0);if(a&&a.power>0)return s}return s}selectLatestMoves(e){return e.moves.filter(r=>r.level<=this.owner.level&&r.method===1).slice(-4).map(r=>new _o(r.id,r.name,r.type,r.category,r.power,r.accuracy,r.pp,r.priority,r.target,r.effect,r.effectChance,r.description,r.level))}}class ll{id;viewed;caught;constructor(e,r,n){this.id=e,this.viewed=r,this.caught=n}}const Vi=[{id:1,identifier:"hardy",decreasedStatId:"attack",increasedStatId:"attack"},{id:2,identifier:"bold",decreasedStatId:"attack",increasedStatId:"defense"},{id:3,identifier:"modest",decreasedStatId:"attack",increasedStatId:"specialAttack"},{id:4,identifier:"calm",decreasedStatId:"attack",increasedStatId:"specialDefense"},{id:5,identifier:"timid",decreasedStatId:"attack",increasedStatId:"speed"},{id:6,identifier:"lonely",decreasedStatId:"defense",increasedStatId:"attack"},{id:7,identifier:"docile",decreasedStatId:"defense",increasedStatId:"defense"},{id:8,identifier:"mild",decreasedStatId:"defense",increasedStatId:"specialAttack"},{id:9,identifier:"gentle",decreasedStatId:"defense",increasedStatId:"specialDefense"},{id:10,identifier:"hasty",decreasedStatId:"defense",increasedStatId:"speed"},{id:11,identifier:"adamant",decreasedStatId:"specialAttack",increasedStatId:"attack"},{id:12,identifier:"impish",decreasedStatId:"specialAttack",increasedStatId:"defense"},{id:13,identifier:"bashful",decreasedStatId:"specialAttack",increasedStatId:"specialAttack"},{id:14,identifier:"careful",decreasedStatId:"specialAttack",increasedStatId:"specialDefense"},{id:15,identifier:"rash",decreasedStatId:"specialDefense",increasedStatId:"specialAttack"},{id:16,identifier:"jolly",decreasedStatId:"specialAttack",increasedStatId:"speed"},{id:17,identifier:"naughty",decreasedStatId:"specialDefense",increasedStatId:"attack"},{id:18,identifier:"lax",decreasedStatId:"specialDefense",increasedStatId:"defense"},{id:19,identifier:"quirky",decreasedStatId:"specialDefense",increasedStatId:"specialDefense"},{id:20,identifier:"naive",decreasedStatId:"specialDefense",increasedStatId:"speed"},{id:21,identifier:"brave",decreasedStatId:"speed",increasedStatId:"attack"},{id:22,identifier:"relaxed",decreasedStatId:"speed",increasedStatId:"defense"},{id:23,identifier:"quiet",decreasedStatId:"speed",increasedStatId:"specialAttack"},{id:24,identifier:"sassy",decreasedStatId:"speed",increasedStatId:"specialDefense"},{id:25,identifier:"serious",decreasedStatId:"speed",increasedStatId:"speed"}],cl=2048;class oi{entries=[];initialized=!1;initPromise=null;constructor(e=[]){this.initPromise=this.loadPokedex(e)}async loadPokedex(e){if(this.initialized)return;const n=await(await fetch("./data/pokedex-animatedV3.json")).json();this.importFromJson(n,e),this.initialized=!0}async ensureLoaded(){this.initPromise&&await this.initPromise}importFromJson(e,r=[]){this.entries?.length===0&&e.forEach(n=>{this.entries.push(new Oi(n.id,n.regionalId,n.name,n.types,n.abilities,n.moves,n.stats,n.height,n.weight,n.description,n.isLegendary,n.captureRate,n.growthRateId,n.baseXp,n.percentageMale,n.evolution,n.sprites,r.find(s=>s.id===n.id)?.viewed,r.find(s=>s.id===n.id)?.caught))})}findById(e){if(e==null||e<1)return new Ve(new Qe);const r=this.entries.find(n=>n.id===e);return r?.id?new Ve(r):new Ve(new Qe)}findByName(e){return e==null||e===""?[new Ve(new Qe)]:this.entries.filter(n=>n.name.toLowerCase().includes(e.toLowerCase())).map(n=>n.id?new Ve(n):new Ve(new Qe))}setViewed(e){const r=this.entries.find(n=>n.id===e);r&&(r.viewed=!0)}setCaught(e){const r=this.entries.find(n=>n.id===e);r&&(r.caught=!0,r.viewed=!0)}exportForSave(){return this.entries.map(e=>new ll(e.id,e.viewed,e.caught))}getCaught(){return this.entries.filter(e=>e.caught)}getViewed(){return this.entries.filter(e=>e.viewed)}}class Ve{result;found=!1;constructor(e){this.result=e,this.found=e!==void 0}}class Oi{id;regionalId;name;normalizedName;types;abilities;moves;stats;height;weight;description;isLegendary;captureRate;growthRateId;baseXp;percentageMale;evolution;sprites;viewed=!1;caught=!1;constructor(e,r,n,s,a,i,c,o,d,h,u,f,p,g,y,S,E,b=!1,A=!1){this.id=e,this.regionalId=r,this.name=n,this.normalizedName=n.replace("♀","-f").replace("♂","-m").replace("-","").replace(". ","").replace("'","").replace(" ","").replace(".","").replaceAll("é","e").replace(":","").toLowerCase(),this.types=s,this.abilities=a,this.moves=i,this.stats=c,this.height=o,this.weight=d,this.description=h,this.isLegendary=u,this.captureRate=f,this.growthRateId=p,this.baseXp=g,this.percentageMale=y,this.evolution=S,this.sprites=E,this.viewed=b,this.caught=A}get weaknesses(){return Object.entries(di).filter(([e,r])=>{const n=this.types[0];if(this.types?.length===1)return r[n]>1;{const s=this.types[1];return r[n]*r[s]>1}}).map(([e,r])=>e)}get weaknessValue(){return Object.entries(di).filter(([e,r])=>{const n=this.types[0];if(this.types?.length===1)return r[n]>1;{const s=this.types[1];return r[n]*r[s]>1}}).map(([e,r])=>{const n=this.types[0];if(this.types?.length===1)return{string:e,value:r[n]};{const s=this.types[1];return{string:e,value:r[n]*r[s]}}})}instanciate(e,r=0,n=!1){const s=Vi[Math.floor(Math.random()*Vi.length)],a=n||Math.floor(Math.random()*cl)===0;let i;return r>0&&(i=new me(this.getIvFromMin(r),this.getIvFromMin(r),this.getIvFromMin(r),this.getIvFromMin(r),this.getIvFromMin(r),this.getIvFromMin(r))),new le(this,e,s,a,i)}getIvFromMin(e){return Math.floor(Math.random()*(32-e)+e)}getSprite(){return`src/assets/monsters/static/sprites/${this.normalizedName}.png`}}class Qe extends Oi{constructor(){super(0,0,"Unknown",[],[],[],new me,0,0,"Unknown",!1,0,0,0,0,[])}}class Pi{id;name;type;category;power;accuracy;pp;priority;target;effect;effectChance;description;level;method;constructor(e,r,n,s,a,i,c,o,d,h,u,f,p,g=1){this.id=e,this.name=r,this.type=n,this.category=s,this.power=a,this.accuracy=i,this.pp=c,this.priority=o,this.target=d,this.effect=h,this.effectChance=u,this.description=f,this.level=p,this.method=g}}class nS{move_effect_id;local_language_id;short_effect;effect;constructor(e,r,n,s){this.move_effect_id=e,this.local_language_id=r,this.short_effect=n,this.effect=s}apply(e){}}class me{hp;attack;defense;specialAttack;specialDefense;speed;total;accuracy;evasion;constructor(e=0,r=0,n=0,s=0,a=0,i=0,c=0,o=0,d){this.hp=e,this.attack=r,this.defense=n,this.specialAttack=s,this.specialDefense=a,this.speed=i,d?this.total=d:this.total=this.hp+this.attack+this.defense+this.specialAttack+this.specialDefense+this.speed,this.accuracy=o,this.evasion=c}}class _t extends Pi{pokemon2;effects=[];effectsChances=[];move1;move2;constructor(e,r,n){super(-1,`Combo ${e.name} + ${r.name}`,e.type,e.category,e.power,100,e.pp,e.priority,e.target,e.effect,e.effectChance*1.5>100?100:e.effectChance*1.5,"Combo",e.level),this.move1=e,this.move2=r,this.pokemon2=n,this.effects.push(e.effect),this.effects.push(r.effect),this.effectsChances.push(e.effectChance*1.5>100?100:e.effectChance*1.5),this.effectsChances.push(r.effectChance*1.5>100?100:r.effectChance*1.5)}}let _o=class extends Pi{currentPp;constructor(e,r,n,s,a,i,c,o,d,h,u,f,p){super(e,r,n,s,a,i,c,o,d,h,u,f,p),this.currentPp=c}toJSON(){return{id:this.id,currentPp:this.currentPp}}};class le extends Oi{currentStats=new me;statsChanges=new me;currentHp=1;currentXp=0;xpToNextLevel=0;currentAbility="";level=1;evsToDistribute=510;fainted=!1;moves=[];ivs=new me;evs=new me;nature;gender;heldItem=void 0;choiceLockedMove=void 0;lastMove;lastDamageTaken;lastAttacker;lastHitCritical;selectedMove;isShiny=!1;status;volatiles=new ii;statCalc;xpMgr;moveMgr;get spriteScale(){return 1}get totalEvs(){return this.evs.attack+this.evs.defense+this.evs.specialAttack+this.evs.specialDefense+this.evs.speed+this.evs.hp}get battleStats(){return this.statCalc.computeBattleStats()}constructor(e,r,n,s,a,i){super(e.id,e.regionalId,e.name,e.types,e.abilities,e.moves,e.stats,e.height,e.weight,e.description,e.isLegendary,e.captureRate,e.growthRateId,e.baseXp,e.percentageMale,e.evolution,e.sprites),this.statCalc=new $i(this),this.xpMgr=new Li(this),this.moveMgr=new Hi(this),i?(this.currentAbility=e.abilities.includes(i.currentAbility)?i.currentAbility:e.abilities[Math.floor(Math.random()*e.abilities.length)],this.evs=i.evs,this.ivs=i.ivs,this.nature=i.nature,this.level=i.level,this.currentXp=i.currentXp,this.currentHp=i.currentHp,this.updateCurrentStats(),this.moves=i.moves,this.isShiny=i.isShiny,this.gender=i.gender,this.evsToDistribute=i.evsToDistribute,this.heldItem=i.heldItem,this.lastMove=i.lastMove):(this.currentAbility=this.abilities[Math.floor(Math.random()*this.abilities.length)],this.evs=new me,this.ivs=a!==void 0?a:new me(Math.floor(Math.random()*32),Math.floor(Math.random()*32),Math.floor(Math.random()*32),Math.floor(Math.random()*32),Math.floor(Math.random()*32),Math.floor(Math.random()*32)),this.level=r||5,this.currentXp=0,this.nature=n,this.updateCurrentStats(),this.currentHp=this.currentStats.hp,this.moves=this.selectLatestMoves(e),this.isShiny=s,this.gender=this.percentageMale?Math.random()*100<this.percentageMale?"male":"female":"unknown")}rehydrate(e){if(e){const r=e.findById(this.id).result;this.regionalId=r.regionalId,this.name=r.name,this.normalizedName=r.normalizedName,this.types=r.types,this.abilities=r.abilities,this.stats=r.stats,this.height=r.height,this.weight=r.weight,this.description=r.description,this.isLegendary=r.isLegendary,this.captureRate=r.captureRate,this.growthRateId=r.growthRateId,this.baseXp=r.baseXp,this.percentageMale=r.percentageMale,this.evolution=r.evolution,this.sprites=r.sprites;const n=this.moves;this.moves=n.map(s=>{const a=r.moves.find(c=>c.id===s.id);if(!a)return;const i=Object.create(_o.prototype);return Object.assign(i,a),i.currentPp=s.currentPp,i}).filter(s=>s!==void 0)}this.statCalc=new $i(this),this.xpMgr=new Li(this),this.moveMgr=new Hi(this),this.heldItem&&typeof this.heldItem=="object"&&Object.keys(this.heldItem).length===0&&(this.heldItem=void 0),this.statsChanges=new me,this.volatiles=new ii}toJSON(){return{id:this.id,currentStats:this.currentStats,currentHp:this.currentHp,currentXp:this.currentXp,xpToNextLevel:this.xpToNextLevel,currentAbility:this.currentAbility,level:this.level,evsToDistribute:this.evsToDistribute,fainted:this.fainted,moves:this.moves,ivs:this.ivs,evs:this.evs,nature:this.nature,gender:this.gender,heldItem:this.heldItem,isShiny:this.isShiny,status:this.status}}changeBattleStats(e,r){this.statCalc.changeBattleStats(e,r)}resetBattleStats(){this.statCalc.resetBattleStats()}selectMove(e,r){return this.moveMgr.selectMove(e,r)}canEvolve(){return this.xpMgr.canEvolve()}removeHp(e){this.currentHp=Math.max(0,this.currentHp-e),(isNaN(this.currentHp)||this.currentHp<=0)&&(this.currentHp=0,this.fainted=!0)}heal(e){this.currentHp+=e,this.currentHp>this.currentStats.hp&&(this.currentHp=this.currentStats.hp)}fullHeal(){this.revive(this.currentStats.hp)}revive(e){this.fainted=!1,this.currentHp=e}howMuchXpWon(e,r=1,n=!1,s){return this.xpMgr.howMuchXpWon(r,n,s)}addXpResult(e,r){return this.xpMgr.addXpResult(e,r)}addEv(e,r){this.xpMgr.addEv(e,r)}levelUp(){return this.xpMgr.levelUp()}evolve(e){return e.found&&e.result?new le(e.result,this.level,this.nature,this.isShiny,void 0,this):this}updateCurrentStats(){this.currentStats=this.statCalc.computeFromBaseStats(),this.xpToNextLevel=qe.howMuchINeed(this.level,this.growthRateId)}hasEffect(e){return this.status?.constructor.name===e}hasItem(e){return this.heldItem?.name===e}consumeHeldItem(){this.heldItem=void 0}selectLatestMoves(e){return this.moveMgr.selectLatestMoves(e)}getSprite(e){return this.isShiny?`src/assets/monsters/static/sprites-shiny${(e?"-back/":"/")+this.normalizedName}.png`:`src/assets/monsters/static/sprites${(e?"-back/":"/")+this.normalizedName}.png`}hasType(e){return this.types.includes(e)}restoreHp(e){this.heal(e)}setHp(e){this.currentHp=Math.min(e,this.currentStats.hp),this.currentHp<=0&&(this.currentHp=0,this.fainted=!0)}}var w=(t=>(t.START_TURN="start-turn",t.END_TURN="end-turn",t.BEFORE_MOVE="before-move",t.AFTER_MOVE="after-move",t.BEFORE_SWITCH="before-switch",t.AFTER_SWITCH="after-switch",t.BEFORE_FAINT="before-faint",t.AFTER_FAINT="after-faint",t.ON_SWITCH_IN="on-switch-in",t.ON_HIT="on-hit",t.ON_FAINT="on-faint",t))(w||{});class l{message;effect;hitCount;constructor(e,r,n){this.message=r,this.effect=e,this.hitCount=n}}class m{message;canPlay=!0;constructor(e,r){this.canPlay=e,this.message=r}}var dl=Object.getOwnPropertyDescriptor,hl=(t,e,r,n)=>{for(var s=n>1?void 0:n?dl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ir=class{move_effect_id=1;abr="";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;constructor(){}apply(t,e){return new l}playEffect(t,e){return new m}};ir=hl([v(),_([{token:"Effect",useClass:ir}])],ir);var ul=Object.getOwnPropertyDescriptor,pl=(t,e,r,n)=>{for(var s=n>1?void 0:n?ul(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let st=class{move_effect_id=2;abr="SLP";duration=0;when=w.START_TURN;damages=0;turnsPassed=0;healed=!1;apply(e,r){const n=new st;return n.duration=Math.floor(Math.random()*4)+2,new l(n,`${e[0].name} fell asleep!`)}playEffect(e,r){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,e.status=void 0,new m(!0,`${e.name} woke up!`)):new m(!1,`${e.name} is fast asleep!`)}};st=pl([v(),_([{token:"Effect",useClass:st}])],st);var fl=Object.getOwnPropertyDescriptor,ml=(t,e,r,n)=>{for(var s=n>1?void 0:n?fl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let nt=class{move_effect_id=3;abr="PSN";duration=-1;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;constructor(){}apply(t,e){const r=new nt;return r.damages=Math.floor(t[0].currentStats.hp/8),new l(r,`${t[0].name} is poisoned`)}playEffect(t,e){return t.removeHp(this.damages),new m(!0,`${t.name} is hurt by poison`)}};nt=ml([v(),_([{token:"Effect",useClass:nt}])],nt);var gl=Object.getOwnPropertyDescriptor,wl=(t,e,r,n)=>{for(var s=n>1?void 0:n?gl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let or=class{move_effect_id=4;abr="DRN";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(e&&t[0]){const r=Math.floor(this.damages/2);return e.heal(r),new l(void 0,`${e.name} had its energy drained!`)}return new l}playEffect(t,e){return new m}};or=wl([v(),_([{token:"Effect",useClass:or}])],or);var vl=Object.getOwnPropertyDescriptor,_l=(t,e,r,n)=>{for(var s=n>1?void 0:n?vl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Me=class{move_effect_id=5;abr="BRN";duration=-1;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;constructor(){}apply(t,e){const r=new Me;return r.damages=Math.floor(t[0].currentStats.hp/16),new l(r,`${t[0].name} is burnt`)}playEffect(t,e){return t.removeHp(this.damages),new m(!0,`${t.name} is hurt by burn`)}};Me=_l([v(),_([{token:"Effect",useClass:Me}])],Me);var yl=Object.getOwnPropertyDescriptor,bl=(t,e,r,n)=>{for(var s=n>1?void 0:n?yl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ne=class{move_effect_id=6;abr="FRZ";duration=-1;when=w.START_TURN;damages=0;turnsPassed=0;healed=!1;constructor(){}apply(t,e){return new l(new Ne,`${t[0].name} is frozen`)}playEffect(t,e){return Math.random()<.2&&(this.healed=!0,t.status=void 0),new m(this.healed,this.healed?`${t.name} thawed out`:`${t.name} is frozen solid`)}};Ne=bl([v(),_([{token:"Effect",useClass:Ne}])],Ne);var Sl=Object.getOwnPropertyDescriptor,El=(t,e,r,n)=>{for(var s=n>1?void 0:n?Sl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Be=class{move_effect_id=7;abr="PAR";duration=-1;when=w.START_TURN;damages=0;turnsPassed=0;healed=!1;constructor(){}apply(t,e){return new l(new Be,`${t[0].name} is paralyzed`)}playEffect(t,e){const r=Math.random()<.25;return new m(r,r?void 0:`${t.name} is fully paralyzed`)}};Be=El([v(),_([{token:"Effect",useClass:Be}])],Be);var Ol=Object.getOwnPropertyDescriptor,Pl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ol(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let lr=class{move_effect_id=8;abr="FNT";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.currentStats.hp=0,e.fainted=!0,new l(void 0,`${e.name} fainted from recoil!`)):new l}playEffect(t,e){return new m}};lr=Pl([v(),_([{token:"Effect",useClass:lr}])],lr);var kl=Object.getOwnPropertyDescriptor,Al=(t,e,r,n)=>{for(var s=n>1?void 0:n?kl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let cr=class{move_effect_id=9;abr="DRM";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(e&&t[0]){if(t[0].status?.abr!=="SLP")return new l(void 0,`${t[0].name} must be sleeping!`);const r=Math.floor(this.damages/2);return e.heal(r),new l(void 0,`${e.name} ate ${t[0].name}'s dreams!`)}return new l}playEffect(t,e){return new m}};cr=Al([v(),_([{token:"Effect",useClass:cr}])],cr);var Ml=Object.getOwnPropertyDescriptor,Cl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ml(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let dr=class{move_effect_id=10;abr="CPY";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;IGNORED_MOVES=new Set(["acid-armor","acupressure","after-you","agility","ally-switch","amnesia","aqua-ring","aromatherapy","aromatic-mist","assist","autotomize","barrier","baton-pass","belch","belly-drum","bide","bulk-up","calm-mind","camouflage","celebrate","charge","coil","conversion","conversion-2","copycat","cosmic-power","cotton-guard","counter","crafty-shield","curse","defend-order","defense-curl","destiny-bond","detect","doom-desire","double-team","dragon-dance","electric-terrain","endure","final-gambit","flower-shield","focus-energy","focus-punch","follow-me","future-sight","geomancy","grassy-terrain","gravity","growth","grudge","guard-split","hail","happy-hour","harden","haze","heal-bell","heal-order","heal-pulse","healing-wish","helping-hand","hold-hands","hone-claws","howl","imprison","ingrain","ion-deluge","iron-defense","kings-shield","light-screen","lucky-chant","lunar-dance","magic-coat","magnet-rise","magnetic-flux","mat-block","me-first","meditate","metronome","milk-drink","mimic","minimize","mirror-coat","mirror-move","mist","misty-terrain","moonlight","morning-sun","mud-sport","nasty-plot","nature-power","perish-song","power-split","power-trick","protect","psych-up","quick-guard","quiver-dance","rage-powder","rain-dance","recover","recycle","reflect","reflect-type","refresh","rest","rock-polish","role-play","roost","rototiller","safeguard","sandstorm","shadow-blast","shadow-bolt","shadow-half","shadow-rush","shadow-shed","shadow-sky","shadow-storm","shadow-wave","sharpen","shell-smash","shift-gear","sketch","slack-off","sleep-talk","snatch","soft-boiled","spikes","spiky-shield","spit-up","splash","stealth-rock","sticky-web","stockpile","struggle","substitute","sunny-day","swallow","swords-dance","synthesis","tail-glow","tailwind","teleport","toxic-spikes","transform","water-sport","wide-guard","wish","withdraw","work-up"]);apply(t,e){return t[0]?.lastMove?this.IGNORED_MOVES.has(t[0].lastMove.name.toLowerCase())?new l(void 0,"The move cannot be copied!"):new l(void 0,`${e?.name} used ${t[0].lastMove.name}!`):new l(void 0,"But it failed!")}playEffect(t,e){return new m(!0)}};dr=Cl([v(),_([{token:"Effect",useClass:dr}])],dr);var Il=Object.getOwnPropertyDescriptor,Tl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Il(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let hr=class{move_effect_id=11;abr="ATK+";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",1),new l(void 0,`${e.name}'s attack rose`)):new l}playEffect(t,e){return new m}};hr=Tl([v(),_([{token:"Effect",useClass:hr}])],hr);var Dl=Object.getOwnPropertyDescriptor,xl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Dl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ur=class{move_effect_id=12;abr="DEF+";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("defense",1),new l(void 0,`${e.name}'s defense rose`)):new l}playEffect(t,e){return new m}};ur=xl([v(),_([{token:"Effect",useClass:ur}])],ur);var Rl=Object.getOwnPropertyDescriptor,Fl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Rl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let $e=class{move_effect_id=13;abr="CNF";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){const r=new $e;return r.duration=Math.floor(Math.random()*4)+2,new l(r,`${t[0].name} became confused!`)}playEffect(t,e){if(this.turnsPassed++,this.turnsPassed>=this.duration)return this.healed=!0,t.status=void 0,new m(!0,`${t.name} snapped out of confusion!`);if(Math.random()<.33){const r=Math.floor(t.currentStats.attack*40/t.currentStats.defense/50+2);return t.removeHp(r),new m(!1,`${t.name} hurt itself in its confusion!`)}return new m(!0,`${t.name} is confused!`)}};$e=Fl([v(),_([{token:"Effect",useClass:$e}])],$e);var Nl=Object.getOwnPropertyDescriptor,Bl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Nl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let pr=class{move_effect_id=14;abr="DEF+";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialAttack",1),new l(void 0,`${e.name}'s special attack rose`)):new l}playEffect(t,e){return new m}};pr=Bl([v(),_([{token:"Effect",useClass:pr}])],pr);var $l=Object.getOwnPropertyDescriptor,Ll=(t,e,r,n)=>{for(var s=n>1?void 0:n?$l(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let fr=class{move_effect_id=15;abr="SPE+";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("speed",1),new l(void 0,`${e.name}'s speed rose!`)):new l}playEffect(t,e){return new m}};fr=Ll([v(),_([{token:"Effect",useClass:fr}])],fr);var Hl=Object.getOwnPropertyDescriptor,Vl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Hl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let mr=class{move_effect_id=16;abr="SPD+";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialDefense",1),new l(void 0,`${e.name}'s special defense rose!`)):new l}playEffect(t,e){return new m}};mr=Vl([v(),_([{token:"Effect",useClass:mr}])],mr);var Wl=Object.getOwnPropertyDescriptor,jl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Wl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let gr=class{move_effect_id=18;abr="ACC∞";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};gr=jl([v(),_([{token:"Effect",useClass:gr}])],gr);var Gl=Object.getOwnPropertyDescriptor,Ul=(t,e,r,n)=>{for(var s=n>1?void 0:n?Gl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let wr=class{move_effect_id=19;abr="ATK-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(t[0].changeBattleStats("attack",-1),new l(void 0,`${t[0].name}'s attack dropped`)):new l}playEffect(t,e){return new m}};wr=Ul([v(),_([{token:"Effect",useClass:wr}])],wr);var Yl=Object.getOwnPropertyDescriptor,Xl=(t,e,r,n)=>{for(var s=n>1?void 0:n?Yl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let vr=class{move_effect_id=20;abr="DEF-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(t[0].changeBattleStats("defense",-1),new l(void 0,`${t[0].name}'s defense dropped`)):new l}playEffect(t,e){return new m}};vr=Xl([v(),_([{token:"Effect",useClass:vr}])],vr);var Kl=Object.getOwnPropertyDescriptor,ql=(t,e,r,n)=>{for(var s=n>1?void 0:n?Kl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let _r=class{move_effect_id=21;abr="SPE-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(t[0].changeBattleStats("speed",-1),new l(void 0,`${t[0].name}'s speed dropped`)):new l}playEffect(t,e){return new m}};_r=ql([v(),_([{token:"Effect",useClass:_r}])],_r);var zl=Object.getOwnPropertyDescriptor,Jl=(t,e,r,n)=>{for(var s=n>1?void 0:n?zl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let yr=class{move_effect_id=22;abr="SPA-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(t[0].changeBattleStats("specialAttack",-1),new l(void 0,`${t[0].name}'s special attack fell!`)):new l}playEffect(t,e){return new m}};yr=Jl([v(),_([{token:"Effect",useClass:yr}])],yr);var Zl=Object.getOwnPropertyDescriptor,Ql=(t,e,r,n)=>{for(var s=n>1?void 0:n?Zl(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let br=class{move_effect_id=23;abr="SPD-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(t[0].changeBattleStats("specialDefense",-1),new l(void 0,`${t[0].name}'s special defense fell!`)):new l}playEffect(t,e){return new m}};br=Ql([v(),_([{token:"Effect",useClass:br}])],br);var ec=Object.getOwnPropertyDescriptor,tc=(t,e,r,n)=>{for(var s=n>1?void 0:n?ec(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Sr=class{move_effect_id=24;abr="ACC-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(t[0].changeBattleStats("accuracy",-1),new l(void 0,`${t[0].name}'s accuracy dropped`)):new l}playEffect(t,e){return new m}};Sr=tc([v(),_([{token:"Effect",useClass:Sr}])],Sr);var rc=Object.getOwnPropertyDescriptor,sc=(t,e,r,n)=>{for(var s=n>1?void 0:n?rc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Er=class{move_effect_id=25;abr="EVA-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(t[0].changeBattleStats("evasion",-1),new l(void 0,`${t[0].name}'s evasion dropped`)):new l}playEffect(t,e){return new m}};Er=sc([v(),_([{token:"Effect",useClass:Er}])],Er);var nc=Object.getOwnPropertyDescriptor,ac=(t,e,r,n)=>{for(var s=n>1?void 0:n?nc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Or=class{move_effect_id=26;abr="ALL+";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",1),e.changeBattleStats("defense",1),e.changeBattleStats("specialAttack",1),e.changeBattleStats("specialDefense",1),e.changeBattleStats("speed",1),new l(void 0,`${e.name}'s stats all rose!`)):new l}playEffect(t,e){return new m}};Or=ac([v(),_([{token:"Effect",useClass:Or}])],Or);var ic=Object.getOwnPropertyDescriptor,oc=(t,e,r,n)=>{for(var s=n>1?void 0:n?ic(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Pr=class{move_effect_id=27;abr="KO";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].currentStats.hp=0,t[0].fainted=!0,new l(void 0,"It's a one-hit KO!")):new l}playEffect(t,e){return new m}};Pr=oc([v(),_([{token:"Effect",useClass:Pr}])],Pr);var lc=Object.getOwnPropertyDescriptor,cc=(t,e,r,n)=>{for(var s=n>1?void 0:n?lc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let kr=class{move_effect_id=28;abr="CHG";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};kr=cc([v(),_([{token:"Effect",useClass:kr}])],kr);var dc=Object.getOwnPropertyDescriptor,hc=(t,e,r,n)=>{for(var s=n>1?void 0:n?dc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ar=class{move_effect_id=29;abr="SWT";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,`${t[0].name} was forced to switch out!`)}playEffect(t,e){return new m}};Ar=hc([v(),_([{token:"Effect",useClass:Ar}])],Ar);var uc=Object.getOwnPropertyDescriptor,pc=(t,e,r,n)=>{for(var s=n>1?void 0:n?uc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Mr=class{move_effect_id=30;abr="MLT";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){const n=e?.currentAbility?.toLowerCase().replace(/\s+/g,"-")==="skill-link"?5:(()=>{const s=Math.random();return s<.375?2:s<.75?3:s<.875?4:5})();return new l(void 0,`Hit ${n} times!`,n)}playEffect(t,e){return new m(!0)}};Mr=pc([v(),_([{token:"Effect",useClass:Mr}])],Mr);var fc=Object.getOwnPropertyDescriptor,mc=(t,e,r,n)=>{for(var s=n>1?void 0:n?fc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Cr=class{move_effect_id=31;abr="TYP";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(void 0,`${e.name}'s type changed!`):new l}playEffect(t,e){return new m}};Cr=mc([v(),_([{token:"Effect",useClass:Cr}])],Cr);var gc=Object.getOwnPropertyDescriptor,wc=(t,e,r,n)=>{for(var s=n>1?void 0:n?gc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ke=class{move_effect_id=32;abr="FLN";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(new ke,`${t[0].name} flinched!`)}playEffect(t,e){return new m(!1,`${t.name} flinched and couldn't move!`)}};ke=wc([v(),_([{token:"Effect",useClass:ke}])],ke);var vc=Object.getOwnPropertyDescriptor,_c=(t,e,r,n)=>{for(var s=n>1?void 0:n?vc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ir=class{move_effect_id=33;abr="RST";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(e){const r=Math.floor(e.stats.hp/2);return e.heal(r),new l(void 0,`${e.name} restored HP!`)}return new l}playEffect(t,e){return new m}};Ir=_c([v(),_([{token:"Effect",useClass:Ir}])],Ir);var yc=Object.getOwnPropertyDescriptor,bc=(t,e,r,n)=>{for(var s=n>1?void 0:n?yc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Xe=class{move_effect_id=34;abr="PSN+";duration=-1;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){const r=new Xe;return r.damages=Math.floor(t[0].currentStats.hp/16),new l(r,`${t[0].name} was badly poisoned!`)}playEffect(t,e){this.turnsPassed++;const r=Math.floor(this.damages*this.turnsPassed);return t.removeHp(r),new m(!0,`${t.name} is hurt by poison!`)}};Xe=bc([v(),_([{token:"Effect",useClass:Xe}])],Xe);var Sc=Object.getOwnPropertyDescriptor,Ec=(t,e,r,n)=>{for(var s=n>1?void 0:n?Sc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Tr=class{move_effect_id=35;abr="PAY";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.level*5,new l(void 0,"Coins scattered everywhere!")):new l}playEffect(t,e){return new m}};Tr=Ec([v(),_([{token:"Effect",useClass:Tr}])],Tr);var Oc=Object.getOwnPropertyDescriptor,Pc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Oc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Dr=class{move_effect_id=36;abr="RFL";duration=5;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?e.hasEffect("Reflect")?new l(void 0,"But it failed!"):(this.duration=e.hasItem("Light Clay")?8:5,new l(this,"A barrier appeared!")):new l}playEffect(t,e){return new m}};Dr=Pc([v(),_([{token:"Effect",useClass:Dr}])],Dr);var kc=Object.getOwnPropertyDescriptor,Ac=(t,e,r,n)=>{for(var s=n>1?void 0:n?kc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let xr=class{move_effect_id=37;abr="TRI";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(e){const r=Math.random();if(r<.33){const n=new Me;return n.damages=Math.floor(t[0].currentStats.hp/16),new l(n,`${t[0].name} was burned!`)}else return r<.66?new l(new Ne,`${t[0].name} was frozen solid!`):new l(new Be,`${t[0].name} was paralyzed!`)}return new l}playEffect(t,e){return new m}};xr=Ac([v(),_([{token:"Effect",useClass:xr}])],xr);var Mc=Object.getOwnPropertyDescriptor,Cc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Mc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Rr=class{move_effect_id=38;abr="RCH";duration=1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(this,`${e?.name} must recharge!`)}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0)):new m(!1,`${e?.name} must recharge!`)}};Rr=Cc([v(),_([{token:"Effect",useClass:Rr}])],Rr);var Ic=Object.getOwnPropertyDescriptor,Tc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ic(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Fr=class{move_effect_id=40;abr="MIM";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;IGNORED_MOVES=new Set(["chatter","metronome","mimic","sketch","struggle","transform"]);apply(t,e){if(!t[0]?.lastMove)return new l(void 0,"But it failed!");if(this.IGNORED_MOVES.has(t[0].lastMove.name.toLowerCase()))return new l(void 0,"The move cannot be mimicked!");const r=new MoveInstance(t[0].lastMove.id,t[0].lastMove.name,t[0].lastMove.type,t[0].lastMove.category,t[0].lastMove.power,t[0].lastMove.accuracy,5,t[0].lastMove.priority,t[0].lastMove.target,t[0].lastMove.effect,t[0].lastMove.effectChance,t[0].lastMove.description,t[0].lastMove.level);return e&&e.moves.length>0?(e.moves[0]=r,new l(void 0,`${e.name} learned ${t[0].lastMove.name}!`)):new l}playEffect(t,e){return new m}};Fr=Tc([v(),_([{token:"Effect",useClass:Fr}])],Fr);var Dc=Object.getOwnPropertyDescriptor,xc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Dc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Nr=class{move_effect_id=41;abr="HLF";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(t[0]){const r=Math.floor(t[0].currentStats.hp/2);return t[0].removeHp(r),new l(void 0,`${t[0].name} lost half of its HP!`)}return new l}playEffect(t,e){return new m}};Nr=xc([v(),_([{token:"Effect",useClass:Nr}])],Nr);var Rc=Object.getOwnPropertyDescriptor,Fc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Rc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Br=class{move_effect_id=42;abr="FIX";duration=0;when=w.AFTER_MOVE;damages=40;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].removeHp(this.damages),new l(void 0,`${t[0].name} took ${this.damages} damage!`)):new l}playEffect(t,e){return new m}};Br=Fc([v(),_([{token:"Effect",useClass:Br}])],Br);var Nc=Object.getOwnPropertyDescriptor,Bc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Nc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Pt=class{move_effect_id=43;abr="BND";duration=0;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(t[0]){const r=new Pt,n=Math.random();return n<.375?r.duration=2:n<.75?r.duration=3:n<.875?r.duration=4:r.duration=5,r.damages=Math.floor(t[0].currentStats.hp/16),new l(r,`${t[0].name} was trapped in the vortex!`)}return new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,`${t.name} was freed from the bind!`)):(t.removeHp(this.damages),new m(!0,`${t.name} is hurt by Bind!`))}};Pt=Bc([v(),_([{token:"Effect",useClass:Pt}])],Pt);var $c=Object.getOwnPropertyDescriptor,Lc=(t,e,r,n)=>{for(var s=n>1?void 0:n?$c(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let $r=class{move_effect_id=44;abr="CRT";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};$r=Lc([v(),_([{token:"Effect",useClass:$r}])],$r);var Hc=Object.getOwnPropertyDescriptor,Vc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Hc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Lr=class{move_effect_id=45;abr="DBL";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"Hit 2 times!")}playEffect(t,e){return new m(!0)}};Lr=Vc([v(),_([{token:"Effect",useClass:Lr}])],Lr);var Wc=Object.getOwnPropertyDescriptor,jc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Wc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Hr=class{move_effect_id=46;abr="RCL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;missed=!1;apply(t,e){if(e&&this.missed){const r=Math.floor(e.currentStats.hp/2);return e.removeHp(r),new l(void 0,`${e.name} kept going and crashed!`)}return new l}playEffect(t,e){return new m}};Hr=jc([v(),_([{token:"Effect",useClass:Hr}])],Hr);var Gc=Object.getOwnPropertyDescriptor,Uc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Gc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Wi=class{move_effect_id=47;abr="MIST";duration=5;when=w.START_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,"A protective mist surrounds your team!"):new l}playEffect(t,e){return new m(!0,"The mist prevents stat changes!")}};Wi=Uc([v(),_([{token:"Effect",useValue:"stat-protect"}])],Wi);var Yc=Object.getOwnPropertyDescriptor,Xc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Yc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Vr=class{move_effect_id=48;abr="FOC";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?e.status?.abr==="FOC"?new l(void 0,"But it failed!"):new l(this,`${e.name} is getting pumped!`):new l}playEffect(t,e){return new m(!0)}};Vr=Xc([v(),_([{token:"Effect",useClass:Vr}])],Vr);var Kc=Object.getOwnPropertyDescriptor,qc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Kc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Wr=class{move_effect_id=49;abr="RCL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(e&&this.damages>0){const r=Math.floor(this.damages/4);return e.removeHp(r),new l(void 0,`${e.name} is hit with recoil!`)}return new l}playEffect(t,e){return new m}};Wr=qc([v(),_([{token:"Effect",useClass:Wr}])],Wr);var zc=Object.getOwnPropertyDescriptor,Jc=(t,e,r,n)=>{for(var s=n>1?void 0:n?zc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let jr=class{move_effect_id=50;abr="CNF";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){const r=new $e;return r.duration=Math.floor(Math.random()*4)+2,new l(r,`${t[0].name} became confused!`)}playEffect(t,e){return new m}};jr=Jc([v(),_([{token:"Effect",useClass:jr}])],jr);var Zc=Object.getOwnPropertyDescriptor,Qc=(t,e,r,n)=>{for(var s=n>1?void 0:n?Zc(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Gr=class{move_effect_id=51;abr="ATK++";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",2),new l(void 0,`${e.name}'s attack sharply rose!`)):new l}playEffect(t,e){return new m}};Gr=Qc([v(),_([{token:"Effect",useClass:Gr}])],Gr);var ed=Object.getOwnPropertyDescriptor,td=(t,e,r,n)=>{for(var s=n>1?void 0:n?ed(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ur=class{move_effect_id=52;abr="DEF++";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("defense",2),new l(void 0,`${e.name}'s defense sharply rose!`)):new l}playEffect(t,e){return new m}};Ur=td([v(),_([{token:"Effect",useClass:Ur}])],Ur);var rd=Object.getOwnPropertyDescriptor,sd=(t,e,r,n)=>{for(var s=n>1?void 0:n?rd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Yr=class{move_effect_id=53;abr="SPE++";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("speed",2),new l(void 0,`${e.name}'s speed sharply rose!`)):new l}playEffect(t,e){return new m}};Yr=sd([v(),_([{token:"Effect",useClass:Yr}])],Yr);var nd=Object.getOwnPropertyDescriptor,ad=(t,e,r,n)=>{for(var s=n>1?void 0:n?nd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Xr=class{move_effect_id=54;abr="SPA++";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialAttack",2),new l(void 0,`${e.name}'s special attack sharply rose!`)):new l}playEffect(t,e){return new m}};Xr=ad([v(),_([{token:"Effect",useClass:Xr}])],Xr);var id=Object.getOwnPropertyDescriptor,od=(t,e,r,n)=>{for(var s=n>1?void 0:n?id(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Kr=class{move_effect_id=55;abr="SPD++";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialDefense",2),new l(void 0,`${e.name}'s special defense sharply rose!`)):new l}playEffect(t,e){return new m}};Kr=od([v(),_([{token:"Effect",useClass:Kr}])],Kr);var ld=Object.getOwnPropertyDescriptor,cd=(t,e,r,n)=>{for(var s=n>1?void 0:n?ld(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let qr=class{move_effect_id=56;abr="ACC";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("accuracy",1),new l(void 0,`${e.name}'s accuracy rose!`)):new l}playEffect(t,e){return new m}};qr=cd([v(),_([{token:"Effect",useClass:qr}])],qr);var dd=Object.getOwnPropertyDescriptor,hd=(t,e,r,n)=>{for(var s=n>1?void 0:n?dd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let zr=class{move_effect_id=57;abr="EVA";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("evasion",1),new l(void 0,`${e.name}'s evasiveness rose!`)):new l}playEffect(t,e){return new m}};zr=hd([v(),_([{token:"Effect",useClass:zr}])],zr);var ud=Object.getOwnPropertyDescriptor,pd=(t,e,r,n)=>{for(var s=n>1?void 0:n?ud(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Jr=class{move_effect_id=58;abr="TRN";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!t||t.length===0||!e)return new l;const r=t[0];e.types=[...r.types],e.moves=r.moves.map(a=>new MoveInstance(a.id,a.name,a.type,a.category,a.power,a.accuracy,5,a.priority,a.target,a.effect,a.effectChance,a.description,a.level));const n=e.currentStats.hp,s=e.currentHp;return e.stats={...r.stats},e.currentStats={...r.currentStats},e.currentStats.hp=n,e.currentHp=s,e.sprites=r.sprites,new l(void 0,`${e.name} transformed into ${r.name}!`)}playEffect(t,e){return new m}};Jr=pd([v(),_([{token:"Effect",useClass:Jr}])],Jr);var fd=Object.getOwnPropertyDescriptor,md=(t,e,r,n)=>{for(var s=n>1?void 0:n?fd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Zr=class{move_effect_id=59;abr="ATK--";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!t||t.length===0?new l:(t[0].changeBattleStats("attack",-2),new l(void 0,`${t[0].name}'s Attack fell sharply!`))}playEffect(t,e){return new m}};Zr=md([v(),_([{token:"Effect",useClass:Zr}])],Zr);var gd=Object.getOwnPropertyDescriptor,wd=(t,e,r,n)=>{for(var s=n>1?void 0:n?gd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Qr=class{move_effect_id=60;abr="DEF--";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!t||t.length===0?new l:(t[0].changeBattleStats("defense",-2),new l(void 0,`${t[0].name}'s Defense fell sharply!`))}playEffect(t,e){return new m}};Qr=wd([v(),_([{token:"Effect",useClass:Qr}])],Qr);var vd=Object.getOwnPropertyDescriptor,_d=(t,e,r,n)=>{for(var s=n>1?void 0:n?vd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let es=class{move_effect_id=61;abr="SPE--";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!t||t.length===0?new l:(t[0].changeBattleStats("speed",-2),new l(void 0,`${t[0].name}'s Speed fell sharply!`))}playEffect(t,e){return new m}};es=_d([v(),_([{token:"Effect",useClass:es}])],es);var yd=Object.getOwnPropertyDescriptor,bd=(t,e,r,n)=>{for(var s=n>1?void 0:n?yd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ts=class{move_effect_id=62;abr="SPA--";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!t||t.length===0?new l:(t[0].changeBattleStats("specialAttack",-2),new l(void 0,`${t[0].name}'s Special Attack fell sharply!`))}playEffect(t,e){return new m}};ts=bd([v(),_([{token:"Effect",useClass:ts}])],ts);var Sd=Object.getOwnPropertyDescriptor,Ed=(t,e,r,n)=>{for(var s=n>1?void 0:n?Sd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let rs=class{move_effect_id=63;abr="SPD--";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!t||t.length===0?new l:(t[0].changeBattleStats("specialDefense",-2),new l(void 0,`${t[0].name}'s Special Defense fell sharply!`))}playEffect(t,e){return new m}};rs=Ed([v(),_([{token:"Effect",useClass:rs}])],rs);var Od=Object.getOwnPropertyDescriptor,Pd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Od(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ss=class{move_effect_id=64;abr="ACC-2";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].changeBattleStats("accuracy",-2),new l(void 0,`${t[0].name}'s accuracy harshly fell!`)):new l}playEffect(t,e){return new m}};ss=Pd([v(),_([{token:"Effect",useClass:ss}])],ss);var kd=Object.getOwnPropertyDescriptor,Ad=(t,e,r,n)=>{for(var s=n>1?void 0:n?kd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ns=class{move_effect_id=65;abr="EVA-2";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].changeBattleStats("evasion",-2),new l(void 0,`${t[0].name}'s evasiveness harshly fell!`)):new l}playEffect(t,e){return new m}};ns=Ad([v(),_([{token:"Effect",useClass:ns}])],ns);var k=(t=>(t.NONE="none",t.RAIN="rain",t.SUN="sun",t.SAND="sand",t.HAIL="hail",t.STRONG_WINDS="strong_winds",t))(k||{}),li=(t=>(t.REFLECT="reflect",t.LIGHT_SCREEN="light_screen",t))(li||{}),ue=(t=>(t.STEALTH_ROCK="stealth_rock",t.SPIKES="spikes",t.TOXIC_SPIKES="toxic_spikes",t.STICKY_WEB="sticky_web",t))(ue||{}),we=(t=>(t.NONE="none",t.ELECTRIC="electric",t.GRASSY="grassy",t.PSYCHIC="psychic",t.MISTY="misty",t))(we||{});const Md={stealth_rock:1,spikes:3,toxic_spikes:2,sticky_web:1};class Cd{weather="none";weatherTurns=0;weatherVersion=0;terrain="none";terrainTurns=0;trickRoom=!1;trickRoomTurns=0;neutralizingGasActive=!1;version=0;allySide={screens:new Map,hazards:new Map};enemySide={screens:new Map,hazards:new Map};getSide(e){return e==="ally"?this.allySide:this.enemySide}setWeather(e,r=5){this.weather==="strong_winds"&&e!=="strong_winds"&&e!=="none"||(e==="none"?(this.weather="none",this.weatherTurns=0):(this.weather=e,this.weatherTurns=r),this.weatherVersion++)}setTerrain(e,r=5){e==="none"?(this.terrain="none",this.terrainTurns=0):(this.terrain=e,this.terrainTurns=r)}setTrickRoom(e,r=5){this.trickRoom&&e?(this.trickRoom=!1,this.trickRoomTurns=0):e?(this.trickRoom=!0,this.trickRoomTurns=r):(this.trickRoom=!1,this.trickRoomTurns=0)}addScreen(e,r,n=5){this.getSide(e).screens.set(r,n)}removeScreen(e,r){this.getSide(e).screens.delete(r)}hasScreen(e,r){return this.getSide(e).screens.has(r)}getScreenTurns(e,r){return this.getSide(e).screens.get(r)??0}addHazard(e,r){const n=this.getSide(e),s=n.hazards.get(r)??0,a=Md[r];s<a&&(n.hazards.set(r,s+1),this.version++)}removeHazard(e,r){this.getSide(e).hazards.delete(r),this.version++}clearHazards(e){this.getSide(e).hazards.clear(),this.version++}hasHazard(e,r){return this.getSide(e).hazards.has(r)}getHazardLayers(e,r){return this.getSide(e).hazards.get(r)??0}tickTurn(){this.weatherTurns>0&&(this.weatherTurns--,this.weatherVersion++,this.weatherTurns===0&&(this.weather="none")),this.terrainTurns>0&&(this.terrainTurns--,this.terrainTurns===0&&(this.terrain="none")),this.trickRoomTurns>0&&(this.trickRoomTurns--,this.trickRoomTurns===0&&(this.trickRoom=!1)),this.tickScreens(this.allySide),this.tickScreens(this.enemySide)}tickScreens(e){for(const[r,n]of e.screens)n<=1?e.screens.delete(r):e.screens.set(r,n-1)}clearField(){this.weather="none",this.weatherTurns=0,this.terrain="none",this.terrainTurns=0,this.trickRoom=!1,this.trickRoomTurns=0,this.allySide.screens.clear(),this.allySide.hazards.clear(),this.enemySide.screens.clear(),this.enemySide.hazards.clear()}}var Id=Object.getOwnPropertyDescriptor,Td=(t,e,r,n)=>{for(var s=n>1?void 0:n?Id(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let as=class{move_effect_id=204;abr="WTH";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};as=Td([v(),_([{token:"Effect",useClass:as}])],as);var Dd=Object.getOwnPropertyDescriptor,xd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Dd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let is=class{move_effect_id=66;abr="LSCR";duration=5;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?e.hasEffect("LightScreen")?new l(void 0,"But it failed!"):(this.duration=e.hasItem("Light Clay")?8:5,new l(this,"A barrier of light appeared!")):new l}playEffect(t,e){return new m}};is=xd([v(),_([{token:"Effect",useClass:is}])],is);var Rd=Object.getOwnPropertyDescriptor,Fd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Rd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let os=class{move_effect_id=67;abr="BRK";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"The protective barriers were broken!")}playEffect(t,e){return new m}};os=Fd([v(),_([{token:"Effect",useClass:os}])],os);var Nd=Object.getOwnPropertyDescriptor,Bd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Nd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ls=class{move_effect_id=68;abr="SLP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};ls=Bd([v(),_([{token:"Effect",useClass:ls}])],ls);var $d=Object.getOwnPropertyDescriptor,Ld=(t,e,r,n)=>{for(var s=n>1?void 0:n?$d(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let cs=class{move_effect_id=69;abr="DRP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0].hasItem("")?new l(void 0,`${t[0].name} dropped its item!`):new l}playEffect(t,e){return new m}};cs=Ld([v(),_([{token:"Effect",useClass:cs}])],cs);var Hd=Object.getOwnPropertyDescriptor,Vd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Hd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ds=class{move_effect_id=70;abr="LDEF";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"The chance to lower defense is handled in the battle system!")}playEffect(t,e){return new m}};ds=Vd([v(),_([{token:"Effect",useClass:ds}])],ds);var Wd=Object.getOwnPropertyDescriptor,jd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Wd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let hs=class{move_effect_id=71;abr="LSPE";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(void 0,"The chance to lower speed is handled in the battle system!"):new l}playEffect(t,e){return new m}};hs=jd([v(),_([{token:"Effect",useClass:hs}])],hs);var Gd=Object.getOwnPropertyDescriptor,Ud=(t,e,r,n)=>{for(var s=n>1?void 0:n?Gd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let us=class{move_effect_id=72;abr="LSPA";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(void 0,"The chance to lower special attack is handled in the battle system!"):new l}playEffect(t,e){return new m}};us=Ud([v(),_([{token:"Effect",useClass:us}])],us);var Yd=Object.getOwnPropertyDescriptor,Xd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Yd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ps=class{move_effect_id=73;abr="LSPD";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(void 0,"The chance to lower special defense is handled in the battle system!"):new l}playEffect(t,e){return new m}};ps=Xd([v(),_([{token:"Effect",useClass:ps}])],ps);var Kd=Object.getOwnPropertyDescriptor,qd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Kd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let fs=class{move_effect_id=74;abr="LACC";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(void 0,"The chance to lower accuracy is handled in the battle system!"):new l}playEffect(t,e){return new m}};fs=qd([v(),_([{token:"Effect",useClass:fs}])],fs);var zd=Object.getOwnPropertyDescriptor,Jd=(t,e,r,n)=>{for(var s=n>1?void 0:n?zd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ms=class{move_effect_id=75;abr="MYST";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].changeBattleStats("specialAttack",-1),new l(void 0,`${t[0].name}'s Special Attack fell!`)):new l}playEffect(t,e){return new m}};ms=Jd([v(),_([{token:"Effect",useClass:ms}])],ms);var Zd=Object.getOwnPropertyDescriptor,Qd=(t,e,r,n)=>{for(var s=n>1?void 0:n?Zd(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let gs=class{move_effect_id=76;abr="CHF";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"The charging and flinch chance is handled in the battle system!")}playEffect(t,e){return new m}};gs=Qd([v(),_([{token:"Effect",useClass:gs}])],gs);var eh=Object.getOwnPropertyDescriptor,th=(t,e,r,n)=>{for(var s=n>1?void 0:n?eh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ws=class{move_effect_id=77;abr="CNF";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"The chance to confuse is handled in the battle system!")}playEffect(t,e){return new m}};ws=th([v(),_([{token:"Effect",useClass:ws}])],ws);var rh=Object.getOwnPropertyDescriptor,sh=(t,e,r,n)=>{for(var s=n>1?void 0:n?rh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let vs=class{move_effect_id=78;abr="THP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"Hit twice! The chance to poison is handled in the battle system!")}playEffect(t,e){return new m}};vs=sh([v(),_([{token:"Effect",useClass:vs}])],vs);var nh=Object.getOwnPropertyDescriptor,ah=(t,e,r,n)=>{for(var s=n>1?void 0:n?nh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let _s=class{move_effect_id=79;abr="NME";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};_s=ah([v(),_([{token:"Effect",useClass:_s}])],_s);var ih=Object.getOwnPropertyDescriptor,oh=(t,e,r,n)=>{for(var s=n>1?void 0:n?ih(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ys=class{move_effect_id=80;abr="SUB";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;hp=0;apply(t,e){if(!e)return new l;const r=Math.floor(e.stats.hp/4);return e.currentHp<=r?new l(void 0,"But it failed!"):(e.removeHp(r),this.hp=r,new l(this,`${e.name} created a substitute!`))}playEffect(t,e){return new m(!0)}};ys=oh([v(),_([{token:"Effect",useClass:ys}])],ys);var lh=Object.getOwnPropertyDescriptor,ch=(t,e,r,n)=>{for(var s=n>1?void 0:n?lh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let bs=class{move_effect_id=81;abr="RCH";duration=1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} must recharge!`):new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0)):new m(!1,`${e?.name} must recharge!`)}};bs=ch([v(),_([{token:"Effect",useClass:bs}])],bs);var dh=Object.getOwnPropertyDescriptor,hh=(t,e,r,n)=>{for(var s=n>1?void 0:n?dh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ss=class{move_effect_id=82;abr="RAG";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} is getting angry!`):new l}playEffect(t,e){return e?(e.changeBattleStats("attack",1),new m(!0,`${e.name}'s rage is building!`)):new m}};Ss=hh([v(),_([{token:"Effect",useClass:Ss}])],Ss);var uh=Object.getOwnPropertyDescriptor,ph=(t,e,r,n)=>{for(var s=n>1?void 0:n?uh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Es=class{move_effect_id=83;abr="MIM2";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;IGNORED_MOVES=new Set(["chatter","metronome","mimic","sketch","struggle"]);apply(t,e){return t[0]?.lastMove?this.IGNORED_MOVES.has(t[0].lastMove.name.toLowerCase())?new l(void 0,"The move cannot be mimicked!"):new l(this,`${e?.name} copied ${t[0].lastMove.name}!`):new l(void 0,"But it failed!")}playEffect(t,e){return new m}};Es=ph([v(),_([{token:"Effect",useClass:Es}])],Es);var fh=Object.getOwnPropertyDescriptor,mh=(t,e,r,n)=>{for(var s=n>1?void 0:n?fh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Os=class{move_effect_id=84;abr="MTR";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;IGNORED_MOVES=new Set(["assist","chatter","copycat","counter","covet","destiny-bond","detect","endure","feint","focus-punch","follow-me","helping-hand","me-first","metronome","mimic","mirror-coat","mirror-move","protect","quick-guard","sketch","sleep-talk","snatch","struggle","switcheroo","thief","trick","wide-guard"]);apply(t,e){return e?new l(this,`${e.name} used Metronome!`):new l}playEffect(t,e){return new m}};Os=mh([v(),_([{token:"Effect",useClass:Os}])],Os);var gh=Object.getOwnPropertyDescriptor,wh=(t,e,r,n)=>{for(var s=n>1?void 0:n?gh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ps=class{move_effect_id=85;abr="SEED";duration=-1;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?t[0].hasType("Grass")?new l(void 0,"It doesn't affect the target!"):new l(this,`${t[0].name} was seeded!`):new l}playEffect(t,e){if(!t||!e)return new m;const r=Math.floor(t.stats.hp/8);return t.removeHp(r),e.restoreHp(r),new m(!0,`${t.name}'s health is sapped by Leech Seed!`)}};Ps=wh([v(),_([{token:"Effect",useClass:Ps}])],Ps);var vh=Object.getOwnPropertyDescriptor,_h=(t,e,r,n)=>{for(var s=n>1?void 0:n?vh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ks=class{move_effect_id=86;abr="SPL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"But nothing happened!")}playEffect(t,e){return new m}};ks=_h([v(),_([{token:"Effect",useClass:ks}])],ks);var yh=Object.getOwnPropertyDescriptor,bh=(t,e,r,n)=>{for(var s=n>1?void 0:n?yh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let As=class{move_effect_id=87;abr="DSB";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;disabledMove="";apply(t,e){return!t[0]||!t[0].lastMove?new l(void 0,"But it failed!"):(this.duration=Math.floor(Math.random()*4)+4,this.disabledMove=t[0].lastMove.name,new l(this,`${t[0].name}'s ${this.disabledMove} was disabled!`))}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,`${t.name}'s ${this.disabledMove} is no longer disabled!`)):t.selectedMove?.name===this.disabledMove?new m(!1,`${t.name}'s ${this.disabledMove} is disabled!`):new m}};As=bh([v(),_([{token:"Effect",useClass:As}])],As);var Sh=Object.getOwnPropertyDescriptor,Eh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Sh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ms=class{move_effect_id=88;abr="LVL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!e||!t[0]?new l:(this.damages=e.level,t[0].removeHp(this.damages),new l(void 0,`${t[0].name} took ${this.damages} damage!`))}playEffect(t,e){return new m}};Ms=Eh([v(),_([{token:"Effect",useClass:Ms}])],Ms);var Oh=Object.getOwnPropertyDescriptor,Ph=(t,e,r,n)=>{for(var s=n>1?void 0:n?Oh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Cs=class{move_effect_id=89;abr="RND";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e||!t[0])return new l;const r=e.level,n=(Math.floor(Math.random()*11)+5)*10;return this.damages=Math.floor(r*n/100),t[0].removeHp(this.damages),new l(void 0,`${t[0].name} took ${this.damages} damage!`)}playEffect(t,e){return new m}};Cs=Ph([v(),_([{token:"Effect",useClass:Cs}])],Cs);var kh=Object.getOwnPropertyDescriptor,Ah=(t,e,r,n)=>{for(var s=n>1?void 0:n?kh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Is=class{move_effect_id=90;abr="CNT";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e||!t[0])return new l;const r=e.lastDamageTaken||0;return r<=0||!e.lastAttacker?new l(void 0,"But it failed!"):(this.damages=r*2,e.lastAttacker.removeHp(this.damages),new l(void 0,`${e.lastAttacker.name} took ${this.damages} damage!`))}playEffect(t,e){return new m}};Is=Ah([v(),_([{token:"Effect",useClass:Is}])],Is);var Mh=Object.getOwnPropertyDescriptor,Ch=(t,e,r,n)=>{for(var s=n>1?void 0:n?Mh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ts=class{move_effect_id=91;abr="ENC";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;encoreMove="";apply(t,e){return!t[0]||!t[0].lastMove?new l(void 0,"But it failed!"):(this.duration=Math.floor(Math.random()*5)+4,this.encoreMove=t[0].lastMove.name,new Set(["encore","mimic","mirror-move","sketch","struggle","transform"]).has(this.encoreMove.toLowerCase())?new l(void 0,"But it failed!"):new l(this,`${t[0].name} got an encore!`))}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,`${t.name}'s encore ended!`)):new m(!0,`${t.name} is forced to use ${this.encoreMove}!`)}};Ts=Ch([v(),_([{token:"Effect",useClass:Ts}])],Ts);var Ih=Object.getOwnPropertyDescriptor,Th=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ih(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ds=class{move_effect_id=92;abr="PSP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e||!t[0])return new l;const r=e.currentHp+t[0].currentHp,n=Math.floor(r/2);return e.currentHp,t[0].currentHp,e.setHp(n),t[0].setHp(n),new l(void 0,"The battlers shared their pain!")}playEffect(t,e){return new m}};Ds=Th([v(),_([{token:"Effect",useClass:Ds}])],Ds);var Dh=Object.getOwnPropertyDescriptor,xh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Dh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let xs=class{move_effect_id=104;abr="";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m}};xs=xh([v(),_([{token:"Effect",useClass:xs}])],xs);var Rh=Object.getOwnPropertyDescriptor,Fh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Rh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Rs=class{move_effect_id=199;abr="RCL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(e&&this.damages>0){const r=Math.floor(this.damages/3);return e.removeHp(r),new l(void 0,`${e.name} is damaged by recoil!`)}return new l}playEffect(t,e){return new m}};Rs=Fh([v(),_([{token:"Effect",useClass:Rs}])],Rs);var Nh=Object.getOwnPropertyDescriptor,Bh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Nh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Fs=class{move_effect_id=157;abr="DEF+";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("defense",1),new l(void 0,`${e.name}'s Defense rose!`)):new l}playEffect(t,e){return new m}};Fs=Bh([v(),_([{token:"Effect",useClass:Fs}])],Fs);var $h=Object.getOwnPropertyDescriptor,Lh=(t,e,r,n)=>{for(var s=n>1?void 0:n?$h(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ns=class{move_effect_id=141;abr="ALL+";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){return e&&Math.random()*100<this.effectChance?(e.changeBattleStats("attack",1),e.changeBattleStats("defense",1),e.changeBattleStats("specialAttack",1),e.changeBattleStats("specialDefense",1),e.changeBattleStats("speed",1),new l(void 0,`All of ${e.name}'s stats rose!`)):new l}playEffect(t,e){return new m}};Ns=Lh([v(),_([{token:"Effect",useClass:Ns}])],Ns);var Hh=Object.getOwnPropertyDescriptor,Vh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Hh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let kt=class{move_effect_id=125;abr="SFG";duration=5;when=w.START_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?e.hasEffect("Safeguard")?new l(void 0,"But it failed!"):new l(new kt,`${e.name}'s team is protected by Safeguard!`):new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,"The Safeguard wore off!")):new m(!0)}};kt=Vh([v(),_([{token:"Effect",useClass:kt}])],kt);var Wh=Object.getOwnPropertyDescriptor,jh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Wh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Bs=class{move_effect_id=118;abr="ROL";duration=5;when=w.BEFORE_MOVE;damages=0;consecutiveUses=0;turnsPassed=0;healed=!1;apply(t,e){this.consecutiveUses++;const r=Math.pow(2,Math.min(this.consecutiveUses-1,4));return new l(this,`Power multiplied by ${r}!`)}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration&&(this.healed=!0,this.consecutiveUses=0),new m(!0)}};Bs=jh([v(),_([{token:"Effect",useClass:Bs}])],Bs);var Gh=Object.getOwnPropertyDescriptor,Uh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Gh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let $s=class{move_effect_id=114;abr="FST";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].statsChanges.evasion=0,new l(this,`${t[0].name} was identified!`)):new l}playEffect(t,e){return t.statsChanges.evasion=0,new m(!0)}};$s=Uh([v(),_([{token:"Effect",useClass:$s}])],$s);var Yh=Object.getOwnPropertyDescriptor,Xh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Yh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let At=class{move_effect_id=137;abr="RAN";duration=5;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){const r=e?.hasItem("Damp Rock")?8:5,n=new At;return n.duration=r,new l(n,"It started to rain!")}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,"The rain stopped.")):new m(!0)}};At=Xh([v(),_([{token:"Effect",useClass:At}])],At);var Kh=Object.getOwnPropertyDescriptor,qh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Kh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ls=class{move_effect_id=274;abr="BRN?";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){if(t[0]&&Math.random()*100<this.effectChance){if(t[0].status||t[0].types.includes("fire"))return new l;const r=new Me;return r.damages=Math.floor(t[0].currentStats.hp/16),t[0].status=r,new l(r,`${t[0].name} was burned!`)}return new l}playEffect(t,e){return new m}};Ls=qh([v(),_([{token:"Effect",useClass:Ls}])],Ls);var zh=Object.getOwnPropertyDescriptor,Jh=(t,e,r,n)=>{for(var s=n>1?void 0:n?zh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Hs=class{move_effect_id=129;abr="PRS";duration=0;when=w.BEFORE_MOVE;damages=0;targetSwitching=!1;turnsPassed=0;healed=!1;apply(t,e){return this.targetSwitching?new l(void 0,`${t[0]?.name} can't escape!`):new l}playEffect(t,e){return new m(!0)}};Hs=Jh([v(),_([{token:"Effect",useClass:Hs}])],Hs);var Zh=Object.getOwnPropertyDescriptor,Qh=(t,e,r,n)=>{for(var s=n>1?void 0:n?Zh(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Vs=class{move_effect_id=133;abr="WHL";duration=0;when=w.AFTER_MOVE;damages=0;weather;turnsPassed=0;healed=!1;apply(t,e){if(e){let r=.5;this.weather==="sun"||this.weather==="sunny"?r=2/3:(this.weather==="rain"||this.weather==="sandstorm"||this.weather==="hail")&&(r=.25);const n=Math.floor(e.stats.hp*r);return e.heal(n),new l(void 0,`${e.name} restored HP!`)}return new l}playEffect(t,e){return new m}};Vs=Qh([v(),_([{token:"Effect",useClass:Vs}])],Vs);var eu=Object.getOwnPropertyDescriptor,tu=(t,e,r,n)=>{for(var s=n>1?void 0:n?eu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ws=class{move_effect_id=39;abr="OHKO";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!t[0]||!e?new l(void 0,"But it failed!"):e.level<t[0].level?new l(void 0,"But it failed!"):(t[0].currentStats.hp=0,t[0].fainted=!0,new l(void 0,"It's a one-hit KO!"))}playEffect(t,e){return new m}};Ws=tu([v(),_([{token:"Effect",useClass:Ws}])],Ws);var ru=Object.getOwnPropertyDescriptor,su=(t,e,r,n)=>{for(var s=n>1?void 0:n?ru(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let js=class{move_effect_id=100;abr="FLR";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};js=su([v(),_([{token:"Effect",useClass:js}])],js);var nu=Object.getOwnPropertyDescriptor,au=(t,e,r,n)=>{for(var s=n>1?void 0:n?nu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Gs=class{move_effect_id=107;abr="TRP";duration=-1;when=w.BEFORE_SWITCH;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(this,`${t[0].name} can no longer escape!`):new l}playEffect(t,e){return new m(!1,`${t.name} can't escape!`)}};Gs=au([v(),_([{token:"Effect",useClass:Gs}])],Gs);var iu=Object.getOwnPropertyDescriptor,ou=(t,e,r,n)=>{for(var s=n>1?void 0:n?iu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Us=class{move_effect_id=112;abr="PRT";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;consecutiveUses=0;apply(t,e){if(!e)return new l;const r=Math.pow(.5,this.consecutiveUses);return Math.random()>r?(this.consecutiveUses=0,new l(void 0,"But it failed!")):(this.consecutiveUses++,new l(this,`${e.name} protected itself!`))}playEffect(t,e){return new m(!0)}};Us=ou([v(),_([{token:"Effect",useClass:Us}])],Us);var lu=Object.getOwnPropertyDescriptor,cu=(t,e,r,n)=>{for(var s=n>1?void 0:n?lu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Mt=class{move_effect_id=116;abr="SND";duration=5;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){const r=e?.hasItem("Smooth Rock")?8:5,n=new Mt;return n.duration=r,new l(n,"A sandstorm kicked up!")}playEffect(t,e){if(this.turnsPassed++,this.turnsPassed>=this.duration)return this.healed=!0,new m(!0,"The sandstorm subsided.");if(!t.hasType("Rock")&&!t.hasType("Ground")&&!t.hasType("Steel")){const r=Math.floor(t.stats.hp/16);return t.removeHp(r),new m(!0,`${t.name} is buffeted by the sandstorm!`)}return new m(!0)}};Mt=cu([v(),_([{token:"Effect",useClass:Mt}])],Mt);var du=Object.getOwnPropertyDescriptor,hu=(t,e,r,n)=>{for(var s=n>1?void 0:n?du(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ys=class{move_effect_id=117;abr="END";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;consecutiveUses=0;apply(t,e){if(!e)return new l;const r=Math.pow(.5,this.consecutiveUses);return Math.random()>r?(this.consecutiveUses=0,new l(void 0,"But it failed!")):(this.consecutiveUses++,new l(this,`${e.name} braced itself!`))}playEffect(t,e){return new m(!0)}};Ys=hu([v(),_([{token:"Effect",useClass:Ys}])],Ys);var uu=Object.getOwnPropertyDescriptor,pu=(t,e,r,n)=>{for(var s=n>1?void 0:n?uu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Xs=class{move_effect_id=128;abr="BTP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(void 0,`${e.name} is passing the baton!`):new l}playEffect(t,e){return new m}};Xs=pu([v(),_([{token:"Effect",useClass:Xs}])],Xs);var fu=Object.getOwnPropertyDescriptor,mu=(t,e,r,n)=>{for(var s=n>1?void 0:n?fu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ks=class{move_effect_id=130;abr="RSP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.status=void 0,new l(void 0,`${e.name} blew away hazards!`)):new l}playEffect(t,e){return new m}};Ks=mu([v(),_([{token:"Effect",useClass:Ks}])],Ks);var gu=Object.getOwnPropertyDescriptor,wu=(t,e,r,n)=>{for(var s=n>1?void 0:n?gu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let qs=class{move_effect_id=131;abr="FX20";duration=0;when=w.AFTER_MOVE;damages=20;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].removeHp(this.damages),new l(void 0,`${t[0].name} took 20 damage!`)):new l}playEffect(t,e){return new m}};qs=wu([v(),_([{token:"Effect",useClass:qs}])],qs);var vu=Object.getOwnPropertyDescriptor,_u=(t,e,r,n)=>{for(var s=n>1?void 0:n?vu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ct=class{move_effect_id=138;abr="SUN";duration=5;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){const r=e?.hasItem("Heat Rock")?8:5,n=new Ct;return n.duration=r,new l(n,"The sunlight turned harsh!")}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,"The sunlight faded.")):new m(!0)}};Ct=_u([v(),_([{token:"Effect",useClass:Ct}])],Ct);var yu=Object.getOwnPropertyDescriptor,bu=(t,e,r,n)=>{for(var s=n>1?void 0:n?yu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let zs=class{move_effect_id=139;abr="DEF?";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){return e&&Math.random()*100<this.effectChance?(e.changeBattleStats("defense",1),new l(void 0,`${e.name}'s Defense rose!`)):new l}playEffect(t,e){return new m}};zs=bu([v(),_([{token:"Effect",useClass:zs}])],zs);var Su=Object.getOwnPropertyDescriptor,Eu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Su(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Js=class{move_effect_id=140;abr="ATK?";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){return e&&Math.random()*100<this.effectChance?(e.changeBattleStats("attack",1),new l(void 0,`${e.name}'s Attack rose!`)):new l}playEffect(t,e){return new m}};Js=Eu([v(),_([{token:"Effect",useClass:Js}])],Js);var Ou=Object.getOwnPropertyDescriptor,Pu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ou(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Zs=class{move_effect_id=143;abr="BLD";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e)return new l;const r=Math.floor(e.stats.hp/2);return e.currentHp<=r?new l(void 0,"But it failed!"):(e.removeHp(r),e.statsChanges.attack=6,new l(void 0,`${e.name} maximized its Attack!`))}playEffect(t,e){return new m}};Zs=Pu([v(),_([{token:"Effect",useClass:Zs}])],Zs);var ku=Object.getOwnPropertyDescriptor,Au=(t,e,r,n)=>{for(var s=n>1?void 0:n?ku(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Qs=class{move_effect_id=144;abr="PSY";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!e||!t[0]?new l:(e.statsChanges={...t[0].statsChanges},new l(void 0,`${e.name} copied the stat changes!`))}playEffect(t,e){return new m}};Qs=Au([v(),_([{token:"Effect",useClass:Qs}])],Qs);var Mu=Object.getOwnPropertyDescriptor,Cu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Mu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let en=class{move_effect_id=145;abr="MRC";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e||!t[0])return new l;const r=e.lastDamageTaken||0;return r<=0?new l(void 0,"But it failed!"):(this.damages=r*2,t[0].removeHp(this.damages),new l(void 0,`${t[0].name} took ${this.damages} damage!`))}playEffect(t,e){return new m}};en=Cu([v(),_([{token:"Effect",useClass:en}])],en);var Iu=Object.getOwnPropertyDescriptor,Tu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Iu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let tn=class{move_effect_id=147;abr="FLN?";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=30;turnsPassed=0;healed=!1;apply(t,e){return t[0]&&Math.random()*100<this.effectChance?new l(new ke,`${t[0].name} flinched!`):new l}playEffect(t,e){return new m}};tn=Tu([v(),_([{token:"Effect",useClass:tn}])],tn);var Du=Object.getOwnPropertyDescriptor,xu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Du(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let rn=class{move_effect_id=148;abr="DIG";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};rn=xu([v(),_([{token:"Effect",useClass:rn}])],rn);var Ru=Object.getOwnPropertyDescriptor,Fu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ru(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let sn=class{move_effect_id=149;abr="DLY";duration=3;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(this,`${e?.name} foresaw an attack!`)}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration&&(this.healed=!0,this.damages>0)?(t.removeHp(this.damages),new m(!0,`${t.name} took the delayed attack!`)):new m(!0)}};sn=Fu([v(),_([{token:"Effect",useClass:sn}])],sn);var Nu=Object.getOwnPropertyDescriptor,Bu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Nu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let nn=class{move_effect_id=150;abr="FLY";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};nn=Bu([v(),_([{token:"Effect",useClass:nn}])],nn);var $u=Object.getOwnPropertyDescriptor,Lu=(t,e,r,n)=>{for(var s=n>1?void 0:n?$u(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let an=class{move_effect_id=151;abr="FLN!";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=30;turnsPassed=0;healed=!1;apply(t,e){return t[0]&&Math.random()*100<this.effectChance?new l(new ke,`${t[0].name} flinched!`):new l}playEffect(t,e){return new m}};an=Lu([v(),_([{token:"Effect",useClass:an}])],an);var Hu=Object.getOwnPropertyDescriptor,Vu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Hu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let on=class{move_effect_id=152;abr="SOL";duration=1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;charging=!1;apply(t,e){let r;try{r=ht.resolve("BattleField")}catch{}const n=r?.weather===k.SUN;return!this.charging&&!n?(this.charging=!0,new l(this,`${e?.name} is absorbing light!`)):(this.charging=!1,new l)}playEffect(t,e){return this.charging?new m(!1):new m(!0)}};on=Vu([v(),_([{token:"Effect",useClass:on}])],on);var Wu=Object.getOwnPropertyDescriptor,ju=(t,e,r,n)=>{for(var s=n>1?void 0:n?Wu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ln=class{move_effect_id=153;abr="THN";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=30;turnsPassed=0;healed=!1;apply(t,e){return t[0]&&!t[0].status&&Math.random()*100<this.effectChance?new l(new Be,`${t[0].name} is paralyzed!`):new l}playEffect(t,e){return new m}};ln=ju([v(),_([{token:"Effect",useClass:ln}])],ln);var Gu=Object.getOwnPropertyDescriptor,Uu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Gu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let cn=class{move_effect_id=154;abr="TLP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,`${e?.name} teleported away!`)}playEffect(t,e){return new m}};cn=Uu([v(),_([{token:"Effect",useClass:cn}])],cn);var Yu=Object.getOwnPropertyDescriptor,Xu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Yu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let dn=class{move_effect_id=155;abr="BTU";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"The party attacked together!")}playEffect(t,e){return new m(!0)}};dn=Xu([v(),_([{token:"Effect",useClass:dn}])],dn);var Ku=Object.getOwnPropertyDescriptor,qu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ku(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let hn=class{move_effect_id=159;abr="FKO";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(new ke,`${t[0].name} flinched!`):new l}playEffect(t,e){return new m}};hn=qu([v(),_([{token:"Effect",useClass:hn}])],hn);var zu=Object.getOwnPropertyDescriptor,Ju=(t,e,r,n)=>{for(var s=n>1?void 0:n?zu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let un=class{move_effect_id=160;abr="UPR";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(this.duration=Math.floor(Math.random()*4)+2,new l(this,`${e.name} caused an uproar!`)):new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,"The uproar ended.")):new m(!0,`${e?.name} is making an uproar!`)}};un=Ju([v(),_([{token:"Effect",useClass:un}])],un);var Zu=Object.getOwnPropertyDescriptor,Qu=(t,e,r,n)=>{for(var s=n>1?void 0:n?Zu(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let pn=class{move_effect_id=161;abr="STK";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;stockpileCount=0;apply(t,e){return e?this.stockpileCount>=3?new l(void 0,"But it failed!"):(this.stockpileCount++,e.changeBattleStats("defense",1),e.changeBattleStats("specialDefense",1),new l(this,`${e.name} stockpiled ${this.stockpileCount}!`)):new l}playEffect(t,e){return new m}};pn=Qu([v(),_([{token:"Effect",useClass:pn}])],pn);var ep=Object.getOwnPropertyDescriptor,tp=(t,e,r,n)=>{for(var s=n>1?void 0:n?ep(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let fn=class{move_effect_id=162;abr="SPU";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"Stockpile power was released!")}playEffect(t,e){return new m(!0)}};fn=tp([v(),_([{token:"Effect",useClass:fn}])],fn);var rp=Object.getOwnPropertyDescriptor,sp=(t,e,r,n)=>{for(var s=n>1?void 0:n?rp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let mn=class{move_effect_id=163;abr="SWL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e)return new l;const r=Math.floor(e.stats.hp/4);return e.heal(r),new l(void 0,`${e.name} recovered health!`)}playEffect(t,e){return new m}};mn=sp([v(),_([{token:"Effect",useClass:mn}])],mn);var np=Object.getOwnPropertyDescriptor,ap=(t,e,r,n)=>{for(var s=n>1?void 0:n?np(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let It=class{move_effect_id=165;abr="HAL";duration=5;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){const r=e?.hasItem("Icy Rock")?8:5,n=new It;return n.duration=r,new l(n,"It started to hail!")}playEffect(t,e){if(this.turnsPassed++,this.turnsPassed>=this.duration)return this.healed=!0,new m(!0,"The hail stopped.");if(!t.hasType("Ice")){const r=Math.floor(t.stats.hp/16);return t.removeHp(r),new m(!0,`${t.name} is pelted by hail!`)}return new m(!0)}};It=ap([v(),_([{token:"Effect",useClass:It}])],It);var ip=Object.getOwnPropertyDescriptor,op=(t,e,r,n)=>{for(var s=n>1?void 0:n?ip(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let gn=class{move_effect_id=166;abr="TOR";duration=-1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(this,`${t[0].name} was subjected to torment!`):new l}playEffect(t,e){return new m(!0)}};gn=op([v(),_([{token:"Effect",useClass:gn}])],gn);var lp=Object.getOwnPropertyDescriptor,cp=(t,e,r,n)=>{for(var s=n>1?void 0:n?lp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let wn=class{move_effect_id=167;abr="FLT";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!t[0])return new l;t[0].changeBattleStats("specialAttack",1);const r=new $e;return r.duration=Math.floor(Math.random()*4)+2,t[0].status=r,new l(r,`${t[0].name}'s Sp. Attack rose! It became confused!`)}playEffect(t,e){return new m}};wn=cp([v(),_([{token:"Effect",useClass:wn}])],wn);var dp=Object.getOwnPropertyDescriptor,hp=(t,e,r,n)=>{for(var s=n>1?void 0:n?dp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let vn=class{move_effect_id=168;abr="WOW";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!t[0])return new l;if(t[0].status||t[0].types.includes("fire"))return new l(void 0,"But it failed!");const r=new Me;return r.damages=Math.floor(t[0].currentStats.hp/16),t[0].status=r,new l(r,`${t[0].name} was burned!`)}playEffect(t,e){return new m}};vn=hp([v(),_([{token:"Effect",useClass:vn}])],vn);var up=Object.getOwnPropertyDescriptor,pp=(t,e,r,n)=>{for(var s=n>1?void 0:n?up(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let _n=class{move_effect_id=169;abr="MEM";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!e||!t[0]?new l:(t[0].changeBattleStats("attack",-2),t[0].changeBattleStats("specialAttack",-2),e.currentStats.hp=0,e.fainted=!0,new l(void 0,`${e.name} fainted! ${t[0].name}'s stats fell!`))}playEffect(t,e){return new m}};_n=pp([v(),_([{token:"Effect",useClass:_n}])],_n);var fp=Object.getOwnPropertyDescriptor,mp=(t,e,r,n)=>{for(var s=n>1?void 0:n?fp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let yn=class{move_effect_id=175;abr="CHG";duration=1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialDefense",1),new l(this,`${e.name} began charging power!`)):new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration&&(this.healed=!0),new m(!0)}};yn=mp([v(),_([{token:"Effect",useClass:yn}])],yn);var gp=Object.getOwnPropertyDescriptor,wp=(t,e,r,n)=>{for(var s=n>1?void 0:n?gp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let bn=class{move_effect_id=176;abr="TNT";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(this.duration=Math.floor(Math.random()*3)+3,new l(this,`${t[0].name} fell for the taunt!`)):new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,`${t.name}'s taunt wore off!`)):new m(!0)}};bn=wp([v(),_([{token:"Effect",useClass:bn}])],bn);var vp=Object.getOwnPropertyDescriptor,_p=(t,e,r,n)=>{for(var s=n>1?void 0:n?vp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Sn=class{move_effect_id=177;abr="HLP";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(this,`${e?.name} is ready to help ${t[0].name}!`):new l}playEffect(t,e){return new m(!0)}};Sn=_p([v(),_([{token:"Effect",useClass:Sn}])],Sn);var yp=Object.getOwnPropertyDescriptor,bp=(t,e,r,n)=>{for(var s=n>1?void 0:n?yp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let En=class{move_effect_id=178;abr="TRK";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!e||!t[0]?new l:new l(void 0,`${e.name} swapped items with ${t[0].name}!`)}playEffect(t,e){return new m}};En=bp([v(),_([{token:"Effect",useClass:En}])],En);var Sp=Object.getOwnPropertyDescriptor,Ep=(t,e,r,n)=>{for(var s=n>1?void 0:n?Sp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let On=class{move_effect_id=179;abr="RLP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!e||!t[0]?new l:new l(void 0,`${e.name} copied ${t[0].name}'s ability!`)}playEffect(t,e){return new m}};On=Ep([v(),_([{token:"Effect",useClass:On}])],On);var Op=Object.getOwnPropertyDescriptor,Pp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Op(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Pn=class{move_effect_id=180;abr="WSH";duration=2;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;healAmount=0;apply(t,e){return e?(this.healAmount=Math.floor(e.stats.hp/2),new l(this,`${e.name} made a wish!`)):new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,t.heal(this.healAmount),new m(!0,`${t.name}'s wish came true!`)):new m(!0)}};Pn=Pp([v(),_([{token:"Effect",useClass:Pn}])],Pn);var kp=Object.getOwnPropertyDescriptor,Ap=(t,e,r,n)=>{for(var s=n>1?void 0:n?kp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let kn=class{move_effect_id=182;abr="ING";duration=-1;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} planted its roots!`):new l}playEffect(t,e){const r=Math.floor(t.stats.hp/16);return t.heal(r),new m(!0,`${t.name} absorbed nutrients with its roots!`)}};kn=Ap([v(),_([{token:"Effect",useClass:kn}])],kn);var Mp=Object.getOwnPropertyDescriptor,Cp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Mp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let An=class{move_effect_id=183;abr="SPP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",-1),e.changeBattleStats("defense",-1),new l(void 0,`${e.name}'s Attack and Defense fell!`)):new l}playEffect(t,e){return new m}};An=Cp([v(),_([{token:"Effect",useClass:An}])],An);var Ip=Object.getOwnPropertyDescriptor,Tp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ip(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Mn=class{move_effect_id=184;abr="MGC";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} shrouded itself with Magic Coat!`):new l}playEffect(t,e){return new m(!0)}};Mn=Tp([v(),_([{token:"Effect",useClass:Mn}])],Mn);var Dp=Object.getOwnPropertyDescriptor,xp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Dp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Cn=class{move_effect_id=185;abr="RCY";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(void 0,`${e.name} found one item!`):new l}playEffect(t,e){return new m}};Cn=xp([v(),_([{token:"Effect",useClass:Cn}])],Cn);var Rp=Object.getOwnPropertyDescriptor,Fp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Rp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let In=class{move_effect_id=186;abr="RVG";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};In=Fp([v(),_([{token:"Effect",useClass:In}])],In);var Np=Object.getOwnPropertyDescriptor,Bp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Np(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Tn=class{move_effect_id=187;abr="BRK";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,"The wall shattered!")}playEffect(t,e){return new m(!0)}};Tn=Bp([v(),_([{token:"Effect",useClass:Tn}])],Tn);var $p=Object.getOwnPropertyDescriptor,Lp=(t,e,r,n)=>{for(var s=n>1?void 0:n?$p(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Dn=class{move_effect_id=188;abr="YWN";duration=2;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?t[0].status?new l(void 0,"But it failed!"):new l(this,`${t[0].name} became drowsy!`):new l}playEffect(t,e){if(this.turnsPassed++,this.turnsPassed>=this.duration&&(this.healed=!0,!t.status)){const r=new st;return r.duration=Math.floor(Math.random()*4)+2,t.status=r,new m(!0,`${t.name} fell asleep!`)}return new m(!0)}};Dn=Lp([v(),_([{token:"Effect",useClass:Dn}])],Dn);var Hp=Object.getOwnPropertyDescriptor,Vp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Hp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let xn=class{move_effect_id=189;abr="KOF";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?t[0].heldItem?(t[0].heldItem=void 0,new l(void 0,`${t[0].name} dropped its item!`)):new l:new l}playEffect(t,e){return new m}};xn=Vp([v(),_([{token:"Effect",useClass:xn}])],xn);var Wp=Object.getOwnPropertyDescriptor,jp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Wp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Rn=class{move_effect_id=190;abr="END";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e||!t[0])return new l;if(t[0].currentHp<=e.currentHp)return new l(void 0,"But it failed!");const r=t[0].currentHp-e.currentHp;return t[0].removeHp(r),new l(void 0,`${t[0].name}'s HP was reduced to ${e.currentHp}!`)}playEffect(t,e){return new m}};Rn=jp([v(),_([{token:"Effect",useClass:Rn}])],Rn);var Gp=Object.getOwnPropertyDescriptor,Up=(t,e,r,n)=>{for(var s=n>1?void 0:n?Gp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Fn=class{move_effect_id=191;abr="ERU";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};Fn=Up([v(),_([{token:"Effect",useClass:Fn}])],Fn);var Yp=Object.getOwnPropertyDescriptor,Xp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Yp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Nn=class{move_effect_id=193;abr="IMP";duration=-1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} sealed any moves its target shares with it!`):new l}playEffect(t,e){return new m(!0)}};Nn=Xp([v(),_([{token:"Effect",useClass:Nn}])],Nn);var Kp=Object.getOwnPropertyDescriptor,qp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Kp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Bn=class{move_effect_id=194;abr="RFR";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?e.status?.abr==="BRN"||e.status?.abr==="PAR"||e.status?.abr==="PSN"||e.status?.abr==="PSN+"?(e.status=void 0,new l(void 0,`${e.name} was cured of its status!`)):new l(void 0,"But it failed!"):new l}playEffect(t,e){return new m}};Bn=qp([v(),_([{token:"Effect",useClass:Bn}])],Bn);var zp=Object.getOwnPropertyDescriptor,Jp=(t,e,r,n)=>{for(var s=n>1?void 0:n?zp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let $n=class{move_effect_id=195;abr="GRD";duration=0;when=w.BEFORE_FAINT;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} wants its target to bear a grudge!`):new l}playEffect(t,e){return new m(!0)}};$n=Jp([v(),_([{token:"Effect",useClass:$n}])],$n);var Zp=Object.getOwnPropertyDescriptor,Qp=(t,e,r,n)=>{for(var s=n>1?void 0:n?Zp(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ln=class{move_effect_id=197;abr="WGT";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};Ln=Qp([v(),_([{token:"Effect",useClass:Ln}])],Ln);var ef=Object.getOwnPropertyDescriptor,tf=(t,e,r,n)=>{for(var s=n>1?void 0:n?ef(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Hn=class{move_effect_id=203;abr="TOX?";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){if(t[0]&&!t[0].status&&Math.random()*100<this.effectChance){const r=new Xe;return r.damages=Math.floor(t[0].currentStats.hp/16),t[0].status=r,new l(r,`${t[0].name} was badly poisoned!`)}return new l}playEffect(t,e){return new m}};Hn=tf([v(),_([{token:"Effect",useClass:Hn}])],Hn);var rf=Object.getOwnPropertyDescriptor,sf=(t,e,r,n)=>{for(var s=n>1?void 0:n?rf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Vn=class{move_effect_id=205;abr="SPA--";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialAttack",-2),new l(void 0,`${e.name}'s Special Attack harshly fell!`)):new l}playEffect(t,e){return new m}};Vn=sf([v(),_([{token:"Effect",useClass:Vn}])],Vn);var nf=Object.getOwnPropertyDescriptor,af=(t,e,r,n)=>{for(var s=n>1?void 0:n?nf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Wn=class{move_effect_id=206;abr="TKL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].changeBattleStats("attack",-1),t[0].changeBattleStats("defense",-1),new l(void 0,`${t[0].name}'s Attack and Defense fell!`)):new l}playEffect(t,e){return new m}};Wn=af([v(),_([{token:"Effect",useClass:Wn}])],Wn);var of=Object.getOwnPropertyDescriptor,lf=(t,e,r,n)=>{for(var s=n>1?void 0:n?of(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let jn=class{move_effect_id=207;abr="COS";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("defense",1),e.changeBattleStats("specialDefense",1),new l(void 0,`${e.name}'s Defense and Sp. Def rose!`)):new l}playEffect(t,e){return new m}};jn=lf([v(),_([{token:"Effect",useClass:jn}])],jn);var cf=Object.getOwnPropertyDescriptor,df=(t,e,r,n)=>{for(var s=n>1?void 0:n?cf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Gn=class{move_effect_id=209;abr="BLK";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",1),e.changeBattleStats("defense",1),new l(void 0,`${e.name}'s Attack and Defense rose!`)):new l}playEffect(t,e){return new m}};Gn=df([v(),_([{token:"Effect",useClass:Gn}])],Gn);var hf=Object.getOwnPropertyDescriptor,uf=(t,e,r,n)=>{for(var s=n>1?void 0:n?hf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Un=class{move_effect_id=211;abr="MUD";duration=5;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(this,"Fire's power was weakened!")}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration&&(this.healed=!0),new m(!0)}};Un=uf([v(),_([{token:"Effect",useClass:Un}])],Un);var pf=Object.getOwnPropertyDescriptor,ff=(t,e,r,n)=>{for(var s=n>1?void 0:n?pf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Yn=class{move_effect_id=212;abr="CLM";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialAttack",1),e.changeBattleStats("specialDefense",1),new l(void 0,`${e.name}'s Sp. Attack and Sp. Def rose!`)):new l}playEffect(t,e){return new m}};Yn=ff([v(),_([{token:"Effect",useClass:Yn}])],Yn);var mf=Object.getOwnPropertyDescriptor,gf=(t,e,r,n)=>{for(var s=n>1?void 0:n?mf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Xn=class{move_effect_id=213;abr="DDN";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",1),e.changeBattleStats("speed",1),new l(void 0,`${e.name}'s Attack and Speed rose!`)):new l}playEffect(t,e){return new m}};Xn=gf([v(),_([{token:"Effect",useClass:Xn}])],Xn);var wf=Object.getOwnPropertyDescriptor,vf=(t,e,r,n)=>{for(var s=n>1?void 0:n?wf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Kn=class{move_effect_id=215;abr="RST";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e)return new l;const r=Math.floor(e.stats.hp/2);return e.heal(r),new l(void 0,`${e.name} regained health!`)}playEffect(t,e){return new m}};Kn=vf([v(),_([{token:"Effect",useClass:Kn}])],Kn);var _f=Object.getOwnPropertyDescriptor,yf=(t,e,r,n)=>{for(var s=n>1?void 0:n?_f(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let qn=class{move_effect_id=369;abr="SHU";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e)return new l;let r;try{r=ht.resolve("BattleField")}catch{}const s=r?.weather===k.SAND?2/3:.5,a=Math.floor(e.currentStats.hp*s);return e.heal(a),new l(void 0,`${e.name} regained health!`)}playEffect(t,e){return new m}};qn=yf([v(),_([{token:"Effect",useClass:qn}])],qn);var bf=Object.getOwnPropertyDescriptor,Sf=(t,e,r,n)=>{for(var s=n>1?void 0:n?bf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let zn=class{move_effect_id=217;abr="MRE";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].statsChanges.evasion=0,new l(this,`${t[0].name} was identified!`)):new l}playEffect(t,e){return t.statsChanges.evasion=0,new m(!0)}};zn=Sf([v(),_([{token:"Effect",useClass:zn}])],zn);var Ef=Object.getOwnPropertyDescriptor,Of=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ef(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Jn=class{move_effect_id=218;abr="WUS";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?t[0].status?.abr==="SLP"?(t[0].status=void 0,new l(void 0,`${t[0].name} woke up!`)):new l:new l}playEffect(t,e){return new m}};Jn=Of([v(),_([{token:"Effect",useClass:Jn}])],Jn);var Pf=Object.getOwnPropertyDescriptor,kf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Pf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Zn=class{move_effect_id=219;abr="SPE-";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("speed",-1),new l(void 0,`${e.name}'s Speed fell!`)):new l}playEffect(t,e){return new m}};Zn=kf([v(),_([{token:"Effect",useClass:Zn}])],Zn);var Af=Object.getOwnPropertyDescriptor,Mf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Af(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Qn=class{move_effect_id=220;abr="GYR";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};Qn=Mf([v(),_([{token:"Effect",useClass:Qn}])],Qn);var Cf=Object.getOwnPropertyDescriptor,If=(t,e,r,n)=>{for(var s=n>1?void 0:n?Cf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ea=class{move_effect_id=221;abr="HLW";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.currentStats.hp=0,e.fainted=!0,new l(this,`${e.name}'s healing wish came true for its ally!`)):new l}playEffect(t,e){return new m}};ea=If([v(),_([{token:"Effect",useClass:ea}])],ea);var Tf=Object.getOwnPropertyDescriptor,Df=(t,e,r,n)=>{for(var s=n>1?void 0:n?Tf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ta=class{move_effect_id=222;abr="BRN";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};ta=Df([v(),_([{token:"Effect",useClass:ta}])],ta);var xf=Object.getOwnPropertyDescriptor,Rf=(t,e,r,n)=>{for(var s=n>1?void 0:n?xf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ra=class{move_effect_id=224;abr="FNT";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};ra=Rf([v(),_([{token:"Effect",useClass:ra}])],ra);var Ff=Object.getOwnPropertyDescriptor,Nf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Ff(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let sa=class{move_effect_id=226;abr="TLW";duration=4;when=w.START_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(this,"A tailwind blew from behind your team!")}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,"The tailwind petered out!")):new m(!0)}};sa=Nf([v(),_([{token:"Effect",useClass:sa}])],sa);var Bf=Object.getOwnPropertyDescriptor,$f=(t,e,r,n)=>{for(var s=n>1?void 0:n?Bf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let na=class{move_effect_id=229;abr="UTN";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(void 0,`${e.name} went back!`):new l}playEffect(t,e){return new m}};na=$f([v(),_([{token:"Effect",useClass:na}])],na);var Lf=Object.getOwnPropertyDescriptor,Hf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Lf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let aa=class{move_effect_id=230;abr="CC";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("defense",-1),e.changeBattleStats("specialDefense",-1),new l(void 0,`${e.name}'s Defense and Sp. Def fell!`)):new l}playEffect(t,e){return new m}};aa=Hf([v(),_([{token:"Effect",useClass:aa}])],aa);var Vf=Object.getOwnPropertyDescriptor,Wf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Vf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ia=class{move_effect_id=231;abr="PBK";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};ia=Wf([v(),_([{token:"Effect",useClass:ia}])],ia);var jf=Object.getOwnPropertyDescriptor,Gf=(t,e,r,n)=>{for(var s=n>1?void 0:n?jf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let oa=class{move_effect_id=232;abr="ASR";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};oa=Gf([v(),_([{token:"Effect",useClass:oa}])],oa);var Uf=Object.getOwnPropertyDescriptor,Yf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Uf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let la=class{move_effect_id=238;abr="WRO";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};la=Yf([v(),_([{token:"Effect",useClass:la}])],la);var Xf=Object.getOwnPropertyDescriptor,Kf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Xf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ca=class{move_effect_id=240;abr="GAC";duration=-1;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(this,`${t[0].name}'s Ability was suppressed!`):new l}playEffect(t,e){return new m(!0)}};ca=Kf([v(),_([{token:"Effect",useClass:ca}])],ca);var qf=Object.getOwnPropertyDescriptor,zf=(t,e,r,n)=>{for(var s=n>1?void 0:n?qf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let da=class{move_effect_id=247;abr="LRS";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};da=zf([v(),_([{token:"Effect",useClass:da}])],da);var Jf=Object.getOwnPropertyDescriptor,Zf=(t,e,r,n)=>{for(var s=n>1?void 0:n?Jf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ha=class{move_effect_id=248;abr="WRS";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?new l(void 0,`${t[0].name}'s ability became Insomnia!`):new l}playEffect(t,e){return new m}};ha=Zf([v(),_([{token:"Effect",useClass:ha}])],ha);var Qf=Object.getOwnPropertyDescriptor,em=(t,e,r,n)=>{for(var s=n>1?void 0:n?Qf(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ua=class{move_effect_id=250;abr="TSK";duration=-1;when=w.AFTER_SWITCH;damages=0;turnsPassed=0;healed=!1;layers=0;apply(t,e){return this.layers>=2?new l(void 0,"But it failed!"):(this.layers++,new l(this,"Poison spikes were scattered on the ground!"))}playEffect(t,e){if(!t.hasType("Poison")&&!t.hasType("Steel")&&!t.hasType("Flying"))if(this.layers===1){const r=new nt;return r.damages=Math.floor(t.currentStats.hp/8),t.status=r,new m(!0,`${t.name} was poisoned!`)}else{const r=new Xe;return r.damages=Math.floor(t.currentStats.hp/16),t.status=r,new m(!0,`${t.name} was badly poisoned!`)}return new m(!0)}};ua=em([v(),_([{token:"Effect",useClass:ua}])],ua);var tm=Object.getOwnPropertyDescriptor,rm=(t,e,r,n)=>{for(var s=n>1?void 0:n?tm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let pa=class{move_effect_id=252;abr="AQR";duration=-1;when=w.END_TURN;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} surrounded itself with a veil of water!`):new l}playEffect(t,e){const r=Math.floor(t.stats.hp/16);return t.heal(r),new m(!0,`Aqua Ring restored ${t.name}'s HP!`)}};pa=rm([v(),_([{token:"Effect",useClass:pa}])],pa);var sm=Object.getOwnPropertyDescriptor,nm=(t,e,r,n)=>{for(var s=n>1?void 0:n?sm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let fa=class{move_effect_id=253;abr="MGR";duration=5;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?new l(this,`${e.name} levitated with electromagnetism!`):new l}playEffect(t,e){return this.turnsPassed++,this.turnsPassed>=this.duration?(this.healed=!0,new m(!0,"The electromagnetism wore off.")):new m(!0)}};fa=nm([v(),_([{token:"Effect",useClass:fa}])],fa);var am=Object.getOwnPropertyDescriptor,im=(t,e,r,n)=>{for(var s=n>1?void 0:n?am(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ma=class{move_effect_id=254;abr="FLB";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){if(!e)return new l;if(this.damages>0){const r=Math.floor(this.damages/3);e.removeHp(r)}if(t[0]&&!t[0].status&&Math.random()*100<this.effectChance){const r=new Me;return r.damages=Math.floor(t[0].currentStats.hp/16),t[0].status=r,new l(r,`${e.name} is damaged by recoil! ${t[0].name} was burned!`)}return new l(void 0,`${e.name} is damaged by recoil!`)}playEffect(t,e){return new m}};ma=im([v(),_([{token:"Effect",useClass:ma}])],ma);var om=Object.getOwnPropertyDescriptor,lm=(t,e,r,n)=>{for(var s=n>1?void 0:n?om(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ga=class{move_effect_id=256;abr="DIV";duration=1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;diving=!1;apply(t,e){return this.diving?(this.diving=!1,new l):(this.diving=!0,new l(this,`${e?.name} dove underwater!`))}playEffect(t,e){return this.diving?new m(!1):new m(!0)}};ga=lm([v(),_([{token:"Effect",useClass:ga}])],ga);var cm=Object.getOwnPropertyDescriptor,dm=(t,e,r,n)=>{for(var s=n>1?void 0:n?cm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let wa=class{move_effect_id=257;abr="DIG";duration=1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;digging=!1;apply(t,e){return this.digging?(this.digging=!1,new l):(this.digging=!0,new l(this,`${e?.name} dug a hole!`))}playEffect(t,e){return this.digging?new m(!1):new m(!0)}};wa=dm([v(),_([{token:"Effect",useClass:wa}])],wa);var hm=Object.getOwnPropertyDescriptor,um=(t,e,r,n)=>{for(var s=n>1?void 0:n?hm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let va=class{move_effect_id=261;abr="FRZ?";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){return t[0]&&!t[0].status&&Math.random()*100<this.effectChance?t[0].types.includes("ice")?new l:new l(new Ne,`${t[0].name} was frozen solid!`):new l}playEffect(t,e){return new m}};va=um([v(),_([{token:"Effect",useClass:va}])],va);var pm=Object.getOwnPropertyDescriptor,fm=(t,e,r,n)=>{for(var s=n>1?void 0:n?pm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let _a=class{move_effect_id=264;abr="BNC";duration=1;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;bouncing=!1;apply(t,e){return this.bouncing?(this.bouncing=!1,new l):(this.bouncing=!0,new l(this,`${e?.name} sprang up!`))}playEffect(t,e){return this.bouncing?new m(!1):new m(!0)}};_a=fm([v(),_([{token:"Effect",useClass:_a}])],_a);var mm=Object.getOwnPropertyDescriptor,gm=(t,e,r,n)=>{for(var s=n>1?void 0:n?mm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ya=class{move_effect_id=267;abr="SRK";duration=-1;when=w.AFTER_SWITCH;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(this,"Pointed stones float in the air around the opposing team!")}playEffect(t,e){const r=Math.floor(t.stats.hp/8);return t.removeHp(r),new m(!0,`${t.name} was hurt by the pointed stones!`)}};ya=gm([v(),_([{token:"Effect",useClass:ya}])],ya);var wm=Object.getOwnPropertyDescriptor,vm=(t,e,r,n)=>{for(var s=n>1?void 0:n?wm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ba=class{move_effect_id=113;abr="SPK";duration=-1;when=w.AFTER_SWITCH;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(this,"Spikes were scattered on the ground around the opposing team!")}playEffect(t,e){if(!t.hasType("Flying")){const r=Math.floor(t.stats.hp/8);return t.removeHp(r),new m(!0,`${t.name} was hurt by the spikes!`)}return new m}};ba=vm([v(),_([{token:"Effect",useClass:ba}])],ba);var _m=Object.getOwnPropertyDescriptor,ym=(t,e,r,n)=>{for(var s=n>1?void 0:n?_m(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Sa=class{move_effect_id=275;abr="FFN";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){if(!t[0])return new l;let r="";return!t[0].status&&Math.random()*100<this.effectChance&&(t[0].types.includes("ice")||(t[0].status=new Ne,r+=`${t[0].name} was frozen solid! `)),Math.random()*100<this.effectChance?new l(new ke,r+`${t[0].name} flinched!`):r?new l(void 0,r):new l}playEffect(t,e){return new m}};Sa=ym([v(),_([{token:"Effect",useClass:Sa}])],Sa);var bm=Object.getOwnPropertyDescriptor,Sm=(t,e,r,n)=>{for(var s=n>1?void 0:n?bm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ea=class{move_effect_id=276;abr="PFN";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=10;turnsPassed=0;healed=!1;apply(t,e){if(!t[0])return new l;let r="";return!t[0].status&&Math.random()*100<this.effectChance&&(t[0].status=new Be,r+=`${t[0].name} is paralyzed! `),Math.random()*100<this.effectChance?new l(new ke,r+`${t[0].name} flinched!`):r?new l(void 0,r):new l}playEffect(t,e){return new m}};Ea=Sm([v(),_([{token:"Effect",useClass:Ea}])],Ea);var Em=Object.getOwnPropertyDescriptor,Om=(t,e,r,n)=>{for(var s=n>1?void 0:n?Em(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Oa=class{move_effect_id=277;abr="SPA?";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=70;turnsPassed=0;healed=!1;apply(t,e){return e&&Math.random()*100<this.effectChance?(e.changeBattleStats("specialAttack",1),new l(void 0,`${e.name}'s Special Attack rose!`)):new l}playEffect(t,e){return new m}};Oa=Om([v(),_([{token:"Effect",useClass:Oa}])],Oa);var Pm=Object.getOwnPropertyDescriptor,km=(t,e,r,n)=>{for(var s=n>1?void 0:n?Pm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Pa=class{move_effect_id=283;abr="PSS";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};Pa=km([v(),_([{token:"Effect",useClass:Pa}])],Pa);var Am=Object.getOwnPropertyDescriptor,Mm=(t,e,r,n)=>{for(var s=n>1?void 0:n?Am(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ka=class{move_effect_id=285;abr="ATM";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("speed",2),new l(void 0,`${e.name} became nimble!`)):new l}playEffect(t,e){return new m}};ka=Mm([v(),_([{token:"Effect",useClass:ka}])],ka);var Cm=Object.getOwnPropertyDescriptor,Im=(t,e,r,n)=>{for(var s=n>1?void 0:n?Cm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Aa=class{move_effect_id=290;abr="SPL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m}};Aa=Im([v(),_([{token:"Effect",useClass:Aa}])],Aa);var Tm=Object.getOwnPropertyDescriptor,Dm=(t,e,r,n)=>{for(var s=n>1?void 0:n?Tm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ma=class{move_effect_id=291;abr="QVD";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("specialAttack",1),e.changeBattleStats("specialDefense",1),e.changeBattleStats("speed",1),new l(void 0,`${e.name}'s Sp. Atk, Sp. Def, and Speed rose!`)):new l}playEffect(t,e){return new m}};Ma=Dm([v(),_([{token:"Effect",useClass:Ma}])],Ma);var xm=Object.getOwnPropertyDescriptor,Rm=(t,e,r,n)=>{for(var s=n>1?void 0:n?xm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ca=class{move_effect_id=294;abr="ELB";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};Ca=Rm([v(),_([{token:"Effect",useClass:Ca}])],Ca);var Fm=Object.getOwnPropertyDescriptor,Nm=(t,e,r,n)=>{for(var s=n>1?void 0:n?Fm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ia=class{move_effect_id=296;abr="FLC";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("speed",1),new l(void 0,`${e.name}'s Speed rose!`)):new l}playEffect(t,e){return new m}};Ia=Nm([v(),_([{token:"Effect",useClass:Ia}])],Ia);var Bm=Object.getOwnPropertyDescriptor,$m=(t,e,r,n)=>{for(var s=n>1?void 0:n?Bm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ta=class{move_effect_id=304;abr="CHP";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};Ta=$m([v(),_([{token:"Effect",useClass:Ta}])],Ta);var Lm=Object.getOwnPropertyDescriptor,Hm=(t,e,r,n)=>{for(var s=n>1?void 0:n?Lm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Da=class{move_effect_id=305;abr="CLR";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return t[0]?(t[0].statsChanges={attack:0,defense:0,specialAttack:0,specialDefense:0,speed:0,accuracy:0,evasion:0,hp:0,total:0},new l(void 0,`${t[0].name}'s stat changes were eliminated!`)):new l}playEffect(t,e){return new m}};Da=Hm([v(),_([{token:"Effect",useClass:Da}])],Da);var Vm=Object.getOwnPropertyDescriptor,Wm=(t,e,r,n)=>{for(var s=n>1?void 0:n?Vm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let xa=class{move_effect_id=309;abr="SMS";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",2),e.changeBattleStats("specialAttack",2),e.changeBattleStats("speed",2),e.changeBattleStats("defense",-1),e.changeBattleStats("specialDefense",-1),new l(void 0,`${e.name} smashed its shell!`)):new l}playEffect(t,e){return new m}};xa=Wm([v(),_([{token:"Effect",useClass:xa}])],xa);var jm=Object.getOwnPropertyDescriptor,Gm=(t,e,r,n)=>{for(var s=n>1?void 0:n?jm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ra=class{move_effect_id=310;abr="HLP";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!t[0])return new l;const r=Math.floor(t[0].stats.hp/2);return t[0].heal(r),new l(void 0,`${t[0].name} had its HP restored!`)}playEffect(t,e){return new m}};Ra=Gm([v(),_([{token:"Effect",useClass:Ra}])],Ra);var Um=Object.getOwnPropertyDescriptor,Ym=(t,e,r,n)=>{for(var s=n>1?void 0:n?Um(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Fa=class{move_effect_id=311;abr="HEX";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};Fa=Ym([v(),_([{token:"Effect",useClass:Fa}])],Fa);var Xm=Object.getOwnPropertyDescriptor,Km=(t,e,r,n)=>{for(var s=n>1?void 0:n?Xm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Na=class{move_effect_id=314;abr="CTR";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(void 0,`${t[0]?.name} was forced to switch out!`)}playEffect(t,e){return new m}};Na=Km([v(),_([{token:"Effect",useClass:Na}])],Na);var qm=Object.getOwnPropertyDescriptor,zm=(t,e,r,n)=>{for(var s=n>1?void 0:n?qm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ba=class{move_effect_id=317;abr="GRW";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e)return new l;let r;try{r=ht.resolve("BattleField")}catch{}const n=r?.weather===k.SUN,s=n?2:1;return e.changeBattleStats("attack",s),e.changeBattleStats("specialAttack",s),new l(void 0,n?`${e.name}'s Attack and Sp. Attack rose sharply!`:`${e.name}'s Attack and Sp. Attack rose!`)}playEffect(t,e){return new m}};Ba=zm([v(),_([{token:"Effect",useClass:Ba}])],Ba);var Jm=Object.getOwnPropertyDescriptor,Zm=(t,e,r,n)=>{for(var s=n>1?void 0:n?Jm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let $a=class{move_effect_id=318;abr="ACR";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};$a=Zm([v(),_([{token:"Effect",useClass:$a}])],$a);var Qm=Object.getOwnPropertyDescriptor,eg=(t,e,r,n)=>{for(var s=n>1?void 0:n?Qm(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let La=class{move_effect_id=320;abr="RTL";duration=0;when=w.BEFORE_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l}playEffect(t,e){return new m(!0)}};La=eg([v(),_([{token:"Effect",useClass:La}])],La);var tg=Object.getOwnPropertyDescriptor,rg=(t,e,r,n)=>{for(var s=n>1?void 0:n?tg(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ha=class{move_effect_id=321;abr="FGB";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){if(!e||!t[0])return new l;const r=e.currentHp;return t[0].removeHp(r),e.currentStats.hp=0,e.fainted=!0,new l(void 0,`${e.name} sacrificed itself to deal ${r} damage!`)}playEffect(t,e){return new m}};Ha=rg([v(),_([{token:"Effect",useClass:Ha}])],Ha);var sg=Object.getOwnPropertyDescriptor,ng=(t,e,r,n)=>{for(var s=n>1?void 0:n?sg(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Va=class{move_effect_id=323;abr="COL";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("attack",1),e.changeBattleStats("defense",1),e.changeBattleStats("accuracy",1),new l(void 0,`${e.name}'s Attack, Defense, and accuracy rose!`)):new l}playEffect(t,e){return new m}};Va=ng([v(),_([{token:"Effect",useClass:Va}])],Va);var ag=Object.getOwnPropertyDescriptor,ig=(t,e,r,n)=>{for(var s=n>1?void 0:n?ag(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Wa=class{move_effect_id=324;abr="BST";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return!e||!t[0]?new l:new l(void 0,`${e.name} gave its item to ${t[0].name}!`)}playEffect(t,e){return new m}};Wa=ig([v(),_([{token:"Effect",useClass:Wa}])],Wa);var og=Object.getOwnPropertyDescriptor,lg=(t,e,r,n)=>{for(var s=n>1?void 0:n?og(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let ja=class{move_effect_id=328;abr="ROT";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?e.hasType("Grass")?(e.changeBattleStats("attack",1),e.changeBattleStats("specialAttack",1),new l(void 0,`${e.name}'s Attack and Sp. Attack rose!`)):new l:new l}playEffect(t,e){return new m}};ja=lg([v(),_([{token:"Effect",useClass:ja}])],ja);var cg=Object.getOwnPropertyDescriptor,dg=(t,e,r,n)=>{for(var s=n>1?void 0:n?cg(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ga=class{move_effect_id=329;abr="CTG";duration=0;when=w.AFTER_MOVE;damages=0;turnsPassed=0;healed=!1;apply(t,e){return e?(e.changeBattleStats("defense",3),new l(void 0,`${e.name}'s Defense drastically rose!`)):new l}playEffect(t,e){return new m}};Ga=dg([v(),_([{token:"Effect",useClass:Ga}])],Ga);var hg=Object.getOwnPropertyDescriptor,ug=(t,e,r,n)=>{for(var s=n>1?void 0:n?hg(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ua=class{move_effect_id=334;abr="HRC";duration=0;when=w.AFTER_MOVE;damages=0;effectChance=30;turnsPassed=0;healed=!1;apply(t,e){if(t[0]&&Math.random()*100<this.effectChance){const r=new $e;return r.duration=Math.floor(Math.random()*4)+2,new l(r,`${t[0].name} became confused!`)}return new l}playEffect(t,e){return new m}};Ua=ug([v(),_([{token:"Effect",useClass:Ua}])],Ua);var pg=Object.getOwnPropertyDescriptor,fg=(t,e,r,n)=>{for(var s=n>1?void 0:n?pg(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s};let Ya=class{move_effect_id=341;abr="SWB";duration=-1;when=w.AFTER_SWITCH;damages=0;turnsPassed=0;healed=!1;apply(t,e){return new l(this,"A sticky web spreads out on the ground!")}playEffect(t,e){return t.hasType("Flying")?new m:(t.statsChanges.speed-=1,new m(!0,`${t.name}'s Speed was lowered by the sticky web!`))}};Ya=fg([v(),_([{token:"Effect",useClass:Ya}])],Ya);class ji{damages=0;abr="???";duration=0;move_effect_id=0;when=w.START_TURN;turnsPassed=0;healed=!1;apply(e){return new l(void 0,"Effect not implemented yet...")}playEffect(e){return new m(!0,"Effect not implemented yet...")}}var mg=Object.getOwnPropertyDescriptor,gg=(t,e,r,n)=>{for(var s=n>1?void 0:n?mg(e,r):e,a=t.length-1,i;a>=0;a--)(i=t[a])&&(s=i(s)||s);return s},wg=(t,e)=>(r,n)=>e(r,n,t);const vg=new Set([379]),_g=1;let ci=class{constructor(t){this.moveEffects=t}apply(t,e,r){return this.findEffect(t)?.apply(e,r)||new l(new ji)}findEffect(t){const e=this.moveEffects.find(r=>r.move_effect_id===t.move_effect_id);return e||(vg.has(t.move_effect_id)?this.moveEffects.find(r=>r.move_effect_id===_g):new ji)}};ci=gg([Xo(),wg(0,Ko("Effect"))],ci);var We=(t=>(t.UPKEEP="UPKEEP",t.MAIN="MAIN",t.END="END",t))(We||{}),ye=(t=>(t[t.SINGLE=0]="SINGLE",t[t.DOUBLE=1]="DOUBLE",t))(ye||{});class yg{starting=N(!1);ending=N(!1);end=N(void 0);battleEnded=!1;pokemonChange=N(void 0);playerPokemonFaint=N(void 0);opponentPokemonFaint=N(void 0);runnaway=N(!1);animateAttack=N(void 0);weatherDamage=N(void 0);hazardDamage=N(void 0);statChangeAnimation=N(null);weatherChange=N(null);levelUp=N(void 0)}class bg{win;caught;constructor(e,r){this.win=e,this.caught=r}}class Sg{superEffective=!1;notVeryEffective=!1;immune=!1;critical=!1;effectSuccess=!1;effectApplied="";damages=0;hitCount;constructor(){}}const di={normal:{normal:1,fire:1,water:1,electric:1,grass:1,ice:1,fighting:1,poison:1,ground:1,flying:1,psychic:1,bug:1,rock:.5,ghost:0,dragon:1,dark:1,steel:.5,fairy:1,color:"rgb(148, 155, 163)"},fire:{normal:1,fire:.5,water:.5,electric:1,grass:2,ice:2,fighting:1,poison:1,ground:1,flying:1,psychic:1,bug:2,rock:.5,ghost:1,dragon:.5,dark:1,steel:2,fairy:1,color:"rgb(241,163,98)"},water:{normal:1,fire:2,water:.5,electric:1,grass:.5,ice:1,fighting:1,poison:1,ground:2,flying:1,psychic:1,bug:1,rock:2,ghost:1,dragon:.5,dark:1,steel:1,fairy:1,color:"rgb(95, 144, 210)"},electric:{normal:1,fire:1,water:2,electric:.5,grass:.5,ice:1,fighting:1,poison:1,ground:0,flying:2,psychic:1,bug:1,rock:1,ghost:1,dragon:.5,dark:1,steel:1,fairy:1,color:"rgb(239, 212, 89)"},grass:{normal:1,fire:.5,water:2,electric:1,grass:.5,ice:1,fighting:1,poison:.5,ground:2,flying:.5,psychic:1,bug:.5,rock:2,ghost:1,dragon:.5,dark:1,steel:.5,fairy:1,color:"rgb(122,187,101)"},ice:{normal:1,fire:.5,water:.5,electric:1,grass:2,ice:.5,fighting:1,poison:1,ground:2,flying:2,psychic:1,bug:1,rock:1,ghost:1,dragon:2,dark:1,steel:.5,fairy:1,color:"rgb(138, 205, 193)"},fighting:{normal:2,fire:1,water:1,electric:1,grass:1,ice:2,fighting:1,poison:.5,ground:1,flying:.5,psychic:.5,bug:.5,rock:2,ghost:0,dragon:1,dark:2,steel:2,fairy:.5,color:"rgb(191, 74, 108)"},poison:{normal:1,fire:1,water:1,electric:1,grass:2,ice:1,fighting:1,poison:.5,ground:.5,flying:1,psychic:1,bug:1,rock:.5,ghost:.5,dragon:1,dark:1,steel:0,fairy:2,color:"rgb(162, 110, 196)"},ground:{normal:1,fire:2,water:1,electric:2,grass:.5,ice:1,fighting:1,poison:2,ground:1,flying:0,psychic:1,bug:.5,rock:2,ghost:1,dragon:1,dark:1,steel:2,fairy:1,color:"rgb(205, 126, 78)"},flying:{normal:1,fire:1,water:1,electric:.5,grass:2,ice:1,fighting:2,poison:1,ground:1,flying:1,psychic:1,bug:2,rock:.5,ghost:1,dragon:1,dark:1,steel:.5,fairy:1,color:"rgb(149, 170, 219)"},psychic:{normal:1,fire:1,water:1,electric:1,grass:1,ice:1,fighting:2,poison:2,ground:1,flying:1,psychic:.5,bug:1,rock:1,ghost:1,dragon:1,dark:0,steel:.5,fairy:1,color:"rgb(233, 122, 125)"},bug:{normal:1,fire:.5,water:1,electric:1,grass:2,ice:1,fighting:.5,poison:.5,ground:1,flying:.5,psychic:2,bug:1,rock:1,ghost:.5,dragon:1,dark:2,steel:.5,fairy:.5,color:"rgb(156, 193, 73)"},rock:{normal:1,fire:2,water:1,electric:1,grass:1,ice:2,fighting:.5,poison:1,ground:.5,flying:2,psychic:1,bug:2,rock:1,ghost:1,dragon:1,dark:1,steel:.5,fairy:1,color:"rgb(196, 185, 146)"},ghost:{normal:0,fire:1,water:1,electric:1,grass:1,ice:1,fighting:1,poison:1,ground:1,flying:1,psychic:2,bug:1,rock:1,ghost:2,dragon:1,dark:.5,steel:.5,fairy:1,color:"rgb(86, 105, 170)"},dragon:{normal:1,fire:1,water:1,electric:1,grass:1,ice:1,fighting:1,poison:1,ground:1,flying:1,psychic:1,bug:1,rock:1,ghost:1,dragon:2,dark:1,steel:.5,fairy:0,color:"rgb(47, 108, 190)"},dark:{normal:1,fire:1,water:1,electric:1,grass:1,ice:1,fighting:.5,poison:1,ground:1,flying:1,psychic:2,bug:1,rock:1,ghost:2,dragon:1,dark:.5,steel:.5,fairy:.5,color:"rgb(88, 83, 100)"},steel:{normal:1,fire:.5,water:.5,electric:.5,grass:1,ice:2,fighting:1,poison:1,ground:1,flying:1,psychic:1,bug:1,rock:2,ghost:1,dragon:1,dark:1,steel:.5,fairy:2,color:"rgb(102, 142, 161)"},fairy:{normal:1,fire:.5,water:1,electric:1,grass:1,ice:1,fighting:2,poison:.5,ground:1,flying:1,psychic:1,bug:1,rock:1,ghost:1,dragon:2,dark:2,steel:.5,fairy:1,color:"rgb(224, 149, 226)"}},at=ht.resolve(ci);class ge{type="scriptable";finished=!1;canceled=!1;conditionIndex=-1;selectedOption=-1}class yo extends ge{constructor(){super(),this.type="StepBack"}play(e,r){e.player.moving=!1,e.player.position.direction=e.player.position.direction==="up"?"down":e.player.position.direction==="down"?"up":e.player.position.direction==="left"?"right":"left",setTimeout(()=>{this.finished=!0,r()},300)}}let L=class{text;speaker;options;constructor(e,r,n){this.text=e,this.speaker=r||"System",this.options=n||[]}};class bo extends ge{items={};context;onEnd=()=>{};constructor(e,r=-1){super(),this.type="OpenShop",this.items=e,this.conditionIndex=r}close(){this.finished=!0,this.onEnd()}buyItem(e,r){const n=this.items[e]*r;this.context&&this.context.player.bag.money>=n&&(this.context.player.bag.addItems(parseInt(e),r,this.context.ITEMS),this.context.player.bag.money-=n)}play(e,r){this.onEnd=r,this.context=e}}class J extends ge{messages=[];current;current$=N(void 0);onEnd=()=>{};constructor(e,r=-1){super(),this.type="Dialog",this.messages=e,this.current=e[0],this.current$.set(e[0]),this.conditionIndex=r}next(){if(this.messages.indexOf(this.current)<this.messages.length-1)return this.current=this.messages[this.messages.indexOf(this.current)+1],this.current$.set(this.current),this.current;this.finished=!0,this.current$.set(void 0),this.onEnd()}selectOption(e){this.current.options?.length===0||e>this.current.options?.length||(this.selectedOption=e)}play(e,r){this.onEnd=r,this.current=this.messages[0],this.current$.set(this.messages[0])}}class So extends ge{constructor(e=-1){super(),this.type="HealAll",this.conditionIndex=e}play(e,r){e.player.monsters.forEach(n=>{n.fullHeal()}),setTimeout(()=>{this.finished=!0,r()},2e3)}}class Eg extends ge{npcId;position;constructor(e,r){super(),this.type="MoveTo",this.npcId=e,this.position=r}play(e,r){let n=!1;const s=()=>{n||(n=!0,r())},a=e.map?.npcs?.find(i=>i.id===this.npcId);a?(a.moving=!0,a.direction=a.position.positionOnMap.x>this.position.x?"left":a.position.positionOnMap.x<this.position.x?"right":a.position.positionOnMap.y>this.position.y?"up":"down",this.moveAllowed(e,this.position)?a.position.setFuturePosition(this.position.x,this.position.y,()=>{a.moving=!1,this.finished=!0,s()}):e.checkForInSightNpc(a.id)?(this.finished=!0,s(),e.playScript(a.mainScript)):this.waitUntilAllowed(e,a,s)):(this.finished=!0,s())}moveAllowed(e,r){return!e.map?.hasBoundaryAt(r)&&!e.map?.npcAt(r)&&!(e.player.position.positionOnMap.x===r.x&&e.player.position.positionOnMap.y===r.y)&&!e?.followerAt(r)}waitMvtEnds(e,r,n){const s=setInterval(()=>{r&&r.position.positionOnMap.x===r.position.targetPosition.x&&r.position.positionOnMap.y===r.position.targetPosition.y?(clearInterval(s),r.moving=!1,this.finished=!0,n()):this.waitUntilAllowed(e,r,n)},200)}waitUntilAllowed(e,r,n){const s=setInterval(()=>{this.canceled&&(clearInterval(s),n()),this.moveAllowed(e,this.position)&&r&&(clearInterval(s),r.position.targetPosition=this.position,this.waitMvtEnds(e,r,n))},200)}}class ki extends ge{itemId;qty;constructor(e,r=1){super(),this.type="GiveItem",this.itemId=e,this.qty=r}play(e,r){e.soundManager.playUISFX("menu-open"),e.player.bag.addItems(this.itemId,this.qty,e.ITEMS),setTimeout(()=>{this.finished=!0,r()},300)}}class hi extends ge{qty;constructor(e){super(),this.type="GiveMoney",this.qty=e}play(e,r){e.player.bag.money+=this.qty,this.finished=!0,r()}}class ui extends ge{npcId;constructor(e){super(),this.type="RemoveNpc",this.npcId=e}play(e,r){e.map?.npcs&&(e.map.npcs=e.map.npcs.filter(n=>n.id!==this.npcId)),this.finished=!0,r()}}class Lt extends ge{npcId;constructor(e){super(),this.type="MoveToPlayer",this.npcId=e}play(e,r){const n=e.map?.npcs?.find(a=>a.id===this.npcId),s=e.player.position.positionOnMap;if(n&&s){n.moving=!0,n.direction=n.position.positionOnMap.x>s.x?"left":n.position.positionOnMap.x<s.x?"right":n.position.positionOnMap.y>s.y?"up":"down";let a;switch(n.direction){case"up":a=new C(s.x,s.y+1);break;case"down":a=new C(s.x,s.y-1);break;case"left":a=new C(s.x+1,s.y);break;case"right":a=new C(s.x-1,s.y);break}n.position.setFuturePosition(a.x,a.y,()=>{n.moving=!1,this.finished=!0,r()})}else this.finished=!0,r()}}class Ht extends ge{npcId;battleType;constructor(e,r=ye.SINGLE){super(),this.type="StartBattle",this.npcId=e,this.battleType=r}play(e,r){const n=e.map?.npcs?.find(s=>s.id===this.npcId);n?e.startBattle(n,this.battleType,()=>{this.finished=!0,r()}):(this.finished=!0,r())}}class Eo extends ge{pokemonId;level;minIv;constructor(e,r,n=20){super(),this.type="StartWildBattle",this.pokemonId=e,this.level=r,this.minIv=n}play(e,r){const n=e.POKEDEX.findById(this.pokemonId).result;if(!n){this.finished=!0,r();return}const s=n.instanciate(this.level,this.minIv);["hp","atk","def","spa","spd","spe"].some(i=>s.ivs[i]===31)||(s.ivs.hp=31),e.startBattle(s,ye.SINGLE,()=>{this.finished=!0,r()})}}class Yt extends ge{action;constructor(e){super(),this.action=e,this.type="CustomScriptable"}play(e,r){this.action(e),this.finished=!0,r()}}class ee{triggerType;stepPosition;actions;onEnd=()=>{};currentAction;currentAction$=N(void 0);replayable=!1;played=!1;playing=!1;pauseOnPlay=!0;constructor(e,r,n,s=!1){this.triggerType=e,this.actions=r,this.stepPosition=n,this.replayable=s,this.setActionsPrototype()}setActionsPrototype(){this.actions=this.actions.map(e=>{switch(e.type){case"Dialog":return new J(e.messages,e.conditionIndex);case"OpenShop":return new bo(e.items);case"HealAll":return new So(e.conditionIndex);case"StepBack":return new yo;case"MoveTo":return new Eg(e.npcId,e.position);case"GiveItem":return new ki(e.itemId,e.qty);case"StartBattle":return new Ht(e.npcId,e.battleType);case"StartWildBattle":return new Eo(e.pokemonId,e.level,e.minIv);case"MoveToPlayer":return new Lt(e.npcId);case"CustomScriptable":return new Yt(e.action);default:return e}})}start(e,r=!0){this.playing=!0,this.pauseOnPlay=r,this.play(e,0,r)}play(e,r=0,n=!0){if(this.playing){if(e.overWorldContext.setPaused(n,"script",this),this.currentAction&&this.currentAction.selectedOption>0){this.currentAction.selectedOption=-1;const s=this.actions.findIndex((a,i)=>i>r&&a.conditionIndex===this.currentAction?.selectedOption);s!==-1?(this.currentAction=this.actions[s],this.currentAction$.set(this.currentAction)):(this.played=!0,e.overWorldContext.setPaused(!1,"script",this),this.onEnd())}else this.currentAction=this.actions[r],this.currentAction$.set(this.currentAction);this.currentAction?(this.currentAction.finished=!1,this.currentAction.canceled=!1,this.currentAction.play(e,()=>{this.play(e,r+1,n)})):this.replayable&&this.triggerType==="onEnter"?this.play(e,0,n):(this.played=!0,e.overWorldContext.setPaused(!1,"script",this),this.onEnd())}}nextAction(e){this.currentAction&&(this.currentAction.finished=!1,this.currentAction.canceled=!1,this.play(e,this.actions.indexOf(this.currentAction)+1))}interrupt(){return this.currentAction&&(this.currentAction.canceled=!0),this.playing=!1,this}resume(e){this.currentAction?.finished?(this.playing=!0,this.play(e,this.actions.indexOf(this.currentAction)+1,this.pauseOnPlay)):(this.playing=!0,this.play(e,this.actions.indexOf(this.currentAction),this.pauseOnPlay))}}function Og(t,e){const r=t%e,n=Math.floor(t/e);return new C(r,n)}function yt(t,e,r){return e*r+t}function Xa(t,e){return t.map(r=>{const n=Og(r,e);return new ai(n)})}class Oo{mapId;pickedItems=[];constructor(e,r=[]){this.mapId=e,this.pickedItems=r}}class pe{mapId;tileSize=16;background;foreground;width;height;collisions;water;battles;collisionsZones;waterZones;battleZones;collisionSet;waterSet;battleSet;monsters;levelRange=[1,100];playerInitialPosition=new C(11,11);battleTile;collisionTile;waterTile;jonctions=[];npcs=[];scripts;sound;items=[];constructor(e,r,n,s,a,i,c,o,d,h=[1,100],u=[],f,p,g,y,S,E,b,A){this.mapId=e,this.background=r,this.foreground=f,this.playerInitialPosition=d,this.width=n,this.height=s,this.battleTile=p||2239,this.collisionTile=g||4295,this.waterTile=y||40111,this.collisions=a,this.water=i,this.battles=c,this.collisionsZones=this.initBoundaries(this.collisions,n,this.collisionTile),this.waterZones=this.initBoundaries(this.water,n,this.waterTile),this.battleZones=this.initBattlesZones(this.battles,n,this.battleTile),this.collisionSet=this.buildSetFromZones(this.collisionsZones),this.waterSet=this.buildSetFromZones(this.waterZones),this.battleSet=this.buildSetFromZones(this.battleZones),this.monsters=o,this.levelRange=h,this.jonctions=u,this.npcs=S||[],this.scripts=E||[],this.sound=b,this.items=A?.map((D,x)=>(D.id=x,D))||[]}static fromScratch(e,r,n,s,a,i,c,o,d=new C,h=[1,100],u=[],f,p,g,y,S,E,b,A){return new pe(e,r,n,s,a,i,c,o,d,h,u,f,p,g,y,S,E,b,A)}static fromSparse(e,r,n,s,a,i,c=new C,o=[1,100],d=[],h,u,f,p,g){const y=new pe(e,r,n,s,[],[],[],i,c,o,d,h,void 0,void 0,void 0,u,f,p,g);return y.collisionsZones=Xa(a.collisionIndices,n),y.waterZones=Xa(a.waterIndices,n),y.battleZones=Xa(a.battleIndices,n),y.collisionSet=new Set(a.collisionIndices),y.waterSet=new Set(a.waterIndices),y.battleSet=new Set(a.battleIndices),y}static empty(){return new pe(-1,"",1,1,[],[],[],[],new C(0,0),[1,1],[],void 0,void 0,void 0,void 0,[],[],void 0,[])}static fromInstance(e,r){const n=new pe(e.mapId,e.background,e.width,e.height,e.collisions,e.water,e.battles,e.monsters,r||e.playerInitialPosition,e.levelRange,e.jonctions,e?.foreground,e?.battleTile,e?.collisionTile,e?.waterTile,e?.npcs,e?.scripts,e?.sound,e.items);return e.collisions.length===0&&(n.collisionsZones=e.collisionsZones,n.waterZones=e.waterZones,n.battleZones=e.battleZones,n.collisionSet=e.collisionSet,n.waterSet=e.waterSet,n.battleSet=e.battleSet),n}randomMonster(){const e=this.monsters[Math.floor(Math.random()*this.monsters.length)],r=Math.floor(Math.random()*(this.levelRange[1]-this.levelRange[0]+1))+this.levelRange[0];return{id:e,level:r}}initBattlesZones(e,r,n){const s=[];for(let i=0;i<e.length;i+=r)s.push(e.slice(i,r+i));const a=[];return s.forEach((i,c)=>{i.forEach((o,d)=>{if(o===n){const h=new ai(new C(d,c));a.push(h)}})}),a}initBoundaries(e,r,n){const s=[];for(let i=0;i<e.length;i+=r)s.push(e.slice(i,r+i));const a=[];return s.forEach((i,c)=>{i.forEach((o,d)=>{if(o===n){const h=new ai(new C(d,c));a.push(h)}})}),a}buildSetFromZones(e){const r=new Set;for(const n of e)r.add(yt(n.position.x,n.position.y,this.width));return r}hasBattleZoneAt(e){const r=yt(e.x,e.y,this.width);return this.battleSet.has(r)}hasCollisionAt(e){const r=yt(e.x,e.y,this.width);return this.collisionSet.has(r)}removeCollisionAt(e){this.collisionSet.delete(e);const r=this.collisions.indexOf(e);r!==-1&&this.collisions.splice(r,1)}hasBoundaryAt(e){const r=yt(e.x,e.y,this.width);return this.collisionSet.has(r)||e.x<0||e.y<0||e.x>this.width-1||e.y>this.height-1||this.npcAt(e)||this.waterSet.has(r)||this.itemAt(e)!==void 0&&this.itemAt(e)?.isBlocking()}jonctionAt(e){for(let r=0;r<this.jonctions.length;r++)for(let n=0;n<this.jonctions[r].positions.length;n++)if(this.jonctions[r].positions[n].x===e.x&&this.jonctions[r].positions[n].y===e.y)return this.jonctions[r]}npcAt(e){return this.npcs?.some(r=>r.position.positionOnMap.x===e.x&&r.position.positionOnMap.y===e.y)}itemAt(e){return this.items?.find(r=>r.position.x===e.x&&r.position.y===e.y)}elementInFront(e,r){const n=new C(e.x,e.y);switch(r){case"up":n.y-=1;break;case"down":n.y+=1;break;case"left":n.x-=1;break;case"right":n.x+=1;break}return this.elementAt(n)}elementBehindCounter(e,r){const n=new C(e.x,e.y);switch(r){case"up":n.y-=2;break;case"down":n.y+=2;break;case"left":n.x-=2;break;case"right":n.x+=2;break}const s=this.elementAt(n);if(s&&s.isBehindCounter())return s}elementAt(e){return this.npcs?.find(r=>r.position.positionOnMap.x===e.x&&r.position.positionOnMap.y===e.y)||this.itemAt(e)}}class lS{item;target;constructor(e,r){this.item=e,this.target=r}}class Ai{success;constructor(e){this.success=e}}class Mi{id;categoryId;name;description;power;constructor(e,r,n,s,a){this.id=e,this.categoryId=r,this.name=n,this.description=s,this.power=a}}class it{balls={};potions={};revives={};heldItems={};money=3e3;constructor(e){e&&(Object.keys(e.balls).forEach(r=>{const n=parseInt(r);this.balls[n]=e.balls[n]??0}),Object.keys(e.potions).forEach(r=>{const n=parseInt(r);this.potions[n]=e.potions[n]??0}),Object.keys(e.revives).forEach(r=>{const n=parseInt(r);this.revives[n]=e.revives[n]??0}),e.heldItems&&Object.keys(e.heldItems).forEach(r=>{const n=parseInt(r);this.heldItems[n]=e.heldItems[n]??0}),this.money=e.money)}addItems(e,r,n){const s=this.getPocketByItemId(e,n);s!==void 0&&(s[e]=(s[e]||0)+r)}getItem(e,r){if(this.getPocketByItemId(e,r)?.[e]!==void 0&&this.getPocketByItemId(e,r)?.[e]>0)return this.addItems(e,-1,r),r.getItem(e)?.instanciate();throw new Error("No item for this ID in the bag")}getPocketByItemId(e,r){const n=r.getItem(e)?.categoryId;if(n!==void 0)return this.getPocketByCategory(n);throw new Error("No category for this item")}getPocketByCategory(e){switch(e){case 34:return this.balls;case 27:return this.potions;case 29:return this.revives;case 40:return this.heldItems;default:throw new Error("No pocket for this category")}}use(e,r,n){const s=this.getItem(e,r);if(s!==void 0&&n!==void 0)return s.apply(n)}giveHeldItem(e,r,n){const s=n.getHeldItemById(e);if(!s)throw new Error(`Held item with ID ${e} not found`);if(r.heldItem&&this.takeHeldItem(r),!this.heldItems[e]||this.heldItems[e]<=0)throw new Error(`No ${s.name} in bag`);this.heldItems[e]--,this.heldItems[e]<=0&&delete this.heldItems[e],r.heldItem=s}addHeldItem(e,r,n){if(!n.getHeldItemById(e))throw new Error(`Held item with ID ${e} not found`);this.heldItems[e]=(this.heldItems[e]||0)+r}takeHeldItem(e){if(!e.heldItem)return;const r=e.heldItem.id;this.heldItems[r]=(this.heldItems[r]||0)+1,e.heldItem=void 0}}const Pg=JSON.parse('[{"id":1,"name":"Ethan","playable":true,"full":{"source":"src/assets/characts/final/full/ethan.png","startX":0,"startY":0,"height":76,"width":128,"frameNumber":1},"face":{"source":"src/assets/characts/final/faces/ethan.png","startX":0,"startY":0,"height":100,"width":100,"frameNumber":1},"throwing":{"source":"src/assets/characts/final/throwing/ethan.png","startX":0,"startY":0,"height":128,"width":640,"frameNumber":1},"overworld":{"walking":{"source":"src/assets/characts/final/walking/ethan.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4},"running":{"source":"src/assets/characts/final/running/ethan.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4},"biking":{"source":"src/assets/characts/final/biking/ethan.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4},"surfing":{"source":"src/assets/characts/final/surfing/ethan.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4}}},{"id":2,"name":"Lyra","playable":true,"full":{"source":"src/assets/characts/final/full/lyra.png","startX":0,"startY":0,"height":76,"width":128,"frameNumber":1},"face":{"source":"src/assets/characts/final/faces/lyra.png","startX":0,"startY":0,"height":100,"width":100,"frameNumber":1},"throwing":{"source":"src/assets/characts/final/throwing/lyra.png","startX":0,"startY":0,"height":128,"width":640,"frameNumber":1},"overworld":{"walking":{"source":"src/assets/characts/final/walking/lyra.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4},"running":{"source":"src/assets/characts/final/running/lyra.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4},"biking":{"source":"src/assets/characts/final/biking/lyra.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4},"surfing":{"source":"src/assets/characts/final/surfing/lyra.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4}}},{"id":3,"name":"Rich boy","full":{"source":"src/assets/characts/final/full/rich-boy.png","startX":0,"startY":0,"height":76,"width":128,"frameNumber":1},"face":{"source":"src/assets/characts/final/faces/rich-boy.png","startX":0,"startY":0,"height":100,"width":100,"frameNumber":1},"overworld":{"walking":{"source":"src/assets/characts/final/walking/rich-boy.png","startX":0,"startY":0,"height":64,"width":64,"frameNumber":4}}},{"id":4,"name":"Parasol lady","full":{"source":"src/assets/characts/final/full/parasol-lady.png","startX":0,"startY":0,"height":160,"width":160,"frameNumber":1},"overworld":{"walking":{"source":"src/assets/characts/final/walking/parasol-lady.png","startX":0,"startY":0,"height":48,"width":32,"frameNumber":4}}},{"id":10,"name":"Trainer 0","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-0.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":11,"name":"Trainer 1","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-1.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":12,"name":"Trainer 2","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-2.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":13,"name":"Trainer 3","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-3.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":14,"name":"Trainer 4","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-4.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":15,"name":"Trainer 5","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-5.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":16,"name":"Trainer 6","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-6.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":17,"name":"Trainer 7","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-7.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":18,"name":"Trainer 8","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-8.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":19,"name":"Trainer 9","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-9.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":20,"name":"Trainer 10","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-10.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":21,"name":"Trainer 11","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-11.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":22,"name":"Trainer 12","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-12.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":23,"name":"Trainer 13","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-13.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":24,"name":"Trainer 14","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-14.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":25,"name":"Trainer 15","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-15.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":26,"name":"Trainer 16","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-16.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":27,"name":"Trainer 17","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-17.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":28,"name":"Trainer 18","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-18.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":29,"name":"Trainer 19","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-19.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":30,"name":"Trainer 20","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-20.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":31,"name":"Trainer 21","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-21.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":32,"name":"Trainer 22","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-22.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":33,"name":"Trainer 23","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-23.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":34,"name":"Trainer 24","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-24.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":35,"name":"Trainer 25","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-25.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":36,"name":"Trainer 26","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-26.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":37,"name":"Trainer 27","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-27.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":38,"name":"Trainer 28","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-28.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":39,"name":"Trainer 29","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-29.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":40,"name":"Trainer 30","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-30.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":41,"name":"Trainer 31","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-31.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":42,"name":"Trainer 32","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-32.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":43,"name":"Trainer 33","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-33.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":44,"name":"Trainer 34","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-34.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":45,"name":"Trainer 35","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-35.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":46,"name":"Trainer 36","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-36.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":47,"name":"Trainer 37","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-37.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":48,"name":"Trainer 38","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-38.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":49,"name":"Trainer 39","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-39.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":50,"name":"Trainer 40","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-40.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":51,"name":"Trainer 41","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-41.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":52,"name":"Trainer 42","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-42.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":53,"name":"Trainer 43","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-43.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":54,"name":"Trainer 44","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-44.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":55,"name":"Trainer 45","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-45.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":56,"name":"Trainer 46","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-46.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":57,"name":"Trainer 47","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-47.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":58,"name":"Trainer 48","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-48.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":59,"name":"Trainer 49","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-49.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":60,"name":"Trainer 50","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-50.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":61,"name":"Trainer 51","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-51.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":62,"name":"Trainer 52","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-52.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":63,"name":"Trainer 53","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-53.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":64,"name":"Trainer 54","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-54.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":65,"name":"Trainer 55","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-55.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":66,"name":"Trainer 56","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-56.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":67,"name":"Trainer 57","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-57.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":68,"name":"Trainer 58","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-58.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":69,"name":"Trainer 59","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-59.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":70,"name":"Trainer 60","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-60.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":71,"name":"Trainer 61","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-61.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":72,"name":"Trainer 62","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-62.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":73,"name":"Trainer 63","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-63.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":74,"name":"Trainer 64","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-64.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":75,"name":"Trainer 65","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-65.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":76,"name":"Trainer 66","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-66.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":77,"name":"Trainer 67","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-67.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":78,"name":"Trainer 68","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-68.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":79,"name":"Trainer 69","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-69.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":80,"name":"Trainer 70","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-70.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":81,"name":"Trainer 71","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-71.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":82,"name":"Trainer 72","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-72.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":83,"name":"Trainer 73","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-73.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":84,"name":"Trainer 74","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-74.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":85,"name":"Trainer 75","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-75.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":86,"name":"Trainer 76","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-76.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":87,"name":"Trainer 77","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-77.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":88,"name":"Trainer 78","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-78.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}},{"id":89,"name":"Trainer 79","overworld":{"walking":{"source":"src/assets/characts/final/walking/trainer-79.png","startX":0,"startY":0,"height":60,"width":50,"frameNumber":3}}}]');class Re{source;height;width;frameNumber=4;constructor(e,r,n,s=4){this.source=e,this.height=r,this.width=n,this.frameNumber=s}}class kg{spritesByCharacter={};ready=!1;constructor(){Pg.forEach(e=>{this.spritesByCharacter[e.id]=new Ag(e.id,e.name,e.full?new Re(e.full.source,e.full.height,e.full.width,e.full.frameNumber):void 0,{walking:new Re(e.overworld.walking.source,e.overworld.walking.height,e.overworld.walking.width,e.overworld.walking.frameNumber),running:e.overworld.running?new Re(e.overworld.running.source,e.overworld.running.height,e.overworld.running.width,e.overworld.running.frameNumber):void 0,biking:e.overworld.biking?new Re(e.overworld.biking.source,e.overworld.biking.height,e.overworld.biking.width,e.overworld.biking.frameNumber):void 0,surfing:e.overworld.surfing?new Re(e.overworld.surfing.source,e.overworld.surfing.height,e.overworld.surfing.width,e.overworld.surfing.frameNumber):void 0},e.throwing?new Re(e.throwing.source,e.throwing.height,e.throwing.width,e.throwing.frameNumber):void 0,e.face?new Re(e.face.source,e.face.height,e.face.width,e.face.frameNumber):void 0)}),this.ready=!0}getSprite(e){return this.spritesByCharacter[e]}}class Ag{id;name;full;face;throwing;overworld;fullImg;faceImg;throwingImg;worldWalkingImg;worldRunningImg;frames={max:4,val:0,elapsed:0};orientationIndexes={down:0,left:1,right:2,up:3};constructor(e,r,n,s,a,i){this.id=e,this.name=r,this.full=n,this.face=i,this.overworld=s,this.fullImg=new Image,n&&(this.fullImg.src=n.source),i&&(this.faceImg=new Image,this.faceImg.src=i.source),a&&(this.throwing=a,this.throwingImg=new Image,this.throwingImg.src=a.source),this.worldWalkingImg=new Image,this.worldWalkingImg.src=s.walking.source,s.running?.source&&(this.worldRunningImg=new Image,this.worldRunningImg.src=s.running.source)}}const Ci=new kg;class Le{direction="down";targetDirection="down";positionOnMap={x:0,y:0};targetPosition={x:0,y:0};positionInPx={x:0,y:0};targetPositionInPx={x:0,y:0};onReachTarget;constructor(e,r,n=16,s=2.5){e&&(this.positionOnMap.x=e.x,this.targetPosition.x=e.x,this.positionInPx.x=e.x*n*s,this.targetPositionInPx.x=e.x*n*s,this.positionOnMap.y=e.y,this.targetPosition.y=e.y,this.positionInPx.y=e.y*n*s,this.targetPositionInPx.y=e.y*n*s),r&&(this.direction=r,this.targetDirection=r)}setPosition(e,r=16,n=2.5){this.positionOnMap=e,this.positionInPx=new C(e.x*r*n,e.y*r*n),this.targetPosition=e,this.targetPositionInPx=new C(e.x*r*n,e.y*r*n)}setFuturePosition(e,r,n,s=16,a=2.5){if(this.targetPosition=new C(e,r),this.targetPositionInPx=new C(e*s*a,r*s*a),this.onReachTarget=n,this.positionOnMap.x===e&&this.positionOnMap.y===r&&this.onReachTarget){const i=this.onReachTarget;this.onReachTarget=void 0,i()}}arriveAtTarget(){if(this.positionInPx.x=this.targetPositionInPx.x,this.positionInPx.y=this.targetPositionInPx.y,this.positionOnMap=this.targetPosition,this.onReachTarget){const e=this.onReachTarget;this.onReachTarget=void 0,e()}}get targetGridPosition(){return this.targetPosition}get currentGridPosition(){return this.positionOnMap}get movementDirection(){return this.direction}get isMovingToTarget(){return this.positionOnMap.x!==this.targetPosition.x||this.positionOnMap.y!==this.targetPosition.y}}class Vt{position;spriteId=0;name="Follower";gender="MALE";monsters=[];bag=new it;moving=!1;pokemon;comboJauge=new Fe;interactions=[];stepCounter=0;constructor(e,r){this.position=e,this.pokemon=r,this.interactions=[`${this.pokemon.name} is happy to be with you!`,`${this.pokemon.name} is following you!`,`${this.pokemon.name} wants to play!`]}getMasteryBonus(e){return 0}isBehindCounter(){return!1}static fromInstance(e,r){const n=new Vt(new Le(e.position.positionOnMap,e.position.direction),e.pokemon);return Object.setPrototypeOf(n.pokemon,le.prototype),n.pokemon.rehydrate(r),n}interact(e,r){if(this.stepCounter>100){const n=Object.keys(r.ITEMS.references).length,s=Math.floor(Math.random()*(n-0+1))+0,a=r.ITEMS.ids[s];if(r.ITEMS.getItem(a))return this.stepCounter=0,[new ee("onInteract",[new ki(a,1),new J([new L(`${this.pokemon.name} found a ${r.ITEMS.getItem(a)?.name}!`,"follower")])])]}return[new ee("onInteract",[new J([new L(this.interactions[Math.floor(Math.random()*this.interactions.length)],"follower")])])]}}const Mg=[{q:0,r:0,cost:0,title:"",color:"white",set:!0,first:!0,settable:!1,type:"start",value:0,group:"novice"},{q:1,r:0,cost:1,title:"catch +5%",description:"Increase your pokeballs catch rate by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"catch",value:5,group:"novice"},{q:2,r:0,cost:1,title:"catch +5%",description:"Increase your pokeballs catch rate by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"catch",value:5,group:"novice"},{q:3,r:0,cost:1,title:"CUT",description:"Cut down trees to access new areas",color:"#F4D35E",set:!1,first:!1,settable:!1,type:"cut",value:1,group:"novice"},{q:4,r:0,cost:1,title:"XP +5%",description:"Increase experience gain of yourself and your Pokemons by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"xp",value:5,group:"novice"},{q:5,r:0,cost:1,title:"XP +5%",description:"Increase experience gain of yourself and your Pokemons by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"xp",value:5,group:"novice"},{q:6,r:0,cost:1,title:"STRENGH",description:"Push boulders to access new areas",color:"#F4D35E",set:!1,first:!1,settable:!1,type:"strength",value:1,group:"novice"},{q:7,r:0,cost:1,title:"EV +1",description:"Increase your Pokemons EV gain by 1",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"ev",value:1,group:"novice"},{q:8,r:0,cost:1,title:"EV +1",description:"Increase your Pokemons EV gain by 1",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"ev",value:1,group:"novice"},{q:9,r:0,cost:1,title:"ROCK SMASH",description:"Break rocks to access new areas",color:"#F4D35E",set:!1,first:!1,settable:!1,type:"rockSmash",value:1,group:"novice"},{q:10,r:0,cost:1,title:"Combo +5%",description:"Increase the Combo jauge gain by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"comboJauge",value:5,group:"novice"},{q:11,r:0,cost:1,title:"Combo +5%",description:"Increase the Combo jauge gain by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"comboJauge",value:5,group:"novice"},{q:12,r:0,cost:1,title:"SURF",description:"Surf on water to access new areas",color:"#F4D35E",set:!1,first:!1,settable:!1,type:"surf",value:1,group:"novice"},{q:13,r:0,cost:1,title:"Shiny +5%",description:"Increase the shiny rate of Pokemons by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"shiny",value:5,group:"novice"},{q:14,r:0,cost:1,title:"Shiny +5%",description:"Increase the shiny rate of Pokemons by 5%",color:"#F7F6CF",set:!1,first:!1,settable:!1,type:"shiny",value:5,group:"novice"},{q:15,r:0,cost:1,title:"FLY",description:"Fly to access new areas",color:"#F4D35E",set:!1,first:!1,settable:!1,type:"fly",value:1,group:"novice"}],Cg=JSON.parse(`[{"q":2,"r":0,"cost":1,"title":"Stab 5%","color":"#BBF1E4","description":"Increase Stabbed damages of your Pokemons by 5%","set":false,"first":false,"settable":false,"type":"stab","value":5,"group":"expert"},{"q":3,"r":0,"cost":1,"title":"Stab 5%","description":"Increase Stabbed damages of your Pokemons by 5%","color":"#BBF1E4","set":false,"first":false,"settable":false,"type":"stab","value":5,"group":"expert"},{"q":4,"r":0,"cost":1,"title":"Stab 3%","description":"Increase Stabbed damages of your Pokemons by 3%","color":"#BBF1E4","set":false,"first":false,"settable":false,"type":"stab","value":3,"group":"expert"},{"q":5,"r":0,"cost":1,"title":"Stab 2%","description":"Increase Stabbed damages of your Pokemons by 2%","color":"#BBF1E4","set":false,"first":false,"settable":false,"type":"stab","value":2,"group":"expert"},{"q":6,"r":0,"cost":1,"title":"Acc 3%","description":"Increase Accuracy of your Pokemon moves by 3%","color":"#FDEFAB","set":false,"settable":false,"first":false,"type":"accuracy","value":3,"group":"expert"},{"q":7,"r":0,"cost":0,"title":"","color":"white","set":true,"first":true,"settable":false,"type":"start","value":0,"group":"expert"},{"q":8,"r":0,"cost":1,"title":"Acc 3%","description":"Increase Accuracy of your Pokemon moves by 3%","color":"#FDEFAB","set":false,"first":false,"settable":false,"type":"accuracy","value":3,"group":"expert"},{"q":9,"r":0,"cost":1,"title":"Non-Stab 2%","description":"Increase non-Stabbed damages of your Pokemons by 2%","color":"#BADDD6","set":false,"first":false,"settable":false,"type":"nonStab","value":2,"group":"expert"},{"q":10,"r":0,"cost":1,"title":"Non-Stab 3%","description":"Increase non-Stabbed damages of your Pokemons by 3%","color":"#BADDD6","set":false,"first":false,"settable":false,"type":"nonStab","value":3,"group":"expert"},{"q":11,"r":0,"cost":1,"title":"Non-Stab 5%","description":"Increase non-Stabbed damages of your Pokemons by 5%","color":"#BADDD6","set":false,"first":false,"settable":false,"type":"nonStab","value":5,"group":"expert"},{"q":12,"r":0,"cost":1,"title":"Non-Stab 5%","description":"Increase non-Stabbed damages of your Pokemons by 5%","color":"#BADDD6","set":false,"first":false,"settable":false,"type":"nonStab","value":5,"group":"expert"},{"q":4,"r":1,"cost":1,"title":"Res 3%","color":"#D5E5E2","description":"Increase resistance to opponent's move effects by 3%","set":false,"first":false,"settable":false,"type":"resistance","value":3,"group":"expert"},{"q":5,"r":1,"cost":1,"title":"Res 3%","description":"Increase resistance to opponent's move effects by 3%","color":"#D5E5E2","set":false,"first":false,"settable":false,"type":"resistance","value":3,"group":"expert"},{"q":6,"r":1,"cost":1,"title":"Res 3%","description":"Increase resistance to opponent's move effects by 3%","color":"#D5E5E2","set":false,"first":false,"settable":false,"type":"resistance","value":3,"group":"expert"},{"q":7,"r":1,"cost":1,"title":"Eff 3%","description":"Increase your Pokemon move side effects chances by 3%","color":"#FFFFBA","set":false,"first":false,"settable":false,"type":"effectiveness","value":3,"group":"expert"},{"q":8,"r":1,"cost":1,"title":"Eff 3%","description":"Increase your Pokemon move side effects chances by 3%","color":"#FFFFBA","set":false,"first":false,"settable":false,"type":"effectiveness","value":3,"group":"expert"},{"q":9,"r":1,"cost":1,"title":"Eff 3%","description":"Increase your Pokemon move side effects chances by 3%","color":"#FFFFBA","set":false,"first":false,"settable":false,"type":"effectiveness","value":3,"group":"expert"},{"q":5,"r":2,"cost":1,"title":"Res 5%","description":"Increase resistance to opponent's move effects by 5%","color":"#D5E5E2","set":false,"first":false,"settable":false,"type":"resistance","value":5,"group":"expert"},{"q":6,"r":2,"cost":1,"title":"Acc 5%","description":"Increase Accuracy of your Pokemon moves by 5%","color":"#FDEFAB","set":false,"first":false,"settable":false,"type":"accuracy","value":5,"group":"expert"},{"q":7,"r":2,"cost":1,"title":"Eff 5%","description":"Increase your Pokemon move side effects chances by 5%","color":"#FFFFBA","set":false,"first":false,"settable":false,"type":"effectiveness","value":5,"group":"expert"},{"q":4,"r":3,"cost":1,"title":"Crit 2%","description":"Increase your Pokemon Critical hit chances by 2%","color":"#F4D35E","set":false,"first":false,"settable":false,"type":"critical","value":2,"group":"expert"},{"q":5,"r":3,"cost":1,"title":"Crit 1%","description":"Increase your Pokemon Critical hit chances by 1%","color":"#F4D35E","set":false,"first":false,"settable":false,"type":"critical","value":1,"group":"expert"},{"q":6,"r":3,"cost":1,"title":"Crit 1%","description":"Increase your Pokemon Critical hit chances by 1%","color":"#F4D35E","set":false,"first":false,"settable":false,"type":"critical","value":1,"group":"expert"},{"q":7,"r":3,"cost":1,"title":"Crit 2%","description":"Increase your Pokemon Critical hit chances by 2%","color":"#F4D35E","set":false,"first":false,"settable":false,"type":"critical","value":2,"group":"expert"},{"q":1,"r":0,"cost":1,"title":"Weather Sun","color":"#40E0D0","set":false,"first":false,"settable":false,"type":"wSun","value":1,"group":"expert"},{"q":0,"r":1,"cost":1,"title":"Weather Sand","color":"#40E0D0","set":false,"first":false,"settable":false,"type":"wSand","value":1,"group":"expert"},{"q":1,"r":1,"cost":2,"title":"Weather turn+1","description":"Increase the duration of your weather moves by 1 turn","color":"#40E0D0","set":false,"first":false,"settable":false,"type":"wTurnAlly","value":1,"group":"expert"},{"q":2,"r":1,"cost":1,"title":"Weather Hail","color":"#40E0D0","set":false,"first":false,"settable":false,"type":"wHail","value":1,"group":"expert"},{"q":0,"r":2,"cost":1,"title":"Weather turn-1","description":"Decrease your opponent's weather moves duration by 1 turn","color":"#40E0D0","set":false,"first":false,"settable":false,"type":"wTurnOpp","value":-1,"group":"expert"},{"q":1,"r":2,"cost":1,"title":"Weather Rain","color":"#40E0D0","set":false,"first":false,"settable":false,"type":"wRain","value":1,"group":"expert"},{"q":3,"r":1,"cost":1,"title":"Heal +2%","description":"Increase healing moves and healing items effects by 2%","color":"#baffc9","set":false,"first":false,"settable":false,"type":"heal","value":2,"group":"expert"},{"q":2,"r":2,"cost":1,"title":"Heal +2%","description":"Increase healing moves and healing items effects by 2%","color":"#baffc9","set":false,"first":false,"settable":false,"type":"heal","value":2,"group":"expert"},{"q":3,"r":2,"cost":2,"title":"Heal auto","description":"Automatically heal 10% of your Pokemon's max HP at the end of each battles","color":"#baffc9","set":false,"first":false,"settable":false,"type":"autoHeal","value":1,"group":"expert"},{"q":4,"r":2,"cost":1,"title":"Heal +2%","description":"Increase healing moves and healing items effects by 2%","color":"#baffc9","set":false,"first":false,"settable":false,"type":"heal","value":2,"group":"expert"},{"q":2,"r":3,"cost":1,"title":"Heal +2%","description":"Increase healing moves and healing items effects by 2%","color":"#baffc9","set":false,"first":false,"settable":false,"type":"heal","value":2,"group":"expert"},{"q":3,"r":3,"cost":1,"title":"Heal +2%","description":"Increase healing moves and healing items effects by 2%","color":"#baffc9","set":false,"first":false,"settable":false,"type":"heal","value":2,"group":"expert"},{"q":10,"r":1,"cost":1,"title":"DOT dmg+1%","description":"Increase damages of burn and poison effects by 1%","color":"#CBAACB","set":false,"first":false,"settable":false,"type":"dotDamage","value":1,"group":"expert"},{"q":8,"r":2,"cost":1,"title":"DOT dmg+1%","description":"Increase damages of burn and poison effects by 1%","color":"#CBAACB","set":false,"first":false,"settable":false,"type":"dotDamage","value":1,"group":"expert"},{"q":9,"r":2,"cost":2,"title":"DOT ch+5%","description":"Increase chances of inflict burn and poison effects by 5%","color":"#CBAACB","set":false,"first":false,"settable":false,"type":"dotChance","value":5,"group":"expert"},{"q":10,"r":2,"cost":1,"title":"DOT dmg+1%","description":"Increase damages of burn and poison effects by 1%","color":"#CBAACB","set":false,"first":false,"settable":false,"type":"dotDamage","value":1,"group":"expert"},{"q":8,"r":3,"cost":1,"title":"DOT dmg+1%","description":"Increase damages of burn and poison effects by 1%","color":"#CBAACB","set":false,"first":false,"settable":false,"type":"dotDamage","value":1,"group":"expert"},{"q":9,"r":3,"cost":1,"title":"DOT dmg+1%","description":"Increase damages of burn and poison effects by 1%","color":"#CBAACB","set":false,"first":false,"settable":false,"type":"dotDamage","value":1,"group":"expert"},{"q":13,"r":0,"cost":1,"title":"Combo jge+2%","description":"Increase the Combo jauge gain by 2%","color":"#FF968A","set":false,"first":false,"settable":false,"type":"comboJauge","value":2,"group":"expert"},{"q":11,"r":1,"cost":1,"title":"Combo jge+2%","description":"Increase the Combo jauge gain by 2%","color":"#FF968A","set":false,"first":false,"settable":false,"type":"comboJauge","value":2,"group":"expert"},{"q":12,"r":1,"cost":2,"title":"Combo dmg+10%","description":"Increase the Combo damages by 10%","color":"#FF968A","set":false,"first":false,"settable":false,"type":"comboDamage","value":10,"group":"expert"},{"q":13,"r":1,"cost":1,"title":"Combo jge+2%","description":"Increase the Combo jauge gain by 2%","color":"#FF968A","set":false,"first":false,"settable":false,"type":"comboJauge","value":2,"group":"expert"},{"q":11,"r":2,"cost":1,"title":"Combo jge+2%","description":"Increase the Combo jauge gain by 2%","color":"#FF968A","set":false,"first":false,"settable":false,"type":"comboJauge","value":2,"group":"expert"},{"q":12,"r":2,"cost":1,"title":"Combo jge+2%","description":"Increase the Combo jauge gain by 2%","color":"#FF968A","set":false,"first":false,"settable":false,"type":"comboJauge","value":2,"group":"expert"},{"q":1,"r":3,"cost":2,"title":"Attract","description":"Increase chances of inflicting Attraction status by 5%","color":"#FBC2C2","set":false,"first":false,"settable":false,"type":"attract","value":1,"group":"expert"},{"q":10,"r":3,"cost":2,"title":"Confuse","description":"Increase chances of inflicting Confusion status by 5%","color":"#D9E5E3","set":false,"first":false,"settable":false,"type":"confuse","value":1,"group":"expert"}]`);class bt{q;r;cost;title;description;color;set;first;settable;type;value;group;constructor(e,r,n,s,a,i,c,o,d,h,u,f){this.q=e,this.r=r,this.cost=n,this.title=s,this.description=a,this.color=i,this.set=c,this.first=o,this.settable=d,this.type=h,this.value=u,this.group=f}}var U=(t=>(t.START="start",t.CATCH="catch",t.XP="xp",t.EV="ev",t.SHINY="shiny",t.CRITICAL="critical",t.STAB="stab",t.NON_STAB="nonStab",t.ACCURACY="accuracy",t.EFFECTIVENESS="effectiveness",t.RESISTANCE="resistance",t.COMBO_JAUGE="comboJauge",t.COMBO_DAMAGE="comboDamage",t.HEAL="heal",t.AUTO_HEAL="autoHeal",t.DOT_CHANCE="dotChance",t.DOT_DAMAGE="dotDamage",t.WEATHER_SUN="wSun",t.WEATHER_RAIN="wRain",t.WEATHER_SAND="wSand",t.WEATHER_HAIL="wHail",t.WEATHER_TURN_ALLY="wTurnAlly",t.WEATHER_TURN_OPPONENT="wTurnOpp",t.CONFUSE="confuse",t.ATTRACT="attract",t.CUT="cut",t.FLY="fly",t.SURF="surf",t.STRENGTH="strength",t.ROCK_SMASH="rockSmash",t))(U||{});class Gi{catch=0;xp=0;ev=0;shiny=0;critical=0;stab=0;nonStab=0;accuracy=0;effectiveness=0;resistance=0;comboJauge=0;comboDamage=0;heal=0;autoHeal=0;dotChance=0;dotDamage=0;wSun=0;wRain=0;wSand=0;wHail=0;wTurnAlly=0;wTurnOpp=0;confuse=0;attract=0;cut=0;fly=0;surf=0;strength=0;rockSmash=0;constructor(e=0,r=0,n=0,s=0,a=0,i=0,c=0,o=0,d=0,h=0,u=0,f=0,p=0,g=0,y=0,S=0,E=0,b=0,A=0,D=0,x=0,F=0,R=0,P=0,T=0,H=0,j=0,G=0,W=0){this.catch=e,this.xp=r,this.ev=n,this.shiny=s,this.critical=a,this.stab=i,this.nonStab=c,this.accuracy=o,this.effectiveness=d,this.resistance=h,this.comboJauge=u,this.comboDamage=f,this.heal=p,this.autoHeal=g,this.dotChance=y,this.dotDamage=S,this.wSun=E,this.wRain=b,this.wSand=A,this.wHail=D,this.wTurnAlly=x,this.wTurnOpp=F,this.confuse=R,this.attract=P,this.cut=T,this.fly=H,this.surf=j,this.strength=G,this.rockSmash=W}enableMastery(e,r){this[e]+=r}getMastery(e){return this[e]}}class ot{novice=[];expert=[];bonuses=new Gi;level=1;points=20;exp=0;xpToNextLevel=0;constructor(){this.novice=Mg.map(e=>new bt(e.q,e.r,e.cost,e.title,e.description||"",e.color,e.set,e.first,e.settable,e.type,e.value,e.group)),this.expert=Cg.map(e=>new bt(e.q,e.r,e.cost,e.title,e.description||"",e.color,e.set,e.first,e.settable,e.type,e.value,e.group)),this.xpToNextLevel=qe.howMuchINeed(this.level,1)*2}static fromInstance(e){const r=new ot;return e&&(r.novice=e.novice.map(n=>new bt(n.q,n.r,n.cost,n.title,n.description||"",n.color,n.set,n.first,n.settable,n.type,n.value,n.group)),r.expert=e.expert.map(n=>new bt(n.q,n.r,n.cost,n.title,n.description||"",n.color,n.set,n.first,n.settable,n.type,n.value,n.group)),r.bonuses=new Gi(e.bonuses.catch,e.bonuses.xp,e.bonuses.ev,e.bonuses.shiny,e.bonuses.critical,e.bonuses.stab,e.bonuses.nonStab,e.bonuses.accuracy,e.bonuses.effectiveness,e.bonuses.resistance,e.bonuses.comboJauge,e.bonuses.comboDamage,e.bonuses.heal,e.bonuses.autoHeal,e.bonuses.dotChance,e.bonuses.dotDamage,e.bonuses.wSun,e.bonuses.wRain,e.bonuses.wSand,e.bonuses.wHail,e.bonuses.wTurnAlly,e.bonuses.wTurnOpp,e.bonuses.confuse,e.bonuses.attract,e.bonuses.cut,e.bonuses.fly,e.bonuses.surf,e.bonuses.strength,e.bonuses.rockSmash),r.level=e.level,r.points=e.points,r.exp=e.exp,r.xpToNextLevel=e.xpToNextLevel),r}addExp(e){let r=0;this.exp+=e,this.exp>=this.xpToNextLevel&&(r=this.exp-this.xpToNextLevel,this.level++,this.levelUp(),r>0&&this.addExp(r))}levelUp(){this.points++,this.exp=0,this.xpToNextLevel=qe.howMuchINeed(this.level,1)*2}setMastery(e){this.bonuses.enableMastery(e.type,e.value);const r=e.group==="novice"?this.novice.find(n=>n.q===e.q&&n.r===e.r):this.expert.find(n=>n.q===e.q&&n.r===e.r);r&&!r.set&&this.points>=r.cost&&(r.set=!0,r.settable=!1,this.points-=r.cost)}}const Ig=""+new URL("impact-sprite-CY25xORi.png",import.meta.url).href,Tg=""+new URL("fire-sprite-0OO3ADC3.png",import.meta.url).href,Dg=""+new URL("thunder-sprite-BVfsZqRV.png",import.meta.url).href,xg=""+new URL("slash-sprite-DHM8IEpJ.png",import.meta.url).href,Rg=""+new URL("water-sprite-C5RUYYSM.png",import.meta.url).href,Fg=""+new URL("ice-sprite-4bGIfTwn.png",import.meta.url).href,Ng=""+new URL("fist-sprite-CkEdpsgr.png",import.meta.url).href,Bg=""+new URL("foot-sprite-B-1aMHMh.png",import.meta.url).href,$g=""+new URL("claws-sprite-BX1N1bHM.png",import.meta.url).href,Lg=""+new URL("crunch-sprite-DO2y4SDl.png",import.meta.url).href,Hg=""+new URL("heal-sprite-DGVPUuBV.png",import.meta.url).href,Vg=""+new URL("buff-sprite-n3E3pvCS.png",import.meta.url).href,Ui=""+new URL("debuff-sprite-D4y-AmNg.png",import.meta.url).href,Wg=""+new URL("rock-sprite-CohPN2Rc.png",import.meta.url).href,jg=""+new URL("leaf-sprite-DvusbuL6.png",import.meta.url).href,Gg=""+new URL("poison-sprite-CKZaA1nP.png",import.meta.url).href,Ug=""+new URL("wind-sprite-Cg2qw0Fk.png",import.meta.url).href,Yg=""+new URL("shadowball-sprite-C_uJKyKq.png",import.meta.url).href,Xg=""+new URL("lightball-sprite-BQDvLn79.png",import.meta.url).href,Kg=""+new URL("drain-sprite-wywly0tQ.png",import.meta.url).href,qg={impact:{path:Ig,frames:4,frameWidth:192,frameHeight:192},fire:{path:Tg,frames:8,frameWidth:192,frameHeight:192},thunder:{path:Dg,frames:6,frameWidth:192,frameHeight:192},slash:{path:xg,frames:5,frameWidth:192,frameHeight:192},water:{path:Rg,frames:6,frameWidth:192,frameHeight:192},ice:{path:Fg,frames:6,frameWidth:192,frameHeight:192},fist:{path:Ng,frames:5,frameWidth:192,frameHeight:192},foot:{path:Bg,frames:5,frameWidth:192,frameHeight:192},claws:{path:$g,frames:5,frameWidth:192,frameHeight:192},crunch:{path:Lg,frames:5,frameWidth:192,frameHeight:192},heal:{path:Hg,frames:6,frameWidth:192,frameHeight:192},buff:{path:Vg,frames:6,frameWidth:192,frameHeight:192},debuff:{path:Ui,frames:6,frameWidth:192,frameHeight:192},psychic:{path:Ui,frames:6,frameWidth:192,frameHeight:192},rock:{path:Wg,frames:5,frameWidth:192,frameHeight:192},leaf:{path:jg,frames:6,frameWidth:192,frameHeight:192},poison:{path:Gg,frames:6,frameWidth:192,frameHeight:192},wind:{path:Ug,frames:6,frameWidth:192,frameHeight:192},shadowball:{path:Yg,frames:6,frameWidth:192,frameHeight:192},lightball:{path:Xg,frames:8,frameWidth:192,frameHeight:192},drain:{path:Kg,frames:8,frameWidth:192,frameHeight:192}};function pi(t){const e=new Image;e.src=t}function Yi(t){fetch(t,{priority:"low"}).catch(()=>{})}function zg(){const t=new Set;for(const e of Object.values(qg))t.has(e.path)||(t.add(e.path),pi(e.path))}function Jg(t,e=!1){const r=t.toString().padStart(4,"0"),s=`src/assets/monsters/pmd/${r}/${e?"shiny/":""}`;if(pi(`${s}Walk-Anim.png`),Yi(`${s}AnimData.xml`),e){const a=`src/assets/monsters/pmd/${r}/`;pi(`${a}Walk-Anim.png`),Yi(`${a}AnimData.xml`)}}function Zg(){(e=>typeof requestIdleCallback<"u"?requestIdleCallback(e,{timeout:3e3}):setTimeout(e,200))(()=>{zg()})}class Fe{value=0;stored=0;constructor(e=0,r=0){this.value=e,this.stored=r}addValue(e){this.value=this.value+e,this.value>=100&&(this.stored<3?(this.stored++,this.value=this.value-100):this.value=100)}consume(){this.stored>0&&this.stored--}}class Q{spriteId;name;gender;monsters;comboJauge=new Fe;bag=new it;lvl=1;moving=!1;running=!1;sprite;position=new Le;playerMasteries=new ot;follower;constructor(e,r,n,s,a,i,c,o,d,h){this.spriteId=e,this.name=r,this.gender=n,this.monsters=s,this.bag=a,this.lvl=i,this.moving=c,this.position=new Le,this.sprite=Ci.getSprite(e),this.comboJauge=o,this.playerMasteries=ot.fromInstance(d),this.follower=h}static fromScratch(e,r,n){return new Q(e,r,n,[],new it,1,!1,new Fe)}static fromInstance(e){return new Q(e.spriteId,e.name,e.gender,e.monsters,e.bag,e.lvl,e.moving,e.comboJauge?new Fe(e.comboJauge.value,e.comboJauge.stored):new Fe,e.playerMasteries,e.follower)}setPrototypes(e){return this.monsters.forEach(r=>{Object.setPrototypeOf(r,le.prototype),r.rehydrate(e),r.volatiles=new ii}),this.bag=new it(this.bag),this.follower&&(this.follower=Vt.fromInstance(this.follower,e)),this}setMastery(e){this.playerMasteries.setMastery(e),this.playerMasteries=ot.fromInstance(this.playerMasteries)}getMasteryBonus(e){return this.playerMasteries.bonuses.getMastery(e)}setFollower(e){return this.follower=new Vt(new Le(this.behindPlayer(),this.position.direction),e),Jg(e.regionalId,e.isShiny),this.follower}followerCharge(e,r=!0){if(this.follower){const n=setInterval(()=>{if(this.follower&&!this.follower.moving){e.setPaused(!0,"followerCharge"),this.follower.moving=!0,this.follower.position.direction=this.position.direction;const s=this.aroundPlayer(this.playerSide());this.follower.position.setFuturePosition(s.x,s.y,()=>{if(this.follower){const a=this.aroundPlayer(this.position.direction);this.follower.moving=!0,this.follower.position.setFuturePosition(a.x,a.y,()=>{setTimeout(()=>{this.follower&&!this.moving?(this.follower.position.direction=this.followerOpositeDirection(),this.follower.moving=!0,this.follower.position.setFuturePosition(s.x,s.y,()=>{if(this.follower&&!this.moving){const i=this.behindPlayer();this.follower.moving=!0,this.follower.position.setFuturePosition(i.x,i.y,()=>{this.follower&&(this.follower.position.direction=this.followerOpositeDirection()),e.setPaused(!1,"followerCharge")})}else e.setPaused(!1,"followerCharge")})):e.setPaused(!1,"followerCharge")},r?2e3:800)})}else e.setPaused(!1,"followerCharge")}),clearInterval(n)}},100)}}followerOpositeDirection(){switch(this.follower?.position.direction){case"up":return"down";case"down":return"up";case"left":return"right";case"right":return"left"}return"down"}playerSide(){switch(this.position.direction){case"up":return"right";case"down":return"left";case"left":return"up";case"right":return"down"}}aroundPlayer(e){let r=this.position.positionOnMap.x,n=this.position.positionOnMap.y;switch(e){case"up":n-=1;break;case"down":n+=1;break;case"left":r-=1;break;case"right":r+=1;break}return{x:r,y:n}}behindPlayer(){let e=this.position.positionOnMap.x,r=this.position.positionOnMap.y;switch(this.position.direction){case"up":r+=1;break;case"down":r-=1;break;case"left":e+=1;break;case"right":e-=1;break}return{x:e,y:r}}reverseDirection(){switch(this.position.direction){case"up":return"down";case"down":return"up";case"left":return"right";case"right":return"left"}}}class cS{zone;box;index;selected;moving=!1;constructor(e,r,n,s){this.zone=e,this.box=n,this.index=r,this.selected=s}}class fi{name;values;constructor(e,r){this.name=e,this.values=r}firstSpot(){return this.values.indexOf(this.values.find(e=>e==null))}add(e){const r=this.firstSpot();r!==-1&&(this.values[r]=e)}move(e,r){const n=Object.assign({},this.values[e]);this.values[e]=Object.assign({},this.values[r]),this.values[r]=n}isFull(){return this.values.every(e=>e instanceof le)}}class Qg{xpShare=!0;difficulty="HARD";gameMode="CLASSIC";musicVolume=.5;sfxVolume=.5;cryVolume=.5;soundEnabled=!0;constructor(){}}var ew=(t=>(t.A="A",t.B="B",t.Up="ArrowUp",t.Down="ArrowDown",t.Left="ArrowLeft",t.Right="ArrowRight",t))(ew||{});class tw{a=N(!1);b=N(!1);up=N(!1);down=N(!1);left=N(!1);right=N(!1);_upHeld=!1;_downHeld=!1;_leftHeld=!1;_rightHeld=!1;constructor(){this.up.subscribe(e=>this._upHeld=e),this.down.subscribe(e=>this._downHeld=e),this.left.subscribe(e=>this._leftHeld=e),this.right.subscribe(e=>this._rightHeld=e)}getHeldDirection(){return this._upHeld?"up":this._downHeld?"down":this._leftHeld?"left":this._rightHeld?"right":null}pressKey(e){this.a.set(e==="A"),this.b.set(e==="B"),this.up.set(e==="ArrowUp"),this.down.set(e==="ArrowDown"),this.left.set(e==="ArrowLeft"),this.right.set(e==="ArrowRight")}unpressKey(e){switch(e){case"A":this.a.set(!1);break;case"B":this.b.set(!1);break;case"ArrowUp":this.up.set(!1);break;case"ArrowDown":this.down.set(!1);break;case"ArrowLeft":this.left.set(!1);break;case"ArrowRight":this.right.set(!1);break}}resetAll(){this.a.set(!1),this.b.set(!1),this.up.set(!1),this.down.set(!1),this.left.set(!1),this.right.set(!1)}}class dS{a;b;aButtonValue=N(!1);bButtonValue=N(!1);buttonA;buttonB;container;aKeyboardListener=e=>{e.key==="a"&&(this.a=!0,this.aButtonValue.set(!0),this.buttonA.style.backgroundColor="rgba(224, 248, 248, 0.64)")};bKeyboardListener=e=>{e.key==="b"&&(this.b=!0,this.bButtonValue.set(!0),this.buttonB.style.backgroundColor="rgba(224, 248, 248, 0.64)")};aKeyboardUpListener=e=>{e.key==="a"&&(this.a=!1,this.aButtonValue.set(!1),this.buttonA.style.backgroundColor="rgba(84, 80, 108, 0.64)")};bKeyboardUpListener=e=>{e.key==="b"&&(this.b=!1,this.bButtonValue.set(!1),this.buttonB.style.backgroundColor="rgba(84, 80, 108, 0.64)")};constructor(e){this.a=!1,this.b=!1,this.container=document.createElement("div"),this.container.style.position="fixed",this.container.style.bottom="5dvh",this.container.style.right="3dvw",this.container.style.width="110px",this.container.style.height="100px",this.container.style.display="flex",this.container.style.flexDirection="column",this.container.style.justifyContent="space-between",this.container.style.alignItems="center",this.container.style.zIndex="8";const r=document.createElement("button");r.style.fontFamily="pokemon, serif",r.style.padding="14px 20px",r.style.backgroundColor="rgba(44, 56, 69, 0.95)",r.style.border="1px solid black",r.style.borderRadius="50%",r.style.cursor="pointer",r.style.outline="none",r.style.fontSize="26px",r.style.color="white",r.style.fontWeight="bold",r.style.marginLeft="50%",r.style.boxShadow="0 0 10px 0 rgba(0, 0, 0, 0.5)",r.textContent="A",r.ontouchstart?(r.addEventListener("touchstart",()=>{this.a=!0,this.aButtonValue.set(!0),r.style.backgroundColor="rgba(224, 248, 248, 0.64)"}),r.addEventListener("touchend",()=>{this.a=!1,this.aButtonValue.set(!1),r.style.backgroundColor="rgba(44, 56, 69, 0.95)"})):(r.addEventListener("mousedown",()=>{this.a=!0,this.aButtonValue.set(!0),r.style.backgroundColor="rgba(224, 248, 248, 0.64)"}),r.addEventListener("mouseup",()=>{this.a=!1,this.aButtonValue.set(!1),r.style.backgroundColor="rgba(44, 56, 69, 0.95)"})),this.buttonA=r,this.container.appendChild(r);const n=document.createElement("button");n.style.fontFamily="pokemon, serif",n.style.padding="14px 20px",n.style.backgroundColor="rgba(44, 56, 69, 0.95)",n.style.border="1px solid black",n.style.borderRadius="50%",n.style.cursor="pointer",n.style.outline="none",n.style.fontSize="26px",n.style.color="white",n.style.fontWeight="bold",n.style.marginRight="50%",n.style.boxShadow="0 0 10px 0 rgba(0, 0, 0, 0.5)",n.textContent="B",n.ontouchstart?(n.addEventListener("touchstart",()=>{this.b=!0,this.bButtonValue.set(!0),n.style.backgroundColor="rgba(224, 248, 248, 0.64)"}),n.addEventListener("touchend",()=>{this.b=!1,this.bButtonValue.set(!1),n.style.backgroundColor="rgba(84, 80, 108, 0.64)"})):(n.addEventListener("mousedown",()=>{this.b=!0,this.bButtonValue.set(!0),n.style.backgroundColor="rgba(224, 248, 248, 0.64)"}),n.addEventListener("mouseup",()=>{this.b=!1,this.bButtonValue.set(!1),n.style.backgroundColor="rgba(84, 80, 108, 0.64)"})),this.buttonB=n,this.container.appendChild(n),e.innerHTML="",e.appendChild(this.container),document.addEventListener("keydown",this.aKeyboardListener),document.addEventListener("keydown",this.bKeyboardListener),document.addEventListener("keyup",this.aKeyboardUpListener),document.addEventListener("keyup",this.bKeyboardUpListener)}destroy(){this.container.remove(),document.removeEventListener("keydown",this.aKeyboardListener),document.removeEventListener("keydown",this.bKeyboardListener),document.removeEventListener("keyup",this.aKeyboardUpListener),document.removeEventListener("keyup",this.bKeyboardUpListener)}}class rw{frameId=0;then=Date.now();fpsInterval=1e3/40;debug=!1;imageScale=2.5;playerScale=1;followerScale=1.5}class sw{menuOpened=!1;menuOpened$=N(!1);pokemonListOpened=!1;pokemonListOpened$=N(!1);switchOpened=!1;switchOpened$=N(!1);bagOpened=!1;bagOpened$=N(!1);openSummary=!1;openSummary$=N(!1);summaryIndex=0;boxOpened=!1;boxOpened$=N(!1);pokedexOpened=!1;pokedexOpened$=N(!1);trainerOpened=!1;trainerOpened$=N(!1);mapOpened=!1;mapOpened$=N(!1)}var q=(t=>(t[t.MAIN=0]="MAIN",t[t.POKEMON_LIST=1]="POKEMON_LIST",t[t.SWITCH=2]="SWITCH",t[t.BAG=3]="BAG",t[t.SUMMARY=4]="SUMMARY",t[t.BOX=5]="BOX",t[t.POKEDEX=6]="POKEDEX",t[t.TRAINER=7]="TRAINER",t[t.MAP=8]="MAP",t))(q||{}),et=(t=>(t[t.WAKE_UP=0]="WAKE_UP",t[t.STARTER_SELECTION=1]="STARTER_SELECTION",t[t.PROLOGUE=2]="PROLOGUE",t))(et||{});class nw{wakeUp=!1;starterSelection=!1;prologue=!1}class aw{frames;menus;scenes;keys=new tw;changingMap=!1;isPaused=!1;portalAnimating=!1;map;setPaused(e,r,n){this.isPaused=e}getPaused(){return this.isPaused}startScene(e){this.isPaused=!0,this.scenes.wakeUp=e===0,this.scenes.starterSelection=e===1,this.scenes.prologue=e===2}endScene(e){switch(this.isPaused=!1,e){case 0:this.scenes.wakeUp=!1;break;case 1:this.scenes.starterSelection=!1;break;case 2:this.scenes.prologue=!1;break}}toggleMenu(e){switch(e){case 0:this.isPaused=!this.isPaused,this.menus.menuOpened=!this.menus.menuOpened,this.menus.menuOpened$.set(this.menus.menuOpened);break;case 1:this.isPaused=!this.isPaused,this.menus.pokemonListOpened=!this.menus.pokemonListOpened,this.menus.pokemonListOpened$.set(this.menus.pokemonListOpened);break;case 2:this.isPaused=!this.isPaused,this.menus.switchOpened=!this.menus.switchOpened,this.menus.switchOpened$.set(this.menus.switchOpened);break;case 3:this.isPaused=!this.isPaused,this.menus.bagOpened=!this.menus.bagOpened,this.menus.bagOpened$.set(this.menus.bagOpened);break;case 4:this.isPaused=!this.isPaused,this.menus.openSummary=!this.menus.openSummary,this.menus.openSummary$.set(this.menus.openSummary);break;case 5:this.isPaused=!this.isPaused,this.menus.boxOpened=!this.menus.boxOpened,this.menus.boxOpened$.set(this.menus.boxOpened);break;case 6:this.isPaused=!this.isPaused,this.menus.pokedexOpened=!this.menus.pokedexOpened,this.menus.pokedexOpened$.set(this.menus.pokedexOpened);break;case 7:this.isPaused=!this.isPaused,this.menus.trainerOpened=!this.menus.trainerOpened,this.menus.trainerOpened$.set(this.menus.trainerOpened);break;case 8:this.menus.mapOpened=!this.menus.mapOpened,this.menus.mapOpened$.set(this.menus.mapOpened);break}}openMenu(e){switch(e){case 0:this.isPaused=!0,this.menus.menuOpened=!0,this.menus.menuOpened$.set(!0);break;case 1:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.pokemonListOpened=!0,this.menus.pokemonListOpened$.set(!0);break;case 2:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.switchOpened=!0,this.menus.switchOpened$.set(!0);break;case 3:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.bagOpened=!0,this.menus.bagOpened$.set(!0);break;case 4:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.openSummary=!0,this.menus.openSummary$.set(!0);break;case 5:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.boxOpened=!0,this.menus.boxOpened$.set(!0);break;case 6:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.pokedexOpened=!0,this.menus.pokedexOpened$.set(!0);break;case 7:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.trainerOpened=!0,this.menus.trainerOpened$.set(!0);break;case 8:this.isPaused=!0,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1),this.menus.mapOpened=!0,this.menus.mapOpened$.set(!0);break}}closeMenu(e){switch(e){case 0:this.isPaused=!1,this.menus.menuOpened=!1,this.menus.menuOpened$.set(!1);break;case 1:this.isPaused=!1,this.menus.pokemonListOpened=!1,this.menus.pokemonListOpened$.set(!1);break;case 2:this.isPaused=!1,this.menus.switchOpened=!1,this.menus.switchOpened$.set(!1);break;case 3:this.isPaused=!1,this.menus.bagOpened=!1,this.menus.bagOpened$.set(!1);break;case 4:this.isPaused=!1,this.menus.openSummary=!1,this.menus.openSummary$.set(!1);break;case 5:this.isPaused=!1,this.menus.boxOpened=!1,this.menus.boxOpened$.set(!1);break;case 6:this.isPaused=!1,this.menus.pokedexOpened=!1,this.menus.pokedexOpened$.set(!1);break;case 7:this.isPaused=!1,this.menus.trainerOpened=!1,this.menus.trainerOpened$.set(!1);break;case 8:this.isPaused=!1,this.menus.mapOpened=!1,this.menus.mapOpened$.set(!1);break}}constructor(e){this.frames=new rw,this.menus=new sw,this.scenes=new nw,this.map=e}}class iw{stack=[];current;push(e){this.stack.push(e)}pop(){return this.current=this.stack.pop(),this.current}clear(){this.stack=[]}isEmpty(){return this.stack.length===0}}class ce{id;spriteId;spriteSheet;name;gender;monsterIds;dungeonTeam;monsters;comboJauge=new Fe;bag;moving=!1;alerted=!1;alertedAt=0;direction="down";behindCounter=!1;mainScript;dialogScripts;movingScript;position;constructor(e,r,n,s,a,i,c,o,d,h,u,f=!1){this.id=e,this.name=r,this.spriteId=n,this.spriteSheet=Ci.getSprite(n),this.position=new Le(s,a),this.gender=i,this.monsterIds=c||[],this.monsters=[],this.bag=o||new it,this.mainScript=d?new ee(d?.triggerType,d?.actions,d?.stepPosition,d?.replayable):void 0,this.dialogScripts=h?.map(p=>new ee(p.triggerType,p.actions,p.stepPosition,p.replayable))||[],this.movingScript=u?new ee(u?.triggerType,u?.actions,u?.stepPosition,u?.replayable):void 0,this.behindCounter=f}isBehindCounter(){return this.behindCounter}getMasteryBonus(e){return 0}interact(e,r){const n=this.movingScript?.interrupt();let s;if(this.position.positionOnMap.x>e.x?this.direction="left":this.position.positionOnMap.x<e.x?this.direction="right":this.position.positionOnMap.y>e.y?this.direction="up":this.position.positionOnMap.y<e.y&&(this.direction="down"),this.mainScript&&(!this.mainScript?.played||this.mainScript?.replayable))s=this.mainScript;else if(this.dialogScripts){const a=Math.floor(Math.random()*this.dialogScripts.length);s=this.dialogScripts[a]}return[s,n]}}var $=(t=>(t.ATTACK="Attack",t.SWITCH="Switch-Order",t.ITEM="Item",t.RUN="Run",t.MESSAGE="Message",t.SWITCH_EFFECT="Switch-Effect",t.APPLY_EFFECT="Apply-Effect",t.REMOVE_HP="Remove-HP",t.COMBO_BOOST="Combo-Boost",t.XP_WIN="XP-Win",t.LEVEL_UP="Level-Up",t.PLAY_ANIMATION="Play-Animation",t.SLEEP="Sleep",t.STAT_CHANGE="Stat-Change",t.WEATHER_CHANGE="Weather-Change",t.END_CHECKS="End-Checks",t.END_BATTLE="End-Battle",t))($||{});const Xi={fire:2,flying:2,bug:2,ice:2,fighting:.5,ground:.5,steel:.5};function ow(t){let e=1;for(const r of t){const n=r.toLowerCase();n in Xi&&(e*=Xi[n])}return e}function lw(t,e){const n=8/ow(e),s=Math.floor(t/n);return Math.max(1,s)}function cw(t,e){return e<=0?0:Math.floor(e===1?t/8:e===2?t/6:t/4)}function dw(t){return t<=0?"none":t===1?"poison":"toxic"}function hw(t){return!t.some(e=>e.toLowerCase()==="flying")}const uw=["rock","ground","steel"],pw=["ice"];function fw(t,e,r){const n=t.weather,s=e.toLowerCase(),a=r?.toLowerCase();if((n===k.RAIN||n===k.SAND||n===k.HAIL)&&(a==="solar beam"||a==="solar-beam"||a==="solar blade"||a==="solar-blade"))return .5;if(n===k.RAIN){if(s==="water")return 1.5;if(s==="fire")return .5}else if(n===k.SUN){if(s==="fire")return 1.5;if(s==="water")return .5}return 1}function mw(t,e){const r=t.weather,n=e.map(s=>s.toLowerCase());return r===k.SAND&&n.includes("rock")?1.5:1}function gw(t,e,r,n){const s=t.weather,a=r.map(c=>c.toLowerCase()),i=n?.toLowerCase().trim().replace(/\s+/g,"-");if(i==="magic-guard"||i==="overcoat")return 0;if(s===k.SAND){if(i==="sand-veil"||i==="sand-force"||i==="sand-rush")return 0;if(!a.some(o=>uw.includes(o)))return Math.floor(e/16)}else if(s===k.HAIL){if(i==="ice-body"||i==="snow-cloak")return 0;if(!a.some(o=>pw.includes(o)))return Math.floor(e/16)}return 0}function ww(t,e,r){const n=t.weather,s=e.toLowerCase();if(n===k.RAIN){if(s==="thunder"||s==="hurricane")return 100}else if(n===k.SUN){if(s==="thunder"||s==="hurricane")return 50}else if(n===k.HAIL&&s==="blizzard")return 100;return null}function vw(t){switch(t){case k.SUN:return"fire";case k.RAIN:return"water";case k.SAND:return"rock";case k.HAIL:return"ice";default:return"normal"}}function _w(t){return t!==k.NONE?100:50}function Ce(t,e,r=5,n){let s=r;n&&typeof n.hasItem=="function"&&(e===k.RAIN&&n.hasItem("Damp Rock")||e===k.SUN&&n.hasItem("Heat Rock")||e===k.SAND&&n.hasItem("Smooth Rock")||e===k.HAIL&&n.hasItem("Icy Rock"))&&(s=8),t.setWeather(e,s)}var V=(t=>(t.ON_SWITCH_IN="ON_SWITCH_IN",t.ON_SWITCH_OUT="ON_SWITCH_OUT",t.ON_BEFORE_MOVE="ON_BEFORE_MOVE",t.ON_AFTER_MOVE="ON_AFTER_MOVE",t.ON_DAMAGE_CALC="ON_DAMAGE_CALC",t.ON_CONTACT="ON_CONTACT",t.ON_TRY_HIT="ON_TRY_HIT",t.ON_TURN_END="ON_TURN_END",t.ON_TURN_START="ON_TURN_START",t.ON_FAINT="ON_FAINT",t.ON_STATUS="ON_STATUS",t.ON_STAT_CHANGE="ON_STAT_CHANGE",t.ON_MODIFY_ATK="ON_MODIFY_ATK",t.ON_MODIFY_DEF="ON_MODIFY_DEF",t.ON_MODIFY_SPA="ON_MODIFY_SPA",t.ON_MODIFY_SPD="ON_MODIFY_SPD",t.ON_MODIFY_SPE="ON_MODIFY_SPE",t.ON_MODIFY_DAMAGE="ON_MODIFY_DAMAGE",t.ON_SOURCE_MODIFY_DAMAGE="ON_SOURCE_MODIFY_DAMAGE",t))(V||{}),X=(t=>(t.ON_SWITCH_IN="ON_SWITCH_IN",t.ON_MODIFY_ATK="ON_MODIFY_ATK",t.ON_MODIFY_DEF="ON_MODIFY_DEF",t.ON_MODIFY_SPA="ON_MODIFY_SPA",t.ON_MODIFY_SPD="ON_MODIFY_SPD",t.ON_MODIFY_SPEED="ON_MODIFY_SPEED",t.ON_MODIFY_DAMAGE="ON_MODIFY_DAMAGE",t.ON_MODIFY_MOVE_POWER="ON_MODIFY_MOVE_POWER",t.ON_BEFORE_HIT="ON_BEFORE_HIT",t.ON_AFTER_HIT="ON_AFTER_HIT",t.ON_TURN_END="ON_TURN_END",t.ON_STATUS_INFLICTED="ON_STATUS_INFLICTED",t.ON_HP_CHANGED="ON_HP_CHANGED",t.ON_MOVE_SELECTED="ON_MOVE_SELECTED",t))(X||{});class I{type;description;initiator;constructor(e,r){this.type=$.MESSAGE,this.description=e,this.initiator=r}execute(e){e.currentMessage.set(this.description)}}class yw{type;description;initiator;duration;constructor(e,r){this.type=$.SLEEP,this.description=`Sleep ${e}ms`,this.duration=e,this.initiator=r??{}}async execute(e){await e.sleep(this.duration)}}class bw{type;description;initiator;target;owner;constructor(e,r,n){this.type=$.SWITCH_EFFECT,this.description="Change the current pokemon",this.initiator=e,this.target=r,this.owner=n}execute(e){let r,n=0,s="ally";this.owner instanceof Q?(s="ally",n=e.playerSide.findIndex(a=>a===this.initiator),r=e.playerSide[n],e.playerSide[n]=this.target,e.participants.add(this.target)):(s="opponent",n=e.oppSide.findIndex(a=>a===this.initiator),r=e.oppSide[n],e.oppSide[n]=this.target),r&&e.events.pokemonChange.set({side:s,idx:n}),this.applyEntryHazards(e,this.target,s),this.target.choiceLockedMove=void 0,e.runAbilityEvent(V.ON_SWITCH_IN,this.target),e.runItemEvent(X.ON_SWITCH_IN,this.target)}applyEntryHazards(e,r,n){const s=n==="ally"?"ally":"enemy",a=e.battleField,i=r.types,c=hw(i),o=i.some(h=>h.toLowerCase()==="poison");if(a.getHazardLayers(s,ue.STEALTH_ROCK)>0){const h=lw(r.stats.hp,i);r.removeHp(h),e.events.hazardDamage.set({pokemon:r,hazard:"stealth-rock"}),e.addToStack(new I(`${r.name} was hurt by Stealth Rock!`,r)),e.checkFainted(r,r).forEach(f=>e.addToStack(f))}if(c){const h=a.getHazardLayers(s,ue.SPIKES);if(h>0&&!r.fainted){const u=cw(r.stats.hp,h);r.removeHp(u),e.events.hazardDamage.set({pokemon:r,hazard:"spikes"}),e.addToStack(new I(`${r.name} was hurt by Spikes!`,r)),e.checkFainted(r,r).forEach(p=>e.addToStack(p))}}if(c&&!r.fainted){const h=a.getHazardLayers(s,ue.TOXIC_SPIKES);if(h>0){if(o)a.removeHazard(s,ue.TOXIC_SPIKES),e.addToStack(new I(`${r.name} absorbed the Toxic Spikes!`,r));else if(!r.status){const u=dw(h);if(u==="poison"){const f=Math.floor(r.stats.hp/16);r.status={move_effect_id:3,abr:"PSN",duration:-1,when:w.END_TURN,damages:f,turnsPassed:0,healed:!1,apply:()=>({message:`${r.name} is poisoned`}),playEffect:p=>(p.removeHp(f),{canPlay:!0,message:`${p.name} is hurt by poison`})},e.addToStack(new I(`${r.name} was poisoned!`,r))}else if(u==="toxic"){const f=Math.floor(r.stats.hp/16);let p=0;r.status={move_effect_id:34,abr:"PSN+",duration:-1,when:w.END_TURN,damages:f,turnsPassed:0,healed:!1,apply:()=>({message:`${r.name} was badly poisoned!`}),playEffect:g=>{p++;const y=Math.floor(f*p);return g.removeHp(y),{canPlay:!0,message:`${g.name} is hurt by poison!`}}},e.addToStack(new I(`${r.name} was badly poisoned!`,r))}}}}}}class Ze{type;description;moveEffect;target;initiator;constructor(e,r,n){this.type=$.APPLY_EFFECT,this.description="Apply Effect",this.moveEffect=e,this.target=r,this.initiator=n}execute(e){if(!this.target.fainted&&this.moveEffect){const r=at.findEffect(this.moveEffect);if(!r)return;const s={116:k.SAND,137:k.RAIN,138:k.SUN,165:k.HAIL}[r.move_effect_id];if(s!==void 0){let o=5;if(e.playerSide.includes(this.initiator)){o+=e.player.getMasteryBonus(U.WEATHER_TURN_ALLY);const f={[k.SUN]:U.WEATHER_SUN,[k.RAIN]:U.WEATHER_RAIN,[k.SAND]:U.WEATHER_SAND,[k.HAIL]:U.WEATHER_HAIL,[k.STRONG_WINDS]:null,[k.NONE]:null}[s];f&&(o+=e.player.getMasteryBonus(f))}else o+=e.player.getMasteryBonus(U.WEATHER_TURN_OPPONENT);Ce(e.battleField,s,Math.max(1,o),this.initiator),e.weatherVersion.update(u=>u+1);const h={[k.SAND]:"A sandstorm kicked up!",[k.RAIN]:"It started to rain!",[k.SUN]:"The sunlight turned harsh!",[k.HAIL]:"It started to hail!",[k.STRONG_WINDS]:"A mysterious air current is protecting Flying-type Pokemon!",[k.NONE]:""};e.addToStack(new I(h[s],this.initiator));return}const i={267:ue.STEALTH_ROCK,113:ue.SPIKES,250:ue.TOXIC_SPIKES,341:ue.STICKY_WEB}[r.move_effect_id];if(i!==void 0){const d=e.getPokemonSide(this.initiator)==="ally"?"enemy":"ally";e.battleField.addHazard(d,i),e.hazardsVersion.update(u=>u+1);const h={[ue.STEALTH_ROCK]:"Pointed stones float in the air!",[ue.SPIKES]:"Spikes were scattered on the ground!",[ue.TOXIC_SPIKES]:"Poison spikes were scattered!",[ue.STICKY_WEB]:"A sticky web spreads out on the ground!"};e.addToStack(new I(h[i],this.initiator));return}const c=at.apply(this.moveEffect,[this.target],this.initiator);c?.effect&&(this.target.status=c.effect,e.runItemEvent(X.ON_STATUS_INFLICTED,this.target)),c?.message&&e.addToStack(new I(c.message,this.initiator))}}}class Ka{type;description;move;target;initiator;hitCount;needsCompletionSignal=!0;constructor(e,r,n,s){this.type=$.PLAY_ANIMATION,this.description="Play Animation",this.move=e,this.target=r,this.initiator=n,this.hitCount=s}execute(e){e.events.animateAttack.set({move:this.move,target:this.target,initiator:this.initiator,hitCount:this.hitCount})}}class Sw{type;description;initiator;target;stat;stages;needsCompletionSignal=!0;constructor(e,r,n,s){this.type=$.STAT_CHANGE,this.description="Stat Change Animation",this.target=e,this.stat=r,this.stages=n,this.initiator=s}execute(e){e.events.statChangeAnimation.set({target:this.target,stat:this.stat,stages:this.stages})}}class Ie{type;description;initiator;weather;needsCompletionSignal=!0;constructor(e,r){this.type=$.WEATHER_CHANGE,this.description="Weather Change",this.weather=e,this.initiator=r}execute(e){let r=5;if(e.playerSide.includes(this.initiator)){r+=e.player.getMasteryBonus(U.WEATHER_TURN_ALLY);const a={[k.SUN]:U.WEATHER_SUN,[k.RAIN]:U.WEATHER_RAIN,[k.SAND]:U.WEATHER_SAND,[k.HAIL]:U.WEATHER_HAIL,[k.STRONG_WINDS]:null,[k.NONE]:null}[this.weather];a&&(r+=e.player.getMasteryBonus(a))}else r+=e.player.getMasteryBonus(U.WEATHER_TURN_OPPONENT);Ce(e.battleField,this.weather,Math.max(1,r),this.initiator),e.weatherVersion.update(s=>s+1),e.events.weatherChange.set({weather:this.weather,pokemon:this.initiator})}}class Ki{type;description;damages;target;initiator;constructor(e,r,n){this.type=$.REMOVE_HP,this.description="Remove HP",this.damages=e,this.target=r,this.initiator=n}execute(e){this.target.currentHp=Math.max(0,this.target.currentHp-this.damages),isNaN(this.target.currentHp)&&(this.target.currentHp=0),e.runItemEvent(X.ON_HP_CHANGED,this.target),this.target.currentHp<=0&&e.addToStack(new yw(400));const r=e.checkFainted(this.target,this.initiator);r&&r.forEach(n=>{e.addToStack(n)})}}class Ew{type;description;initiator;controller;superEffective;critical;constructor(e,r,n,s){this.type=$.COMBO_BOOST,this.description="Combo Boost",this.initiator=e,this.controller=r,this.superEffective=n,this.critical=s}execute(e){if(!(this.controller instanceof le)&&this.controller.comboJauge){let r=5;this.superEffective&&(r+=5),this.critical&&(r+=5),r+=this.controller.getMasteryBonus(U.COMBO_JAUGE),this.controller.comboJauge.addValue(r),this.controller.comboJauge=new Fe(this.controller.comboJauge.value,this.controller.comboJauge.stored)}}}class mi{type;description;initiator;xp;evBonus;constructor(e,r,n=0){this.type=$.XP_WIN,this.description=`${e.name} won ${r} XP!`,this.initiator=e,this.xp=r,this.evBonus=n}execute(e){const r=(e.opponent instanceof Q?3:1)+this.evBonus,n=this.initiator.addXpResult(this.xp,r);n.newMove?.length>0&&n.newMove.forEach(s=>{e.addToStack(new I(`${this.initiator.name} can now learn ${s}!`,this.initiator))}),n.levelup&&e.addToStack(new Ow(this.initiator,n.xpLeft))}}class Ow{type;description;initiator;xpLeft;constructor(e,r=0){this.type=$.LEVEL_UP,this.description=`${e.name} grew to level ${e.level+1}!`,this.initiator=e,this.xpLeft=r}execute(e){this.xpLeft>0&&e.addToStack(new mi(this.initiator,this.xpLeft)),e.addToStack(new I(this.description,this.initiator));const r=this.initiator.levelUp();e.leveledUpMonsterIds.add(this.initiator.id),e.events.levelUp.set({pokemon:this.initiator,...r}),r?.moves&&r.moves.length>0&&r.moves.forEach(n=>{e.addToStack(new I(`${this.initiator.name} learned ${n.name}!`,this.initiator))})}}const Pw={[k.NONE]:"",[k.RAIN]:"Rain",[k.SUN]:"Harsh Sunlight",[k.SAND]:"Sandstorm",[k.HAIL]:"Hail",[k.STRONG_WINDS]:"Strong Winds"};class kw{type;description;initiator;constructor(e){this.type=$.END_CHECKS,this.description="Weather Damage",this.initiator=e}execute(e){const r=e.battleField.weather;if(r===k.NONE)return;e.weatherVersion.update(a=>a+1);const n=[...e.playerSide,...e.oppSide].filter(a=>!!a&&!a.fainted);if(r===k.SAND||r===k.HAIL){e.events.weatherDamage.set(r);for(const a of n){const i=gw(e.battleField,a.currentStats.hp,a.types,a.currentAbility);i>0&&(a.currentHp=Math.max(0,a.currentHp-i),e.checkFainted(a,a).forEach(o=>e.addToStack(o)))}}e.addToStack(new I(`The ${Pw[r]} rages.`,this.initiator))}}class qi{type;description;initiator;constructor(e){this.type=$.END_CHECKS,this.description="End Turn Checks",this.initiator=e}execute(e){e.runAbilityEvent(V.ON_TURN_END,this.initiator),e.runItemEvent(X.ON_TURN_END,this.initiator);let r=[];if(!this.initiator.fainted&&this.initiator.status&&this.initiator.status.when==="end-turn"){const n=this.initiator.status.playEffect(this.initiator);if((this.initiator.status.abr==="PSN"||this.initiator.status.abr==="PSN+"||this.initiator.status.abr==="BRN")&&e.oppSide.includes(this.initiator)){const a=e.player.getMasteryBonus(U.DOT_DAMAGE);if(a>0&&this.initiator.status.damages>0){const i=Math.floor(this.initiator.status.damages*a/100);i>0&&(this.initiator.currentHp=Math.max(0,this.initiator.currentHp-i))}}r=e.checkFainted(this.initiator,this.initiator),n?.message&&r.push(new I(n.message,this.initiator))}if(e.isWild&&e.opponent instanceof le&&e.opponent.fainted||e.opponent instanceof ce&&e.opponent.monsters.every(n=>n.fainted))e.actionStack.stack=e.actionStack.stack.filter(n=>!(n.type===$.MESSAGE&&n?.description.startsWith("What should"))),e.battleResult.win=!0,e.addToStack(new Wt(this.initiator)),e.addToStack(new I("You won the battle!",this.initiator));else if(e.player.monsters.every(n=>n.fainted))e.battleResult.win=!1,e.addToStack(new Wt(this.initiator)),e.addToStack(new I("You lost the battle...",this.initiator));else if(e.oppSide.find(n=>n?.fainted)&&e.opponent instanceof ce){const n=e.oppSide.findIndex(s=>s?.fainted);if(e.settings?.difficulty==="NORMAL"){const s=e.opponent.monsters.filter(a=>!a.fainted).filter(a=>!e.oppSide.includes(a));s.length===0?e.oppSide[n]=void 0:(e.oppSide[n]=s[Math.floor(Math.random()*s.length)],e.addToStack(new I(`${e.opponent.name} sent out ${e.oppSide[n]?.name}!`,e.oppSide[n])),e.events.pokemonChange.set({side:"opponent",idx:n}))}else{const s=e.opponent.monsters.filter(i=>!i.fainted).filter(i=>!e.oppSide.includes(i)),a=e.findBestPokemon(e.opponent.monsters,e.playerSide?.find(i=>!!i&&!i.fainted));a?(e.oppSide[n]=a,e.addToStack(new I(`${e.opponent.name} sent out ${e.oppSide[n]?.name}!`,e.oppSide[n])),e.events.pokemonChange.set({side:"opponent",idx:n})):s&&s.length>0?(e.oppSide[n]=s[Math.floor(Math.random()*s.length)],e.addToStack(new I(`${e.opponent.name} sent out ${e.oppSide[n]?.name}!`,e.oppSide[n])),e.events.pokemonChange.set({side:"opponent",idx:n})):e.oppSide[n]=void 0}}else e.playerSide.find(n=>n?.fainted)&&e.events.playerPokemonFaint.set(e.playerSide.find(n=>n?.fainted));r&&r.forEach(n=>{e.addToStack(n)})}}class Wt{type;description;initiator;constructor(e){this.type=$.END_BATTLE,this.description="End Battle",this.initiator=e}execute(e){e.player.monsters?.forEach(n=>{n.resetBattleStats()}),e?.opponent instanceof ce&&e.opponent.monsters.forEach(n=>{n.resetBattleStats()}),(e.player instanceof Q?e.player.getMasteryBonus(U.AUTO_HEAL):0)>0&&e.player.monsters?.forEach(n=>{if(!n.fainted){const s=Math.floor(n.currentStats.hp*.1);s>0&&n.heal(s)}}),e.clearStack(),e.events.end.set(e.battleResult),e.events.battleEnded=!0}}const Aw=[{id:1,categoryId:34,name:"master-ball",description:"Catches a wild Pokémon every time.",power:100},{id:2,categoryId:34,name:"ultra-ball",description:"Tries to catch a wild Pokémon.  Success rate is 2×.",power:2},{id:3,categoryId:34,name:"great-ball",description:"Tries to catch a wild Pokémon.  Success rate is 1.5×.",power:1.5},{id:4,name:"poke-ball",categoryId:34,description:"Tries to catch a wild Pokémon.",power:1},{id:17,categoryId:27,name:"potion",description:"Restores 20 HP.",power:20},{id:23,categoryId:27,name:"full-restore",description:"Restores HP to full and cures any status ailment and confusion.",power:-1},{id:24,categoryId:27,name:"max-potion",description:"Restores HP to full.",power:-1},{id:25,categoryId:27,name:"hyper-potion",description:"Restores 200 HP.",power:200},{id:26,categoryId:27,name:"super-potion",description:"Restores 50 HP.",power:50},{id:30,categoryId:27,name:"fresh-water",description:"Restores 50 HP.",power:50},{id:31,categoryId:27,name:"soda-pop",description:"Restores 60 HP.",power:60},{id:32,categoryId:27,name:"lemonade",description:"Restores 80 HP.",power:80},{id:33,categoryId:27,name:"moomoo-milk",description:"Restores 100 HP.",power:100},{id:28,categoryId:29,name:"revive",description:"Revives with half HP.",power:50},{id:29,categoryId:29,name:"max-revive",description:"Revives with full HP.",power:100}],Mw=[{id:4001,categoryId:40,name:"Choice Band",description:"Boosts Attack by 50% but locks the holder into one move.",power:1.5,consumable:!1},{id:4002,categoryId:40,name:"Choice Specs",description:"Boosts Sp. Atk by 50% but locks the holder into one move.",power:1.5,consumable:!1},{id:4003,categoryId:40,name:"Choice Scarf",description:"Boosts Speed by 50% but locks the holder into one move.",power:1.5,consumable:!1},{id:4004,categoryId:40,name:"Life Orb",description:"Boosts move power by 30% but costs 10% HP per attack.",power:1.3,consumable:!1},{id:4005,categoryId:40,name:"Expert Belt",description:"Boosts super-effective moves by 20%.",power:1.2,consumable:!1},{id:4006,categoryId:40,name:"Leftovers",description:"Restores 1/16 of max HP at the end of each turn.",power:16,consumable:!1},{id:4007,categoryId:40,name:"Focus Sash",description:"Survives a one-hit KO with 1 HP when at full health. Single use.",power:1,consumable:!0},{id:4008,categoryId:40,name:"Assault Vest",description:"Boosts Sp. Def by 50% but prevents the use of status moves.",power:1.5,consumable:!1},{id:4009,categoryId:40,name:"Eviolite",description:"Boosts Def and Sp. Def by 50% if the holder can still evolve.",power:1.5,consumable:!1},{id:4010,categoryId:40,name:"Mystic Water",description:"Boosts Water-type moves by 20%.",power:1.2,consumable:!1},{id:4011,categoryId:40,name:"Charcoal",description:"Boosts Fire-type moves by 20%.",power:1.2,consumable:!1},{id:4012,categoryId:40,name:"Magnet",description:"Boosts Electric-type moves by 20%.",power:1.2,consumable:!1},{id:4013,categoryId:40,name:"Sitrus Berry",description:"Restores 25% of max HP when HP drops below 50%.",power:4,consumable:!0},{id:4014,categoryId:40,name:"Lum Berry",description:"Cures any status condition when afflicted. Single use.",power:0,consumable:!0},{id:4015,categoryId:40,name:"Rawst Berry",description:"Cures a burn when afflicted. Single use.",power:0,consumable:!0},{id:4016,categoryId:40,name:"Chesto Berry",description:"Cures sleep when afflicted. Single use.",power:0,consumable:!0},{id:4017,categoryId:40,name:"Damp Rock",description:"Extends the duration of Rain Dance.",power:0,consumable:!1},{id:4018,categoryId:40,name:"Heat Rock",description:"Extends the duration of Sunny Day.",power:0,consumable:!1},{id:4019,categoryId:40,name:"Smooth Rock",description:"Extends the duration of Sandstorm.",power:0,consumable:!1},{id:4020,categoryId:40,name:"Icy Rock",description:"Extends the duration of Hail.",power:0,consumable:!1},{id:4021,categoryId:40,name:"Light Clay",description:"Extends the duration of Light Screen and Reflect.",power:0,consumable:!1},{id:4022,categoryId:40,name:"Lucky Egg",description:"Increases experience gained by 50%.",power:1.5,consumable:!1}];class ct extends Mi{constructor(e,r,n,s,a){super(e,r,n,s,a)}instanciate(){return new ct(this.id,this.categoryId,this.name,this.description,this.power)}doesApply(e,r,n){return!(!n||n.opponent instanceof Q)}apply(e){if(e)return new Ai(Math.random()<Po(e,this.power));throw new Error("Missing target or current")}}function Po(t,e){const r=t.currentHp,n=t.currentStats.hp,s=t.captureRate;let a=1;return t.status&&(a=1.5,(t.status.move_effect_id===2||t.status.move_effect_id===6)&&(a=2)),(1+(n*3-r*2)*s*e*a)/(n*3)/256}class Xt extends Mi{constructor(e,r,n,s,a){super(e,r,n,s,a)}instanciate(){return new Xt(this.id,this.categoryId,this.name,this.description,this.power)}doesApply(e,r,n){return!(!e.fainted&&e.currentHp===e.currentStats.hp)}apply(e){if(e.currentHp===e.currentStats.hp)throw new Error("This pokemon is already at full health");return e.heal(this.power===-1?e.currentStats.hp:this.power),new Ai(!0)}}class Ii extends Mi{constructor(e,r,n,s,a){super(e,r,n,s,a)}instanciate(){return new Ii(this.id,this.categoryId,this.name,this.description,this.power)}doesApply(e,r,n){return e.fainted}apply(e){if(e.fainted)return e.revive(this.power===-1?e.currentStats.hp:Math.floor(e.currentStats.hp*this.power/100)),new Ai(!0);throw new Error("This item can only be used on fainted pokemon")}}class Ke{static POKEBALL=34;static POTION=27;static REVIVE=29;static HELD_ITEM=40;references={};ids=[];heldItemsMap=new Map;constructor(){Aw.forEach(e=>{switch(this.ids.push(e.id),e.categoryId){case Ke.POKEBALL:this.references[e.id]=new ct(e.id,e.categoryId,e.name,e.description,e.power);break;case Ke.POTION:this.references[e.id]=new Xt(e.id,e.categoryId,e.name,e.description,e.power);break;case Ke.REVIVE:this.references[e.id]=new Ii(e.id,e.categoryId,e.name,e.description,e.power);break}}),Mw.forEach(e=>{this.heldItemsMap.set(e.id,e)})}getItem(e){return this.references[e]}getHeldItemById(e){return this.heldItemsMap.get(e)}getHeldItemByName(e){for(const r of this.heldItemsMap.values())if(r.name===e)return r}getAllHeldItems(){return Array.from(this.heldItemsMap.values())}}const Cw=["earthquake","bulldoze","magnitude"];function Iw(t,e,r,n){if(!r)return 1;const s=e.toLowerCase(),a=n?.toLowerCase()??"";switch(t){case we.ELECTRIC:if(s==="electric")return 1.3;break;case we.GRASSY:if(s==="grass")return 1.3;if(Cw.includes(a))return .5;break;case we.PSYCHIC:if(s==="psychic")return 1.3;break;case we.MISTY:if(s==="dragon")return .5;break}return 1}function Tw(t,e){return t===we.PSYCHIC&&e}function zi(t){return!t.some(e=>e.toLowerCase()==="flying")}class hS{type;description;initiator;constructor(e){this.type=$.RUN,this.description="Run away from the battle",this.initiator=e}execute(e){if(e.isWild){e.escapeAttempts++;const r=Math.random()*255,n=e.oppSide.filter(i=>!!i),s=n.reduce((i,c)=>i+c.battleStats.speed,0)/(n.length||1);Math.floor(s*128/this.initiator.battleStats.speed)+30*e.escapeAttempts*r>255?(e.clearStack(),e.battleResult.win=!0,e.events.runnaway.set(!0),e.addToStack(new Wt(this.initiator)),e.addToStack(new I("You ran away safely!",this.initiator))):e.addToStack(new I("Failed to run away!",this.initiator))}else e.addToStack(new I("You can't run away from a trainer battle!",this.initiator))}}class Dw{type;description;initiator;target;owner;constructor(e,r,n){this.type=$.SWITCH,this.description="Switch",this.initiator=e,this.target=r,this.owner=n}execute(e){e.addToStack(new bw(this.initiator,this.target,this.owner)),e.addToStack(new I(`${this.target.name}, go!`,this.target)),e.addToStack(new I(`${this.initiator.name}, come back!`,this.initiator))}}class St{type;name;description;move;target;initiator;constructor(e,r,n){this.type=$.ATTACK,this.name=e.name,this.description=e.description,this.move=e,this.target=r,this.initiator=n}resolveTargets(e){return this.target.map(r=>r.side==="player"?e.playerSide[r.index]:e.oppSide[r.index]).filter(r=>!!r&&!r.fainted)}execute(e){const r=this.initiator,n=this.resolveTargets(e),s=e.playerSide.includes(r)?e.player:e.opponent,a=[];if(e.runItemEvent(X.ON_MOVE_SELECTED,this.initiator,{move:this.move,opponent:n[0]}),e.runAbilityEvent(V.ON_BEFORE_MOVE,r,n[0])===!1){a.push(new I(`${r.name} can't move!`,r)),this.flushActions(e,a);return}if(r.status?.when==="start-turn"){const c=r.status.playEffect(r);if(c?.message&&a.push(new I(c.message,r)),!c.canPlay){this.flushActions(e,a);return}}if(a.push(new I(r.name+" used "+this.move.name+"!",this.initiator)),!(this.move instanceof _t)&&this.move.priority>0&&e.battleField.terrain!==we.NONE&&n.every(o=>Tw(e.battleField.terrain,zi(o.types)))&&n.length>0){a.push(new I(`${r.name} cannot use ${this.move.name}!`,this.initiator)),this.flushActions(e,a);return}if(n.length===0&&this.target.length>0&&(!(this.move instanceof _t)&&(this.move.category==="no-damage"||this.move.power===0)||a.push(new I("But there was no target!",this.initiator))),this.target.forEach(c=>{const o=c.side==="player"?e.playerSide[c.index]:e.oppSide[c.index];if(!o||o.fainted)return;const d=c.side==="player"?e.player:e.opponent;if(e.runAbilityEvent(V.ON_TRY_HIT,o,r,this.move)===!1){a.push(new I(`It doesn't affect ${o.name}...`,this.initiator));return}if(!this.accuracyApplies(r,o,this.move,e,s))a.push(new I("But it failed!",this.initiator));else{const f=this.calculateDamage(r,o,this.move,e,s,1,c.side);if(this.move instanceof _t){const p=this.move;(s instanceof ce||s instanceof Q&&s?.comboJauge)&&s.comboJauge.consume();let g=0;s instanceof Q&&(g=s.getMasteryBonus(U.COMBO_DAMAGE));const y=this.calculateDamage(r,o,p.move2,e,s,.5+g/100,c.side);a.push(new Ka(this.move,o,this.initiator)),a.push(new I(p.pokemon2.name+" used "+p.move2.name+"!",this.initiator)),p.effects.forEach((S,E)=>{at.findEffect(S).when==="before-move"&&this.effectApplies(p.effectsChances[E],S,s,d)&&a.push(new Ze(S,o,this.initiator))}),y.immune?a.push(new I(p.move2.name+" doesn't affect "+o.name+"...",this.initiator)):y.notVeryEffective?a.push(new I(p.move2.name+" is not very effective...",this.initiator)):y.superEffective&&a.push(new I(p.move2.name+" is super effective!",this.initiator)),y.critical&&a.push(new I(p.move2.name+" critical hit!",this.initiator)),f.immune?a.push(new I(p.move1.name+" doesn't affect "+o.name+"...",this.initiator)):f.notVeryEffective?a.push(new I(p.move1.name+" is not very effective...",this.initiator)):f.superEffective&&a.push(new I(p.move1.name+" is super effective!",this.initiator)),f.critical&&a.push(new I(p.move1.name+" critical hit!",this.initiator)),a.push(new Ki(f.damages+y.damages,o,this.initiator)),p.move1.category==="physical"&&e.runAbilityEvent(V.ON_CONTACT,o,r,p.move1,f.damages+y.damages),p.effects.forEach((S,E)=>{const b=at.findEffect(S);this.effectApplies(p.effectsChances[E],S,s,d)&&b.when!=="before-move"&&a.push(new Ze(S,o,this.initiator))})}else{const p=at.findEffect(this.move.effect);let g;p.when==="before-move"&&this.effectApplies(this.move.effectChance,this.move.effect,s,d)&&(g=p.apply([o],this.initiator)?.hitCount,a.push(new Ze(this.move.effect,o,this.initiator))),f.immune||a.push(new Ka(this.move,o,this.initiator,g)),f.immune?a.push(new I("It doesn't affect "+o.name+"...",this.initiator)):f.notVeryEffective?a.push(new I("It's not very effective...",this.initiator)):f.superEffective&&a.push(new I("It's super effective!",this.initiator)),f.critical&&a.push(new I("A critical hit!",this.initiator)),a.push(new Ki(f.damages,o,this.initiator)),a.push(new Ew(this.initiator,s,f.superEffective,f.critical)),this.move.category==="physical"&&f.damages>0&&e.runAbilityEvent(V.ON_CONTACT,o,r,this.move,f.damages),!f.immune&&this.effectApplies(this.move.effectChance,this.move.effect,s,d)&&p.when!=="before-move"&&a.push(new Ze(this.move.effect,o,this.initiator))}}}),n.length===0&&!(this.move instanceof _t)){const o=["spikes","toxic-spikes","stealth-rock","sticky-web"].includes(this.move.name.toLowerCase());let d=this.initiator;if(o){const f=(e.getPokemonSide(this.initiator)==="ally"?e.oppSide:e.playerSide).find(p=>p&&!p.fainted);f&&(d=f)}a.push(new Ka(this.move,d,this.initiator)),this.effectApplies(this.move.effectChance,this.move.effect,s)&&a.push(new Ze(this.move.effect,this.initiator,this.initiator))}n[0]&&(e.runAbilityEvent(V.ON_AFTER_MOVE,r,n[0]),e.runItemEvent(X.ON_AFTER_HIT,this.initiator,{opponent:n[0],move:this.move})),this.flushActions(e,a)}flushActions(e,r){r&&r.length>0&&r.reverse().forEach(n=>e.addToStack(n))}calculateDamage(e,r,n,s,a,i=1,c="opponent"){const o=new Sg,d=n.effect?.move_effect_id===204,h=d?vw(s.battleField.weather):n.type,u=d?_w(s.battleField.weather):n.power,f=this.calculateTypeEffectiveness(h,r.types,s);o.superEffective=f>1,o.notVeryEffective=f<1,o.immune=f===0;const p=o.immune?0:this.calculateCritical(a,n);if(o.critical=p>1,e.lastHitCritical=o.critical,n.category!=="no-damage"&&u>0){let g=n.category==="physical"?e?.battleStats.attack:e?.battleStats.specialAttack,y=n.category==="physical"?r?.battleStats.defense:r?.battleStats.specialDefense;if(n.category==="physical"){const j=s.runAbilityEvent(V.ON_MODIFY_ATK,e,r,n,g);j!==void 0&&(g=j);const G=s.runItemEvent(X.ON_MODIFY_ATK,e,{statValue:g,opponent:r,move:n});G!==void 0&&(g=G);const W=s.runAbilityEvent(V.ON_MODIFY_DEF,r,e,n,y);W!==void 0&&(y=W);const Y=s.runItemEvent(X.ON_MODIFY_DEF,r,{statValue:y,opponent:e,move:n});Y!==void 0&&(y=Y)}else{const j=s.runAbilityEvent(V.ON_MODIFY_SPA,e,r,n,g);j!==void 0&&(g=j);const G=s.runItemEvent(X.ON_MODIFY_SPA,e,{statValue:g,opponent:r,move:n});G!==void 0&&(g=G);const W=s.runAbilityEvent(V.ON_MODIFY_SPD,r,e,n,y);W!==void 0&&(y=W);const Y=s.runItemEvent(X.ON_MODIFY_SPD,r,{statValue:y,opponent:e,move:n});Y!==void 0&&(y=Y)}if(n.category==="special"){const j=mw(s.battleField,r.types);y=Math.floor(y*j)}n.category==="physical"&&e?.status?.abr==="BRN"&&(g=Math.floor(g*.5));const S=Math.random()*(1-.85)+.85,E=this.calculateStab(e,h,a),b=fw(s.battleField,h,n.name),A=this.calculateScreenMultiplier(n.category,c,s),D=Iw(s.battleField.terrain,h,zi(e.types),n.name),x=b*A*D,F=f*p*S*E*x;o.damages=Math.floor(((2*e.level/5+2)*u*g/y/50+2)*F*i);const R=s.runAbilityEvent(V.ON_MODIFY_DAMAGE,e,r,n,o.damages);R!==void 0&&(o.damages=R);const P=s.runAbilityEvent(V.ON_SOURCE_MODIFY_DAMAGE,r,e,n,o.damages);P!==void 0&&(o.damages=P);const T=s.runItemEvent(X.ON_MODIFY_DAMAGE,e,{damage:o.damages,opponent:r,move:n,effectiveness:f});T!==void 0&&(o.damages=T);const H=s.runItemEvent(X.ON_MODIFY_DAMAGE,r,{damage:o.damages,opponent:e,move:n,effectiveness:f});H!==void 0&&(o.damages=H)}else o.damages=0;return o}calculateTypeEffectiveness(e,r,n){return r?.reduce((s,a)=>{let i=n.fromTypeChart(e,a);return n.battleField.weather===k.STRONG_WINDS&&a.toLowerCase()==="flying"&&i>1&&(i=1),s*i},1)||1}calculateCritical(e,r){let n=0;e instanceof Q&&(n=e.getMasteryBonus(U.CRITICAL));const a=r.effect?.move_effect_id===44||r.effect?.move_effect_id===144?.125:.0625;return Math.random()<a?1.5+n/100:1}calculateStab(e,r,n){if(e.types.includes(r)){let s=0;return n instanceof Q&&(s=n.getMasteryBonus(U.STAB)),1.5+s/100}else{let s=0;return n instanceof Q&&(s=n.getMasteryBonus(U.NON_STAB)),1+s/100}}calculateScreenMultiplier(e,r,n){if(e==="no-damage")return 1;const s=r==="player"?"ally":"enemy",a=e==="physical"?li.REFLECT:li.LIGHT_SCREEN;return n.battleField.hasScreen(s,a)?n.battleType===ye.DOUBLE?2/3:.5:1}accuracyApplies(e,r,n,s,a){if(!n.accuracy||n.accuracy===0)return!0;const i=ww(s.battleField,n.name,n.accuracy);let c=0;a instanceof Q&&(c=a.getMasteryBonus(U.ACCURACY));const o=e.statsChanges.accuracy-r.statsChanges.evasion,d=o>=0?(3+o)/3:3/(3-o),h=(i??n.accuracy)*d+c;return Math.random()*100<h}effectApplies(e,r,n,s){if(!r)return!1;if(Number.isNaN(e))return!0;if(!Number.isInteger(e))return!1;let a=e;if(n instanceof Q){a+=n.getMasteryBonus(U.EFFECTIVENESS);const i=r.move_effect_id;(i===3||i===5||i===34)&&(a+=n.getMasteryBonus(U.DOT_CHANCE)),(i===77||i===13)&&(a+=n.getMasteryBonus(U.CONFUSE)),i===78&&(a+=n.getMasteryBonus(U.ATTRACT))}return s instanceof Q&&(a-=s.getMasteryBonus(U.RESISTANCE)),Math.random()*100<a}}class xw{type;description;itemId;target;initiator;owner;constructor(e,r,n,s){this.type=$.ITEM,this.description="Use a bag object",this.itemId=e,this.target=r,this.initiator=n,this.owner=s}execute(e){const r=this.owner.bag.getItem(this.itemId,e.ITEMS);if(r&&!(r instanceof ct)&&(r.apply(this.target).success||e.addToStack(new I("It failed!",this.initiator)),r instanceof Xt&&this.owner instanceof Q)){const s=this.owner.getMasteryBonus(U.HEAL);if(s>0&&r.power>0){const a=Math.floor(r.power*s/100);a>0&&this.target.heal(a)}}if(r instanceof ct){let n=0;this.owner instanceof Q&&(n=this.owner.getMasteryBonus(U.CATCH));const a=Po(this.target,r.power)*(1+n/100);Math.random()<a?(e.battleResult.caught=this.target,e.battleResult.win=!0,e.addToStack(new Wt(this.initiator)),e.addToStack(new I("Gotcha! "+this.target.name+" was caught!",this.initiator))):e.addToStack(new I("Oh no! The Pokémon broke free!",this.initiator))}e.addToStack(new I(`${this.owner.name} used ${r?.name}!`,this.initiator))}}const Rw=JSON.parse(`[{"id":1,"names":"Stench","description":"Has a 10% chance of making target Pokémon [flinch]{mechanic:flinch} with each hit."},{"id":2,"names":"Drizzle","description":"Summons [rain]{mechanic:rain} that lasts indefinitely upon entering battle."},{"id":3,"names":"Speed Boost","description":"Raises [Speed]{mechanic:speed} one [stage]{mechanic:stat-modifier} after each turn."},{"id":4,"names":"Battle Armor","description":"Protects against [critical hits]{mechanic:critical-hit}."},{"id":5,"names":"Sturdy","description":"Prevents being KOed from full [HP]{mechanic:hp}, leaving 1 HP instead.  Protects against the one-hit KO moves regardless of HP."},{"id":6,"names":"Damp","description":"Prevents []{move:self-destruct}, []{move:explosion}, and []{ability:aftermath} from working while the Pokémon is in battle."},{"id":7,"names":"Limber","description":"Prevents [paralysis]{mechanic:paralysis}."},{"id":8,"names":"Sand Veil","description":"Increases [evasion]{mechanic:evasion} to 1.25× during a [sandstorm]{mechanic:sandstorm}.  Protects against sandstorm damage."},{"id":9,"names":"Static","description":"Has a 30% chance of [paralyzing]{mechanic:paralysis} attacking Pokémon on contact."},{"id":10,"names":"Volt Absorb","description":"Absorbs []{type:electric} moves, healing for 1/4 max [HP]{mechanic:hp}."},{"id":11,"names":"Water Absorb","description":"Absorbs []{type:water} moves, healing for 1/4 max [HP]{mechanic:hp}."},{"id":12,"names":"Oblivious","description":"Prevents [infatuation]{mechanic:infatuation} and protects against []{move:captivate}."},{"id":13,"names":"Cloud Nine","description":"Negates all effects of [weather]{mechanic:weather}, but does not prevent the weather itself."},{"id":14,"names":"Compound Eyes","description":"Increases moves' [accuracy]{mechanic:accuracy} to 1.3×."},{"id":15,"names":"Insomnia","description":"Prevents [sleep]{mechanic:sleep}."},{"id":16,"names":"Color Change","description":"Changes type to match when hit by a damaging move."},{"id":17,"names":"Immunity","description":"Prevents [poison]{mechanic:poison}."},{"id":18,"names":"Flash Fire","description":"Protects against []{type:fire} moves.  Once one has been blocked, the Pokémon's own Fire moves inflict 1.5× damage until it leaves battle."},{"id":19,"names":"Shield Dust","description":"Protects against incoming moves' extra effects."},{"id":20,"names":"Own Tempo","description":"Prevents [confusion]{mechanic:confusion}."},{"id":21,"names":"Suction Cups","description":"Prevents being forced out of battle by other Pokémon's moves."},{"id":22,"names":"Intimidate","description":"Lowers opponents' [Attack]{mechanic:attack} one [stage]{mechanic:stat-modifier} upon entering battle."},{"id":23,"names":"Shadow Tag","description":"Prevents opponents from fleeing or switching out."},{"id":24,"names":"Rough Skin","description":"Damages attacking Pokémon for 1/8 their max [HP]{mechanic:hp} on contact."},{"id":25,"names":"Wonder Guard","description":"Protects against damaging moves that are not [super effective]{mechanic:super-effective}."},{"id":26,"names":"Levitate","description":"Evades []{type:ground} moves."},{"id":27,"names":"Effect Spore","description":"Has a 30% chance of inflcting either [paralysis]{mechanic:paralysis}, [poison]{mechanic:poison}, or [sleep]{mechanic:sleep} on attacking Pokémon on contact."},{"id":28,"names":"Synchronize","description":"Copies [burns]{mechanic:burn}, [paralysis]{mechanic:paralysis}, and [poison]{mechanic:poison} received onto the Pokémon that inflicted them."},{"id":29,"names":"Clear Body","description":"Prevents stats from being [lowered]{mechanic:stat-modifier} by other Pokémon."},{"id":30,"names":"Natural Cure","description":"Cures any [major status ailment]{mechanic:major-status-ailment} upon switching out."},{"id":31,"names":"Lightning Rod","description":"Redirects single-target []{type:electric} moves to this Pokémon where possible.  Absorbs Electric moves, raising [Special Attack]{mechanic:special-attack} one [stage]{mechanic:stat-modifier}."},{"id":32,"names":"Serene Grace","description":"Doubles the chance of moves' extra effects occurring."},{"id":33,"names":"Swift Swim","description":"Doubles [Speed]{mechanic:speed} during [rain]{mechanic:rain}."},{"id":34,"names":"Chlorophyll","description":"Doubles [Speed]{mechanic:speed} during [strong sunlight]{mechanic:strong-sunlight}."},{"id":35,"names":"Illuminate","description":"Doubles the wild encounter rate."},{"id":36,"names":"Trace","description":"Copies an opponent's ability upon entering battle."},{"id":37,"names":"Huge Power","description":"Doubles [Attack]{mechanic:attack} in battle."},{"id":38,"names":"Poison Point","description":"Has a 30% chance of [poisoning]{mechanic:poison} attacking Pokémon on contact."},{"id":39,"names":"Inner Focus","description":"Prevents [flinching]{mechanic:flinching}."},{"id":40,"names":"Magma Armor","description":"Prevents [freezing]{mechanic:freezing}."},{"id":41,"names":"Water Veil","description":"Prevents [burns]{mechanic:burn}."},{"id":42,"names":"Magnet Pull","description":"Prevents []{type:steel} opponents from fleeing or switching out."},{"id":43,"names":"Soundproof","description":"Protects against sound-based moves."},{"id":44,"names":"Rain Dish","description":"Heals for 1/16 max [HP]{mechanic:hp} after each turn during [rain]{mechanic:rain}."},{"id":45,"names":"Sand Stream","description":"Summons a [sandstorm]{mechanic:sandstorm} that lasts indefinitely upon entering battle."},{"id":46,"names":"Pressure","description":"Increases the [PP]{mechanic:pp} cost of moves targetting the Pokémon by one."},{"id":47,"names":"Thick Fat","description":"Halves damage from []{type:fire} and []{type:ice} moves."},{"id":48,"names":"Early Bird","description":"Makes [sleep]{mechanic:sleep} pass twice as quickly."},{"id":49,"names":"Flame Body","description":"Has a 30% chance of [burning]{mechanic:burn} attacking Pokémon on contact."},{"id":50,"names":"Run Away","description":"Ensures success fleeing from wild battles."},{"id":51,"names":"Keen Eye","description":"Prevents [accuracy]{mechanic:accuracy} from being [lowered]{mechanic:stat-modifier}."},{"id":52,"names":"Hyper Cutter","description":"Prevents [Attack]{mechanic:attack} from being [lowered]{mechanic:stat-modifiers} by other Pokémon."},{"id":53,"names":"Pickup","description":"Picks up other Pokémon's used and [Flung]{move:fling} held items.  May also pick up an item after battle."},{"id":54,"names":"Truant","description":"Skips every second turn."},{"id":55,"names":"Hustle","description":"Strengthens physical moves to inflict 1.5× damage, but decreases their [accuracy]{mechanic:accuracy} to 0.8×."},{"id":56,"names":"Cute Charm","description":"Has a 30% chance of [infatuating]{mechanic:infatuation} attacking Pokémon on contact."},{"id":57,"names":"Plus","description":"Increases [Special Attack]{mechanic:special-attack} to 1.5× when a friendly Pokémon has []{ability:plus} or []{ability:minus}."},{"id":58,"names":"Minus","description":"Increases [Special Attack]{mechanic:special-attack} to 1.5× when a friendly Pokémon has []{ability:plus} or []{ability:minus}."},{"id":59,"names":"Forecast","description":"Changes []{pokemon:castform}'s type and form to match the [weather]{mechanic:weather}."},{"id":60,"names":"Sticky Hold","description":"Prevents a held item from being removed by other Pokémon."},{"id":61,"names":"Shed Skin","description":"Has a 33% chance of curing any [major status ailment]{mechanic:major-status-ailment} after each turn."},{"id":62,"names":"Guts","description":"Increases [Attack]{mechanic:attack} to 1.5× with a [major status ailment]{mechanic:major-status-ailment}."},{"id":63,"names":"Marvel Scale","description":"Increases [Defense]{mechanic:defense} to 1.5× with a [major status ailment]{mechanic:major-status-ailment}."},{"id":64,"names":"Liquid Ooze","description":"Damages opponents using leeching moves for as much as they would heal."},{"id":65,"names":"Overgrow","description":"Strengthens []{type:grass} moves to inflict 1.5× damage at 1/3 max [HP]{mechanic:hp} or less."},{"id":66,"names":"Blaze","description":"Strengthens []{type:fire} moves to inflict 1.5× damage at 1/3 max [HP]{mechanic:hp} or less."},{"id":67,"names":"Torrent","description":"Strengthens []{type:water} moves to inflict 1.5× damage at 1/3 max [HP]{mechanic:hp} or less."},{"id":68,"names":"Swarm","description":"Strengthens []{type:bug} moves to inflict 1.5× damage at 1/3 max [HP]{mechanic:hp} or less."},{"id":69,"names":"Rock Head","description":"Protects against recoil damage."},{"id":70,"names":"Drought","description":"Summons [strong sunlight]{mechanic:strong-sunlight} that lasts indefinitely upon entering battle."},{"id":71,"names":"Arena Trap","description":"Prevents opponents from fleeing or switching out.  Eluded by []{type:flying}-types and Pokémon in the air."},{"id":72,"names":"Vital Spirit","description":"Prevents [sleep]{mechanic:sleep}."},{"id":73,"names":"White Smoke","description":"Prevents stats from being [lowered]{mechanic:stat-modifier} by other Pokémon."},{"id":74,"names":"Pure Power","description":"Doubles [Attack]{mechanic:attack} in battle."},{"id":75,"names":"Shell Armor","description":"Protects against [critical hits]{mechanic:critical-hit}."},{"id":76,"names":"Air Lock","description":"Negates all effects of [weather]{mechanic:weather}, but does not prevent the weather itself."},{"id":77,"names":"Tangled Feet","description":"Doubles [evasion]{mechanic:evasion} when [confused]{mechanic:confusion}."},{"id":78,"names":"Motor Drive","description":"Absorbs []{type:electric} moves, raising [Speed]{mechanic:speed} one [stage]{mechanic:stat-modifier}."},{"id":79,"names":"Rivalry","description":"Increases damage inflicted to 1.25× against Pokémon of the same gender, but decreases damage to 0.75× against the opposite gender."},{"id":80,"names":"Steadfast","description":"Raises [Speed]{mechanic:speed} one [stage]{mechanic:stat-modifier} upon [flinching]{mechanic:flinching}."},{"id":81,"names":"Snow Cloak","description":"Increases evasion to 1.25× during [hail]{mechanic:hail}.  Protects against hail damage."},{"id":82,"names":"Gluttony","description":"Makes the Pokémon eat any held Berry triggered by low [HP]{mechanic:hp} below 1/2 its max HP."},{"id":83,"names":"Anger Point","description":"Raises [Attack]{mechanic:attack} to the maximum of six [stages]{mechanic:stat-modifier} upon receiving a [critical hit]{mechanic:critical-hit}."},{"id":84,"names":"Unburden","description":"Doubles [Speed]{mechanic:speed} upon using or losing a held item."},{"id":85,"names":"Heatproof","description":"Halves damage from []{type:fire} moves and [burns]{mechanic:burn}."},{"id":86,"names":"Simple","description":"Doubles the Pokémon's [stat modifiers]{mechanic:stat-modifiers}.  These doubled modifiers are still capped at -6 or 6 stages."},{"id":87,"names":"Dry Skin","description":"Causes 1/8 max [HP]{mechanic:hp} in damage each turn during [strong sunlight]{mechanic:strong-sunlight}, but heals for 1/8 max HP during [rain]{mechanic:rain}.  Increases damage from []{type:fire} moves to 1.25×, but absorbs []{type:water} moves, healing for 1/4 max HP."},{"id":88,"names":"Download","description":"Raises the attack stat corresponding to the opponents' weaker defense one [stage]{mechanic:stat-modifier} upon entering battle."},{"id":89,"names":"Iron Fist","description":"Strengthens punch-based moves to 1.2× their power."},{"id":90,"names":"Poison Heal","description":"Heals for 1/8 max [HP]{mechanic:hp} after each turn when [poisoned]{mechanic:poison} in place of damage."},{"id":91,"names":"Adaptability","description":"Increases the [same-type attack bonus]{mechanic:same-type-attack-bonus} from 1.5× to 2×."},{"id":92,"names":"Skill Link","description":"Extends two-to-five-hit moves and []{move:triple-kick} to their full length every time."},{"id":93,"names":"Hydration","description":"Cures any [major status ailment]{mechanic:major-status-ailment} after each turn during [rain]{mechanic:rain}."},{"id":94,"names":"Solar Power","description":"Increases [Special Attack]{mechanic:special-attack} to 1.5× but costs 1/8 max [HP]{mechanic:hp} after each turn during [strong sunlight]{mechanic:strong-sunlight}."},{"id":95,"names":"Quick Feet","description":"Increases [Speed]{mechanic:speed} to 1.5× with a [major status ailment]{mechanic:major-status-ailment}."},{"id":96,"names":"Normalize","description":"Makes the Pokémon's moves all act []{type:normal}-type."},{"id":97,"names":"Sniper","description":"Strengthens [critical hits]{mechanic:critical-hit} to inflict 3× damage rather than 2×."},{"id":98,"names":"Magic Guard","description":"Protects against damage not directly caused by a move."},{"id":99,"names":"No Guard","description":"Ensures all moves used by and against the Pokémon hit."},{"id":100,"names":"Stall","description":"Makes the Pokémon move last within its move's priority bracket."},{"id":101,"names":"Technician","description":"Strengthens moves of 60 base power or less to 1.5× their power."},{"id":102,"names":"Leaf Guard","description":"Protects against [major status ailments]{mechanic:major-status-ailments} during [strong sunlight]{mechanic:strong-sunlight}."},{"id":103,"names":"Klutz","description":"Prevents the Pokémon from using its held item in battle."},{"id":104,"names":"Mold Breaker","description":"Bypasses targets' abilities if they could hinder or prevent a move."},{"id":105,"names":"Super Luck","description":"Raises moves' [critical hit]{mechanic:critical-hit} rates one stage."},{"id":106,"names":"Aftermath","description":"Damages the attacker for 1/4 its max [HP]{mechanic:hp} when knocked out by a contact move."},{"id":107,"names":"Anticipation","description":"Notifies all trainers upon entering battle if an opponent has a [super-effective]{mechanic:super-effective} move, []{move:self-destruct}, []{move:explosion}, or a one-hit KO move."},{"id":108,"names":"Forewarn","description":"Reveals the opponents' strongest move upon entering battle."},{"id":109,"names":"Unaware","description":"Ignores other Pokémon's stat modifiers for damage and accuracy calculation."},{"id":110,"names":"Tinted Lens","description":"Doubles damage inflicted with [not-very-effective]{mechanic:not-very-effective} moves."},{"id":111,"names":"Filter","description":"Decreases damage taken from [super-effective]{mechanic:super-effective} moves by 1/4."},{"id":112,"names":"Slow Start","description":"Halves [Attack]{mechanic:attack} and [Speed]{mechanic:speed} for five turns upon entering battle."},{"id":113,"names":"Scrappy","description":"Lets the Pokémon's []{type:normal} and []{type:fighting} moves hit []{type:ghost} Pokémon."},{"id":114,"names":"Storm Drain","description":"Redirects single-target []{type:water} moves to this Pokémon where possible.  Absorbs Water moves, raising [Special Attack]{mechanic:special-attack} one [stage]{mechanic:stat-modifier}."},{"id":115,"names":"Ice Body","description":"Heals for 1/16 max [HP]{mechanic:hp} after each turn during hail.  Protects against hail damage."},{"id":116,"names":"Solid Rock","description":"Decreases damage taken from [super-effective]{mechanic:super-effective} moves by 1/4."},{"id":117,"names":"Snow Warning","description":"Summons [hail]{mechanic:hail} that lasts indefinitely upon entering battle."},{"id":118,"names":"Honey Gather","description":"The Pokémon may pick up []{item:honey} after battle."},{"id":119,"names":"Frisk","description":"Reveals an opponent's held item upon entering battle."},{"id":120,"names":"Reckless","description":"Strengthens recoil moves to 1.2× their power."},{"id":121,"names":"Multitype","description":"Changes []{pokemon:arceus}'s type and form to match its held Plate."},{"id":122,"names":"Flower Gift","description":"Increases friendly Pokémon's [Attack]{mechanic:attack} and [Special Defense]{mechanic:special-defense} to 1.5× during [strong sunlight]{mechanic:strong-sunlight}."},{"id":123,"names":"Bad Dreams","description":"Damages [sleeping]{mechanic:sleep} opponents for 1/8 their max [HP]{mechanic:hp} after each turn."},{"id":124,"names":"Pickpocket","description":"Steals attacking Pokémon's held items on contact."},{"id":125,"names":"Sheer Force","description":"Strengthens moves with extra effects to 1.3× their power, but prevents their extra effects."},{"id":126,"names":"Contrary","description":"Inverts [stat changes]{mechanic:stat-modifiers}."},{"id":127,"names":"Unnerve","description":"Prevents opposing Pokémon from eating held Berries."},{"id":128,"names":"Defiant","description":"Raises [Attack]{mechanic:attack} two [stages]{mechanic:stat-modifier} upon having any stat lowered."},{"id":129,"names":"Defeatist","description":"Halves [Attack]{mechanic:attack} and [Special Attack]{mechanic:special-attack} at 50% max [HP]{mechanic:hp} or less."},{"id":130,"names":"Cursed Body","description":"Has a 30% chance of [Disabling]{move:disable} any move that hits the Pokémon."},{"id":131,"names":"Healer","description":"Has a 30% chance of curing each adjacent ally of any [major status ailment]{mechanic:major-status-ailment} after each turn."},{"id":132,"names":"Friend Guard","description":"Decreases all direct damage taken by friendly Pokémon to 0.75×."},{"id":133,"names":"Weak Armor","description":"Raises [Speed]{mechanic:speed} and lowers [Defense]{mechanic:defense} by one stage each upon being hit by a physical move."},{"id":134,"names":"Heavy Metal","description":"Doubles the Pokémon's weight."},{"id":135,"names":"Light Metal","description":"Halves the Pokémon's weight."},{"id":136,"names":"Multiscale","description":"Halves damage taken from full [HP]{mechanic:hp}."},{"id":137,"names":"Toxic Boost","description":"Increases [Attack]{mechanic:attack} to 1.5× when [poisoned]{mechanic:poison}."},{"id":138,"names":"Flare Boost","description":"Increases [Special Attack]{mechanic:special-attack} to 1.5× when [burned]{mechanic:burn}."},{"id":139,"names":"Harvest","description":"Has a 50% chance of restoring a used Berry after each turn if the Pokémon has held no items in the meantime."},{"id":140,"names":"Telepathy","description":"Protects against friendly Pokémon's damaging moves."},{"id":141,"names":"Moody","description":"Raises a random stat two [stages]{mechanic:stat-modifier} and lowers another one stage after each turn."},{"id":142,"names":"Overcoat","description":"Protects against damage from [weather]{mechanic:weather}."},{"id":143,"names":"Poison Touch","description":"Has a 30% chance of [poisoning]{mechanic:poison} target Pokémon upon contact."},{"id":144,"names":"Regenerator","description":"Heals for 1/3 max [HP]{mechanic:hp} upon switching out."},{"id":145,"names":"Big Pecks","description":"Protects against [Defense]{mechanic:defense} drops."},{"id":146,"names":"Sand Rush","description":"Doubles [Speed]{mechanic:speed} during a [sandstorm]{mechanic:sandstorm}.  Protects against sandstorm damage."},{"id":147,"names":"Wonder Skin","description":"Lowers incoming non-damaging moves' base [accuracy]{mechanic:accuracy} to exactly 50%."},{"id":148,"names":"Analytic","description":"Strengthens moves to 1.3× their power when moving last."},{"id":149,"names":"Illusion","description":"Takes the appearance of the last conscious party Pokémon upon being sent out until hit by a damaging move."},{"id":150,"names":"Imposter","description":"[Transforms]{move:transform} upon entering battle."},{"id":151,"names":"Infiltrator","description":"Bypasses []{move:light-screen}, []{move:reflect}, and []{move:safeguard}."},{"id":152,"names":"Mummy","description":"Changes attacking Pokémon's abilities to Mummy on contact."},{"id":153,"names":"Moxie","description":"Raises [Attack]{mechanic:attack} one stage upon KOing a Pokémon."},{"id":154,"names":"Justified","description":"Raises [Attack]{mechanic:attack} one stage upon taking damage from a []{type:dark} move."},{"id":155,"names":"Rattled","description":"Raises [Speed]{mechanic:speed} one [stage]{mechanic:stat-modifier} upon being hit by a []{type:dark}, []{type:ghost}, or []{type:bug} move."},{"id":156,"names":"Magic Bounce","description":"Reflects most non-damaging moves back at their user."},{"id":157,"names":"Sap Sipper","description":"Absorbs []{type:grass} moves, raising [Attack]{mechanic:attack} one [stage]{mechanic:stat-modifier}."},{"id":158,"names":"Prankster","description":"Raises non-damaging moves' priority by one stage."},{"id":159,"names":"Sand Force","description":"Strengthens []{type:rock}, []{type:ground}, and []{type:steel} moves to 1.3× their power during a [sandstorm]{mechanic:sandstorm}.  Protects against sandstorm damage."},{"id":160,"names":"Iron Barbs","description":"Damages attacking Pokémon for 1/8 their max [HP]{mechanic:hp} on contact."},{"id":161,"names":"Zen Mode","description":"Changes []{pokemon:darmanitan}'s form after each turn depending on its [HP]{mechanic:hp}: Zen Mode below 50% max HP, and Standard Mode otherwise."},{"id":162,"names":"Victory Star","description":"Increases moves' accuracy to 1.1× for friendly Pokémon."},{"id":163,"names":"Turboblaze","description":"Bypasses targets' abilities if they could hinder or prevent moves."},{"id":164,"names":"Teravolt","description":"Bypasses targets' abilities if they could hinder or prevent moves."},{"id":165,"names":"Aroma Veil","description":"Protects allies against moves that affect their mental state."},{"id":166,"names":"Flower Veil","description":"Protects friendly []{type:grass} Pokémon from having their stats lowered by other Pokémon."},{"id":167,"names":"Cheek Pouch","description":"Restores HP upon eating a Berry, in addition to the Berry's effect."},{"id":168,"names":"Protean","description":"Changes the bearer's type to match each move it uses."},{"id":169,"names":"Fur Coat","description":"Halves damage from physical attacks."},{"id":170,"names":"Magician","description":"Steals the target's held item when the bearer uses a damaging move."},{"id":171,"names":"Bulletproof","description":"Protects against bullet, ball, and bomb-based moves."},{"id":172,"names":"Competitive","description":"Raises Special Attack by two stages upon having any stat lowered."},{"id":173,"names":"Strong Jaw","description":"Strengthens biting moves to 1.5× their power."},{"id":174,"names":"Refrigerate","description":"Turns the bearer's []{type:normal} moves into []{type:ice} moves and strengthens them to 1.3× their power."},{"id":175,"names":"Sweet Veil","description":"Prevents friendly Pokémon from sleeping."},{"id":176,"names":"Stance Change","description":"Changes []{pokemon:aegislash} to Blade Forme before using a damaging move, or Shield Forme before using []{move:kings-shield}."},{"id":177,"names":"Gale Wings","description":"Raises []{type:flying} moves' priority by one stage."},{"id":178,"names":"Mega Launcher","description":"Strengthens aura and pulse moves to 1.5× their power."},{"id":179,"names":"Grass Pelt","description":"Boosts Defense while []{move:grassy-terrain} is in effect."},{"id":180,"names":"Symbiosis","description":"Passes the bearer's held item to an ally when the ally uses up its item."},{"id":181,"names":"Tough Claws","description":"Strengthens moves that make contact to 1.33× their power."},{"id":182,"names":"Pixilate","description":"Turns the bearer's []{type:normal} moves into []{type:fairy} moves and strengthens them to 1.3× their power."},{"id":183,"names":"Gooey","description":"Lowers attacking Pokémon's Speed by one stage on contact."},{"id":184,"names":"Aerilate","description":"Turns the bearer's []{type:normal} moves into []{type:flying} moves and strengthens them to 1.3× their power."},{"id":185,"names":"Parental Bond","description":"Lets the bearer hit twice with damaging moves.  The second hit has half power."},{"id":186,"names":"Dark Aura","description":"Strengthens []{type:dark} moves to 1.33× their power for all friendly and opposing Pokémon."},{"id":187,"names":"Fairy Aura","description":"Strengthens []{type:fairy} moves to 1.33× their power for all friendly and opposing Pokémon."},{"id":188,"names":"Aura Break","description":"Makes []{ability:dark-aura} and []{ability:fairy-aura} weaken moves of their respective types."},{"id":189,"names":"Primordial Sea","description":"Creates heavy rain, which has all the properties of Rain Dance, cannot be replaced, and causes damaging Fire moves to fail."},{"id":190,"names":"Desolate Land","description":"Creates extremely harsh sunlight, which has all the properties of Sunny Day, cannot be replaced, and causes damaging Water moves to fail."},{"id":191,"names":"Delta Stream","description":"Creates a mysterious air current, which cannot be replaced and causes moves to never be super effective against Flying Pokémon."},{"id":192,"names":"Stamina","description":"Raises this Pokémon's Defense by one stage when it takes damage from a move."},{"id":193,"names":"Wimp Out","description":"This Pokémon automatically switches out when its HP drops below half."},{"id":194,"names":"Emergency Exit","description":"This Pokémon automatically switches out when its HP drops below half."},{"id":195,"names":"Water Compaction","description":"Raises this Pokémon's Defense by two stages when it's hit by a Water move."},{"id":196,"names":"Merciless","description":"This Pokémon's moves critical hit against poisoned targets."},{"id":197,"names":"Shields Down","description":"Transforms this Minior between Core Form and Meteor Form.  Prevents major status ailments and drowsiness while in Meteor Form."},{"id":198,"names":"Stakeout","description":"This Pokémon's moves have double power against Pokémon that switched in this turn."},{"id":199,"names":"Water Bubble","description":"Halves damage from Fire moves, doubles damage of Water moves, and prevents burns."},{"id":200,"names":"Steelworker","description":"This Pokémon's Steel moves have 1.5× power."},{"id":201,"names":"Berserk","description":"Raises this Pokémon's Special Attack by one stage every time its HP drops below half."},{"id":202,"names":"Slush Rush","description":"During Hail, this Pokémon has double Speed."},{"id":203,"names":"Long Reach","description":"This Pokémon's moves do not make contact."},{"id":204,"names":"Liquid Voice","description":"Sound-based moves become Water-type."},{"id":205,"names":"Triage","description":"This Pokémon's healing moves have their priority increased by 3."},{"id":206,"names":"Galvanize","description":"This Pokémon's Normal moves are Electric and have their power increased to 1.2×."},{"id":207,"names":"Surge Surfer","description":"Doubles this Pokémon's Speed on Electric Terrain."},{"id":208,"names":"Schooling","description":"Wishiwashi becomes Schooling Form when its HP is 25% or higher."},{"id":209,"names":"Disguise","description":"Prevents the first instance of battle damage."},{"id":210,"names":"Battle Bond","description":"Transforms this Pokémon into Ash-Greninja after fainting an opponent.  Water Shuriken's power is 20 and always hits three times."},{"id":211,"names":"Power Construct","description":"Transforms 10% or 50% Zygarde into Complete Forme when its HP is below 50%."},{"id":212,"names":"Corrosion","description":"This Pokémon can inflict poison on Poison and Steel Pokémon."},{"id":213,"names":"Comatose","description":"This Pokémon always  acts as though it were Asleep."},{"id":214,"names":"Queenly Majesty","description":"Opposing Pokémon cannot use priority attacks."},{"id":215,"names":"Innards Out","description":"When this Pokémon faints from an opponent's move, that opponent takes damage equal to the HP this Pokémon had remaining."},{"id":216,"names":"Dancer","description":"Whenever another Pokémon uses a dance move, this Pokémon will use the same move immediately afterwards."},{"id":217,"names":"Battery","description":"Ally Pokémon's moves have their power increased to 1.3×."},{"id":218,"names":"Fluffy","description":"Damage from contact moves is halved.  Damage from Fire moves is doubled."},{"id":219,"names":"Dazzling","description":"Opposing Pokémon cannot use priority attacks."},{"id":220,"names":"Soul-Heart","description":"This Pokémon's Special Attack rises by one stage every time any Pokémon faints."},{"id":221,"names":"Tangling Hair","description":"When this Pokémon takes regular damage from a contact move, the attacking Pokémon's Speed lowers by one stage."},{"id":222,"names":"Receiver","description":"When an ally faints, this Pokémon gains its Ability."},{"id":223,"names":"Power of Alchemy","description":"When an ally faints, this Pokémon gains its Ability."},{"id":224,"names":"Beast Boost","description":"Raises this Pokémon's highest stat by one stage when it faints another Pokémon."},{"id":225,"names":"RKS System","description":"Changes this Pokémon's type to match its held Memory."},{"id":226,"names":"Electric Surge","description":"When this Pokémon enters battle, it changes the terrain to Electric Terrain."},{"id":227,"names":"Psychic Surge","description":"When this Pokémon enters battle, it changes the terrain to Psychic Terrain."},{"id":228,"names":"Misty Surge","description":"When this Pokémon enters battle, it changes the terrain to Misty Terrain."},{"id":229,"names":"Grassy Surge","description":"When this Pokémon enters battle, it changes the terrain to Grassy Terrain."},{"id":230,"names":"Full Metal Body","description":"Other Pokémon cannot lower this Pokémon's stats."},{"id":231,"names":"Shadow Shield","description":"When this Pokémon has full HP, regular damage from moves is halved."},{"id":232,"names":"Prism Armor","description":"Reduces super-effective damage to 0.75×."},{"id":233,"names":"Neuroforce","description":"Increases super-effective damage dealt to 1.25×."},{"id":234,"names":"Intrepid Sword"},{"id":235,"names":"Dauntless Shield"},{"id":236,"names":"Libero"},{"id":237,"names":"Ball Fetch"},{"id":238,"names":"Cotton Down"},{"id":239,"names":"Propeller Tail"},{"id":240,"names":"Mirror Armor"},{"id":241,"names":"Gulp Missile"},{"id":242,"names":"Stalwart"},{"id":243,"names":"Steam Engine"},{"id":244,"names":"Punk Rock"},{"id":245,"names":"Sand Spit"},{"id":246,"names":"Ice Scales"},{"id":247,"names":"Ripen"},{"id":248,"names":"Ice Face"},{"id":249,"names":"Power Spot"},{"id":250,"names":"Mimicry"},{"id":251,"names":"Screen Cleaner"},{"id":252,"names":"Steely Spirit","description":"The power of Steel-type moves used by a Pokémon with Steely Spirit and its allies is increased by 50%."},{"id":253,"names":"Perish Body","description":"When the Pokémon with Perish Body is hit with a contact move, both the attacker and the Pokémon with Perish Body will faint in three turns"},{"id":254,"names":"Wandering Spirit"},{"id":255,"names":"Gorilla Tactics"},{"id":256,"names":"Neutralizing Gas"},{"id":257,"names":"Pastel Veil","description":"Prevents the Pokémon with this Ability and its allies from being afflicted by poison."},{"id":258,"names":"Hunger Switch"},{"id":259,"names":"Quick Draw"},{"id":260,"names":"Unseen Fist"},{"id":261,"names":"Curious Medicine","description":"When a Pokémon with this Ability enters the battle, stat stages of ally Pokémon are reset to 0."},{"id":262,"names":"Transistor"},{"id":263,"names":"Dragon’s Maw"},{"id":264,"names":"Chilling Neigh"},{"id":265,"names":"Grim Neigh"},{"id":266,"names":"As One"},{"id":267,"names":"As One"},{"id":268,"names":"Lingering Aroma"},{"id":269,"names":"Seed Sower"},{"id":270,"names":"Thermal Exchange"},{"id":271,"names":"Anger Shell"},{"id":272,"names":"Purifying Salt"},{"id":273,"names":"Well-Baked Body"},{"id":274,"names":"Wind Rider"},{"id":275,"names":"Guard Dog"},{"id":276,"names":"Rocky Payload"},{"id":277,"names":"Wind Power"},{"id":278,"names":"Zero to Hero"},{"id":279,"names":"Commander"},{"id":280,"names":"Electromorphosis"},{"id":281,"names":"Protosynthesis"},{"id":282,"names":"Quark Drive"},{"id":283,"names":"Good as Gold"},{"id":284,"names":"Vessel of Ruin"},{"id":285,"names":"Sword of Ruin"},{"id":286,"names":"Tablets of Ruin"},{"id":287,"names":"Beads of Ruin"},{"id":288,"names":"Orichalcum Pulse"},{"id":289,"names":"Hadron Engine"},{"id":290,"names":"Opportunist"},{"id":291,"names":"Cud Chew"},{"id":292,"names":"Sharpness"},{"id":293,"names":"Supreme Overlord"},{"id":294,"names":"Costar"},{"id":295,"names":"Toxic Debris"},{"id":296,"names":"Armor Tail"},{"id":297,"names":"Earth Eater"},{"id":298,"names":"Mycelium Might"},{"id":299,"names":"Mind’s Eye"},{"id":300,"names":"Supersweet Syrup"},{"id":301,"names":"Hospitality"},{"id":302,"names":"Toxic Chain"},{"id":303,"names":"Embody Aspect"},{"id":304,"names":"Tera Shift"},{"id":305,"names":"Tera Shell"},{"id":306,"names":"Teraform Zero"},{"id":307,"names":"Poison Puppeteer"},{"id":900,"names":"Soul Heart","description":"raises the user's Special Attack by one stage every time another Pokémon faints, which includes its allies and opponents."},{"id":10001,"names":"Mountaineer"},{"id":10002,"names":"Wave Rider"},{"id":10003,"names":"Skater"},{"id":10004,"names":"Thrust"},{"id":10005,"names":"Perception"},{"id":10006,"names":"Parry"},{"id":10007,"names":"Instinct"},{"id":10008,"names":"Dodge"},{"id":10009,"names":"Jagged Edge"},{"id":10010,"names":"Frostbite"},{"id":10011,"names":"Tenacity"},{"id":10012,"names":"Pride"},{"id":10013,"names":"Deep Sleep"},{"id":10014,"names":"Power Nap"},{"id":10015,"names":"Spirit"},{"id":10016,"names":"Warm Blanket"},{"id":10017,"names":"Gulp"},{"id":10018,"names":"Herbivore"},{"id":10019,"names":"Sandpit"},{"id":10020,"names":"Hot Blooded"},{"id":10021,"names":"Medic"},{"id":10022,"names":"Life Force"},{"id":10023,"names":"Lunchbox"},{"id":10024,"names":"Nurse"},{"id":10025,"names":"Melee"},{"id":10026,"names":"Sponge"},{"id":10027,"names":"Bodyguard"},{"id":10028,"names":"Hero"},{"id":10029,"names":"Last Bastion"},{"id":10030,"names":"Stealth"},{"id":10031,"names":"Vanguard"},{"id":10032,"names":"Nomad"},{"id":10033,"names":"Sequence"},{"id":10034,"names":"Grass Cloak"},{"id":10035,"names":"Celebrate"},{"id":10036,"names":"Lullaby"},{"id":10037,"names":"Calming"},{"id":10038,"names":"Daze"},{"id":10039,"names":"Frighten"},{"id":10040,"names":"Interference"},{"id":10041,"names":"Mood Maker"},{"id":10042,"names":"Confidence"},{"id":10043,"names":"Fortune"},{"id":10044,"names":"Bonanza"},{"id":10045,"names":"Explode"},{"id":10046,"names":"Omnipotent"},{"id":10047,"names":"Share"},{"id":10048,"names":"Black Hole"},{"id":10049,"names":"Shadow Dash"},{"id":10050,"names":"Sprint"},{"id":10051,"names":"Disgust"},{"id":10052,"names":"High-rise"},{"id":10053,"names":"Climber"},{"id":10054,"names":"Flame Boost"},{"id":10055,"names":"Aqua Boost"},{"id":10056,"names":"Run Up"},{"id":10057,"names":"Conqueror"},{"id":10058,"names":"Shackle"},{"id":10059,"names":"Decoy"},{"id":10060,"names":"Shield"}]`),Fw={id:37,name:"Huge Power",description:"Doubles the Pokemon's Attack stat.",onModifyAtk:(t,e)=>e*2},Nw={id:74,name:"Pure Power",description:"Doubles the Pokemon's Attack stat.",onModifyAtk:(t,e)=>e*2},Bw={id:55,name:"Hustle",description:"Boosts Attack by 50%, but lowers accuracy of physical moves.",onModifyAtk:(t,e)=>Math.floor(e*1.5)},$w={id:62,name:"Guts",description:"Boosts Attack by 50% when statused. Ignores burn Attack drop.",onModifyAtk:(t,e)=>t.pokemon.status?Math.floor(e*1.5):e},Lw={id:255,name:"Gorilla Tactics",description:"Boosts Attack by 50%, but only the first selected move can be used.",onModifyAtk:(t,e)=>Math.floor(e*1.5)},Hw={id:137,name:"Toxic Boost",description:"Boosts Attack by 50% when poisoned.",onModifyAtk:(t,e)=>{const r=t.pokemon.status;return r&&(r.abr==="PSN"||r.abr==="TOX")?Math.floor(e*1.5):e}},Vw={id:138,name:"Flare Boost",description:"Boosts Special Attack by 50% when burned.",onModifySpA:(t,e)=>t.pokemon.status?.abr==="BRN"?Math.floor(e*1.5):e},Ww={id:129,name:"Defeatist",description:"Halves Attack and Special Attack when HP is below 50%.",onModifyAtk:(t,e)=>t.pokemon.currentHp/t.pokemon.currentStats.hp<.5?Math.floor(e*.5):e,onModifySpA:(t,e)=>t.pokemon.currentHp/t.pokemon.currentStats.hp<.5?Math.floor(e*.5):e},jw={id:169,name:"Fur Coat",description:"Doubles the Pokemon's Defense stat.",onModifyDef:(t,e)=>e*2},Gw={id:63,name:"Marvel Scale",description:"Boosts Defense by 50% when statused.",onModifyDef:(t,e)=>t.pokemon.status?Math.floor(e*1.5):e},Uw={id:179,name:"Grass Pelt",description:"Boosts Defense by 50% on Grassy Terrain.",onModifyDef:(t,e)=>t.battleContext.battleField.terrain==="grassy"?Math.floor(e*1.5):e},Yw={id:248,name:"Ice Face",description:"Nullifies damage from a physical move, then changes form.",onModifyDef:(t,e)=>e},Xw={id:246,name:"Ice Scales",description:"Halves damage taken from special moves.",onSourceModifyDamage:(t,e)=>t.move?.category==="special"?Math.floor(e*.5):e},Kw={id:34,name:"Chlorophyll",description:"Doubles Speed in harsh sunlight.",onModifySpe:(t,e)=>t.battleContext.battleField.weather===k.SUN?e*2:e},qw={id:33,name:"Swift Swim",description:"Doubles Speed in rain.",onModifySpe:(t,e)=>t.battleContext.battleField.weather===k.RAIN?e*2:e},zw={id:146,name:"Sand Rush",description:"Doubles Speed in a sandstorm.",onModifySpe:(t,e)=>t.battleContext.battleField.weather===k.SAND?e*2:e},Jw={id:202,name:"Slush Rush",description:"Doubles Speed in hail or snow.",onModifySpe:(t,e)=>t.battleContext.battleField.weather===k.HAIL?e*2:e},Zw={id:95,name:"Quick Feet",description:"Boosts Speed by 50% when statused. Ignores paralysis Speed drop.",onModifySpe:(t,e)=>t.pokemon.status?Math.floor(e*1.5):e},Qw={id:84,name:"Unburden",description:"Doubles Speed when the held item is lost.",onModifySpe:(t,e)=>t.pokemon.heldItem?e:e*2},e0={id:207,name:"Surge Surfer",description:"Doubles Speed on Electric Terrain.",onModifySpe:(t,e)=>t.battleContext.battleField.terrain==="electric"?e*2:e},t0={id:94,name:"Solar Power",description:"Boosts Special Attack by 50% in harsh sunlight, but takes residual damage.",onModifySpA:(t,e)=>t.battleContext.battleField.weather===k.SUN?Math.floor(e*1.5):e},r0={id:262,name:"Transistor",description:"Powers up Electric-type moves by 50%.",onModifyAtk:(t,e)=>t.move?.type==="electric"?Math.floor(e*1.5):e,onModifySpA:(t,e)=>t.move?.type==="electric"?Math.floor(e*1.5):e},s0={id:263,name:"Dragon's Maw",description:"Powers up Dragon-type moves by 50%.",onModifyAtk:(t,e)=>t.move?.type==="dragon"?Math.floor(e*1.5):e,onModifySpA:(t,e)=>t.move?.type==="dragon"?Math.floor(e*1.5):e},n0={id:57,name:"Plus/Minus",description:"Boosts Special Attack by 50% if an ally has Plus or Minus.",onModifySpA:(t,e)=>e},a0={id:166,name:"Flower Veil",description:"Prevents stat lowering of Grass-type allies.",onModifySpD:(t,e)=>e},i0={id:47,name:"Thick Fat",description:"Halves damage from Fire and Ice-type moves.",onSourceModifyDamage:(t,e)=>t.move?.type==="fire"||t.move?.type==="ice"?Math.floor(e*.5):e},o0={id:199,name:"Water Bubble",description:"Halves Fire damage taken and doubles Water move power.",onSourceModifyDamage:(t,e)=>t.move?.type==="fire"?Math.floor(e*.5):e,onModifyDamage:(t,e)=>t.move?.type==="water"?e*2:e},l0={id:200,name:"Steelworker",description:"Powers up Steel-type moves by 50%.",onModifyDamage:(t,e)=>t.move?.type==="steel"?Math.floor(e*1.5):e},c0={id:85,name:"Heatproof",description:"Halves damage from Fire-type moves and burn damage.",onSourceModifyDamage:(t,e)=>t.move?.type==="fire"?Math.floor(e*.5):e},d0={id:97,name:"Sniper",description:"Powers up moves on critical hits. (1.5x -> 2.25x)",onModifyDamage:(t,e)=>t.pokemon.lastHitCritical?Math.floor(e*1.5):e},h0={id:91,name:"Adaptability",description:"Powers up moves of the same type as the Pokemon (STAB: 1.5x -> 2x).",onModifyDamage:(t,e)=>e},u0={id:198,name:"Stakeout",description:"Doubles damage on switching Pokemon.",onModifyDamage:(t,e)=>e},p0={id:148,name:"Analytic",description:"Boosts move power by 30% if the user moves last.",onModifyDamage:(t,e)=>e},f0={id:101,name:"Technician",description:"Powers up moves with base power of 60 or less by 50%.",onModifyDamage:(t,e)=>t.move&&t.move.power<=60?Math.floor(e*1.5):e},m0={id:89,name:"Iron Fist",description:"Powers up punching moves by 20%.",onModifyDamage:(t,e)=>e},g0={id:173,name:"Strong Jaw",description:"Powers up biting moves by 50%.",onModifyDamage:(t,e)=>e},w0={id:178,name:"Mega Launcher",description:"Powers up aura and pulse moves by 50%.",onModifyDamage:(t,e)=>e},v0={id:120,name:"Reckless",description:"Powers up recoil moves by 20%.",onModifyDamage:(t,e)=>e},_0={id:125,name:"Sheer Force",description:"Powers up moves with secondary effects by 30%, but removes the effects.",onModifyDamage:(t,e)=>e},y0={id:181,name:"Tough Claws",description:"Powers up contact moves by 30%.",onModifyDamage:(t,e)=>e},b0={id:244,name:"Punk Rock",description:"Powers up sound moves by 30% and halves sound damage taken.",onModifyDamage:(t,e)=>e},S0={id:252,name:"Steely Spirit",description:"Powers up Steel-type moves of allies by 50%.",onModifyDamage:(t,e)=>e},E0={id:159,name:"Sand Force",description:"Boosts Rock, Ground, and Steel moves by 30% in sandstorm.",onModifyDamage:(t,e)=>t.battleContext.battleField.weather===k.SAND&&(t.move?.type==="rock"||t.move?.type==="ground"||t.move?.type==="steel")?Math.floor(e*1.3):e},O0={id:122,name:"Flower Gift",description:"Boosts Attack and Sp. Def of self and allies in sun.",onModifyAtk:(t,e)=>t.battleContext.battleField.weather===k.SUN?Math.floor(e*1.5):e,onModifySpD:(t,e)=>t.battleContext.battleField.weather===k.SUN?Math.floor(e*1.5):e},P0={id:162,name:"Victory Star",description:"Boosts accuracy of self and allies by 10%.",onModifyAtk:(t,e)=>e},k0={id:79,name:"Rivalry",description:"Deals more damage to same-gender foes, less to opposite.",onModifyDamage:(t,e)=>e},A0={id:142,name:"Overcoat",description:"Protects against damage from weather."},M0=[Fw,Nw,Bw,$w,Lw,Hw,Vw,Ww,jw,Gw,Uw,Yw,Xw,Kw,qw,zw,Jw,Zw,Qw,e0,t0,r0,s0,n0,a0,i0,o0,l0,c0,d0,h0,u0,p0,f0,m0,g0,w0,v0,_0,y0,b0,S0,E0,O0,P0,k0,A0],C0={id:22,name:"Intimidate",description:"Lowers opposing Pokemon's Attack by one stage when it enters battle.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(r=>!!r&&!r.fainted);for(const r of e)r.changeBattleStats("attack",-1),t.battleContext.addToStack(new Sw(r,"attack",-1,t.pokemon)),t.battleContext.addToStack(new I(`${r.name}'s Attack fell!`,t.pokemon));return!0}},I0={id:2,name:"Drizzle",description:"Summons rain when entering battle.",onSwitchIn:t=>(Ce(t.battleContext.battleField,k.RAIN,5,t.pokemon),t.battleContext.addToStack(new Ie(k.RAIN,t.pokemon)),t.battleContext.addToStack(new I("It started to rain!",t.pokemon)),!0)},T0={id:70,name:"Drought",description:"Summons harsh sunlight when entering battle.",onSwitchIn:t=>(Ce(t.battleContext.battleField,k.SUN,5,t.pokemon),t.battleContext.addToStack(new Ie(k.SUN,t.pokemon)),t.battleContext.addToStack(new I("The sunlight turned harsh!",t.pokemon)),!0)},D0={id:45,name:"Sand Stream",description:"Summons a sandstorm when entering battle.",onSwitchIn:t=>(Ce(t.battleContext.battleField,k.SAND,5,t.pokemon),t.battleContext.addToStack(new Ie(k.SAND,t.pokemon)),t.battleContext.addToStack(new I("A sandstorm kicked up!",t.pokemon)),!0)},x0={id:117,name:"Snow Warning",description:"Summons hail when entering battle.",onSwitchIn:t=>(Ce(t.battleContext.battleField,k.HAIL,5,t.pokemon),t.battleContext.addToStack(new Ie(k.HAIL,t.pokemon)),t.battleContext.addToStack(new I("It started to hail!",t.pokemon)),!0)},R0={id:189,name:"Primordial Sea",description:"Summons heavy rain that cannot be replaced.",onSwitchIn:t=>(Ce(t.battleContext.battleField,k.RAIN,5,t.pokemon),t.battleContext.addToStack(new Ie(k.RAIN,t.pokemon)),t.battleContext.addToStack(new I("A heavy rain began to fall!",t.pokemon)),!0)},F0={id:190,name:"Desolate Land",description:"Summons extremely harsh sunlight that cannot be replaced.",onSwitchIn:t=>(Ce(t.battleContext.battleField,k.SUN,5,t.pokemon),t.battleContext.addToStack(new Ie(k.SUN,t.pokemon)),t.battleContext.addToStack(new I("The sunlight turned extremely harsh!",t.pokemon)),!0)},N0={id:191,name:"Delta Stream",description:"Summons strong winds that weaken Flying-type weaknesses.",onSwitchIn:t=>(t.battleContext.battleField.setWeather(k.STRONG_WINDS,0),t.battleContext.addToStack(new I("A mysterious air current is protecting Flying-type Pokemon!",t.pokemon)),!0)},B0={id:226,name:"Electric Surge",description:"Summons Electric Terrain when entering battle.",onSwitchIn:t=>(t.battleContext.battleField.setTerrain(we.ELECTRIC),t.battleContext.addToStack(new I("An electric current ran across the battlefield!",t.pokemon)),!0)},$0={id:229,name:"Grassy Surge",description:"Summons Grassy Terrain when entering battle.",onSwitchIn:t=>(t.battleContext.battleField.setTerrain(we.GRASSY),t.battleContext.addToStack(new I("Grass grew to cover the battlefield!",t.pokemon)),!0)},L0={id:227,name:"Psychic Surge",description:"Summons Psychic Terrain when entering battle.",onSwitchIn:t=>(t.battleContext.battleField.setTerrain(we.PSYCHIC),t.battleContext.addToStack(new I("The battlefield got weird!",t.pokemon)),!0)},H0={id:228,name:"Misty Surge",description:"Summons Misty Terrain when entering battle.",onSwitchIn:t=>(t.battleContext.battleField.setTerrain(we.MISTY),t.battleContext.addToStack(new I("Mist swirled around the battlefield!",t.pokemon)),!0)},V0={id:88,name:"Download",description:"Boosts Attack or Sp. Atk based on opposing Pokemon's weaker defense.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(s=>!!s&&!s.fainted);if(e.length===0)return;let r=0,n=0;for(const s of e)r+=s.battleStats.defense,n+=s.battleStats.specialDefense;return r<n?t.pokemon.changeBattleStats("attack",1):t.pokemon.changeBattleStats("specialAttack",1),!0}},W0={id:264,name:"Intrepid Sword",description:"Boosts Attack by one stage when entering battle.",onSwitchIn:t=>(t.pokemon.changeBattleStats("attack",1),!0)},j0={id:265,name:"Dauntless Shield",description:"Boosts Defense by one stage when entering battle.",onSwitchIn:t=>(t.pokemon.changeBattleStats("defense",1),!0)},G0={id:127,name:"Unnerve",description:"Prevents opposing Pokemon from using held Berries.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(r=>!!r&&!r.fainted);for(const r of e)r.volatiles.add(ae.UNNERVED);return!0}},U0={id:119,name:"Frisk",description:"Reveals an opposing Pokemon's held item on switch-in.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(n=>!!n&&!n.fainted);let r=!1;for(const n of e)n.heldItem&&(t.battleContext.addToStack(new I(`${t.pokemon.name} frisked ${n.name} and found its ${n.heldItem.name}!`,t.pokemon)),r=!0);if(r)return!0}},Y0={id:107,name:"Anticipation",description:"Shudders when entering if any opponent has a super-effective or OHKO move.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(n=>!!n&&!n.fainted),r=["guillotine","horn-drill","fissure","sheer-cold"];for(const n of e)for(const s of n.moves){if(r.includes(s.name.toLowerCase()))return t.battleContext.addToStack(new I(`${t.pokemon.name} shuddered!`,t.pokemon)),!0;if(t.battleContext.calculateTypeEffectiveness(s.type,t.pokemon.types)>1)return t.battleContext.addToStack(new I(`${t.pokemon.name} shuddered!`,t.pokemon)),!0}}},X0={id:108,name:"Forewarn",description:"Reveals the opponent's strongest move on switch-in.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(n=>!!n&&!n.fainted);let r;for(const n of e)for(const s of n.moves)s.power>0&&(!r||s.power>r.power)&&(r={move:s.name,power:s.power});if(r)return t.battleContext.addToStack(new I(`${t.pokemon.name}'s Forewarn alerted it to ${r.move}!`,t.pokemon)),!0}},K0={id:76,name:"Air Lock",description:"Negates all weather effects.",onSwitchIn:t=>(t.battleContext.battleField.setWeather(k.NONE),t.battleContext.addToStack(new Ie(k.NONE,t.pokemon)),!0)},q0={id:13,name:"Cloud Nine",description:"Negates all weather effects.",onSwitchIn:t=>(t.battleContext.battleField.setWeather(k.NONE),t.battleContext.addToStack(new Ie(k.NONE,t.pokemon)),!0)},z0={id:46,name:"Pressure",description:"Raises the opponent's PP usage.",onSwitchIn:t=>(t.battleContext.addToStack(new I(`${t.pokemon.name} is exerting its Pressure!`,t.pokemon)),!0)},J0={id:251,name:"Screen Cleaner",description:"Removes Light Screen and Reflect from both sides on switch-in.",onSwitchIn:t=>(t.battleContext.battleField.allySide.screens.clear(),t.battleContext.battleField.enemySide.screens.clear(),!0)},Z0={id:267,name:"As One (Ice)",description:"Combines Unnerve and Chilling Neigh.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(r=>!!r&&!r.fainted);for(const r of e)r.volatiles.add(ae.UNNERVED);return!0}},Q0={id:268,name:"As One (Shadow)",description:"Combines Unnerve and Grim Neigh.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(r=>!!r&&!r.fainted);for(const r of e)r.volatiles.add(ae.UNNERVED);return!0}},ev={id:261,name:"Curious Medicine",description:"Resets allies' stat changes on switch-in.",onSwitchIn:t=>{const e=t.battleContext.playerSide.filter(r=>!!r&&!r.fainted&&r!==t.pokemon);for(const r of e)r.resetBattleStats()}},tv={id:257,name:"Pastel Veil",description:"Cures allies of Poison on switch-in and prevents Poison.",onSwitchIn:t=>{const e=t.battleContext.playerSide.filter(r=>!!r&&!r.fainted);for(const r of e)(r.status?.abr==="PSN"||r.status?.abr==="TOX")&&(r.status=void 0)},onStatus:(t,e)=>!(e==="PSN"||e==="TOX")},rv={id:187,name:"Fairy Aura",description:"Boosts Fairy-type moves for all Pokemon on the field.",onSwitchIn:t=>(t.battleContext.addToStack(new I(`${t.pokemon.name}'s Fairy Aura is radiating!`,t.pokemon)),!0),onModifyDamage:(t,e)=>{if(!t.move||t.move.type!=="fairy")return e;const s=[...t.battleContext.playerSide.filter(a=>!!a&&!a.fainted),...t.battleContext.oppSide.filter(a=>!!a&&!a.fainted)].some(a=>a.currentAbility==="Aura Break")?.75:1.33;return Math.floor(e*s)}},sv={id:186,name:"Dark Aura",description:"Boosts Dark-type moves for all Pokemon on the field.",onSwitchIn:t=>(t.battleContext.addToStack(new I(`${t.pokemon.name}'s Dark Aura is radiating!`,t.pokemon)),!0),onModifyDamage:(t,e)=>{if(!t.move||t.move.type!=="dark")return e;const s=[...t.battleContext.playerSide.filter(a=>!!a&&!a.fainted),...t.battleContext.oppSide.filter(a=>!!a&&!a.fainted)].some(a=>a.currentAbility==="Aura Break")?.75:1.33;return Math.floor(e*s)}},nv={id:188,name:"Aura Break",description:"Reverses the effects of Fairy Aura and Dark Aura.",onSwitchIn:t=>(t.battleContext.addToStack(new I(`${t.pokemon.name} broke the mold with Aura Break!`,t.pokemon)),!0)},av=[C0,I0,T0,D0,x0,R0,F0,N0,B0,$0,L0,H0,V0,W0,j0,G0,U0,Y0,X0,K0,q0,z0,J0,Z0,Q0,ev,tv,rv,sv,nv];function ko(){return{abr:"PAR",move_effect_id:7,duration:-1}}function iv(){return{abr:"BRN",move_effect_id:5,duration:-1}}function Ao(){return{abr:"PSN",move_effect_id:3,duration:-1}}const ov={id:24,name:"Rough Skin",description:"Inflicts damage to the attacker on contact.",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target){const r=Math.max(1,Math.floor(t.target.currentStats.hp/8));return t.target.currentHp=Math.max(0,t.target.currentHp-r),!0}}},lv={id:160,name:"Iron Barbs",description:"Inflicts damage to the attacker on contact.",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target){const r=Math.max(1,Math.floor(t.target.currentStats.hp/8));return t.target.currentHp=Math.max(0,t.target.currentHp-r),!0}}},cv={id:9,name:"Static",description:"May paralyze the attacker on contact (30% chance).",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target&&!t.target.status&&Math.random()<.3)return t.target.status=ko(),!0}},dv={id:49,name:"Flame Body",description:"May burn the attacker on contact (30% chance).",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target&&!t.target.status&&Math.random()<.3)return t.target.status=iv(),!0}},hv={id:38,name:"Poison Point",description:"May poison the attacker on contact (30% chance).",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target&&!t.target.status&&Math.random()<.3)return t.target.status=Ao(),!0}},uv={id:56,name:"Cute Charm",description:"May cause infatuation on contact (30% chance).",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target&&Math.random()<.3)return t.target.volatiles.add(ae.INFATUATION,0),!0}},pv={id:27,name:"Effect Spore",description:"May inflict poison, paralysis, or sleep on contact (10% each).",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target&&!t.target.status){const r=Math.random();if(r<.1)return t.target.status=Ao(),!0;if(r<.2)return t.target.status=ko(),!0;if(r<.3)return t.target.status={abr:"SLP",move_effect_id:2,duration:-1},!0}}},fv={id:26,name:"Levitate",description:"Gives immunity to Ground-type moves.",onTryHit:t=>t.move?.type?.toLowerCase()!=="ground"},mv={id:11,name:"Water Absorb",description:"Restores HP if hit by a Water-type move.",onTryHit:t=>{if(t.move?.type?.toLowerCase()==="water"){const e=Math.floor(t.pokemon.currentStats.hp/4);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+e,t.pokemon.currentStats.hp),!1}return!0}},gv={id:10,name:"Volt Absorb",description:"Restores HP if hit by an Electric-type move.",onTryHit:t=>{if(t.move?.type?.toLowerCase()==="electric"){const e=Math.floor(t.pokemon.currentStats.hp/4);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+e,t.pokemon.currentStats.hp),!1}return!0}};let Ji=!1;const wv={id:18,name:"Flash Fire",description:"Powers up Fire-type moves if hit by one. Grants immunity to Fire.",onTryHit:t=>t.move?.type?.toLowerCase()==="fire"?(Ji=!0,!1):!0,onModifyDamage:(t,e)=>Ji&&t.move?.type?.toLowerCase()==="fire"?Math.floor(e*1.5):e},vv={id:157,name:"Sap Sipper",description:"Boosts Attack when hit by Grass-type moves. Grants immunity.",onTryHit:t=>t.move?.type?.toLowerCase()==="grass"?(t.pokemon.changeBattleStats("attack",1),!1):!0},_v={id:78,name:"Motor Drive",description:"Boosts Speed when hit by Electric-type moves. Grants immunity.",onTryHit:t=>t.move?.type?.toLowerCase()==="electric"?(t.pokemon.changeBattleStats("speed",1),!1):!0},yv={id:31,name:"Lightning Rod",description:"Draws Electric moves. Boosts Special Attack when hit.",onTryHit:t=>t.move?.type?.toLowerCase()==="electric"?(t.pokemon.changeBattleStats("specialAttack",1),!1):!0},bv={id:114,name:"Storm Drain",description:"Draws Water moves. Boosts Special Attack when hit.",onTryHit:t=>t.move?.type?.toLowerCase()==="water"?(t.pokemon.changeBattleStats("specialAttack",1),!1):!0},Sv={id:25,name:"Wonder Guard",description:"Only super-effective moves can hit.",onTryHit:t=>!0},Ev={id:43,name:"Soundproof",description:"Gives immunity to sound-based moves.",onTryHit:t=>!0},Ov={id:171,name:"Bulletproof",description:"Gives immunity to ball and bomb moves.",onTryHit:t=>!0},Pv={id:142,name:"Overcoat",description:"Protects from weather damage and powder moves.",onTryHit:t=>!0},kv=[ov,lv,cv,dv,hv,uv,pv,fv,mv,gv,wv,vv,_v,yv,bv,Sv,Ev,Ov,Pv],Av={id:3,name:"Speed Boost",description:"Raises Speed at the end of each turn.",onTurnEnd:t=>(t.pokemon.changeBattleStats("speed",1),!0)},Mv={id:141,name:"Moody",description:"Raises one stat by 2 and lowers another by 1 at the end of each turn.",onTurnEnd:t=>{const e=["attack","defense","specialAttack","specialDefense","speed"],r=e[Math.floor(Math.random()*e.length)],n=e.filter(a=>a!==r),s=n[Math.floor(Math.random()*n.length)];return t.pokemon.changeBattleStats(r,2),t.pokemon.changeBattleStats(s,-1),!0}},Cv={id:90,name:"Poison Heal",description:"Heals 1/8 max HP when poisoned instead of taking damage.",onTurnEnd:t=>{const e=t.pokemon.status;if(e&&(e.abr==="PSN"||e.abr==="TOX")){const r=Math.floor(t.pokemon.currentStats.hp/8);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+r,t.pokemon.currentStats.hp),!0}}},Iv={id:44,name:"Rain Dish",description:"Heals 1/16 max HP in rain.",onTurnEnd:t=>{if(t.battleContext.battleField.weather===k.RAIN){const e=Math.floor(t.pokemon.currentStats.hp/16);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+e,t.pokemon.currentStats.hp),!0}}},Tv={id:115,name:"Ice Body",description:"Heals 1/16 max HP in hail or snow.",onTurnEnd:t=>{if(t.battleContext.battleField.weather===k.HAIL){const e=Math.floor(t.pokemon.currentStats.hp/16);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+e,t.pokemon.currentStats.hp),!0}}},Dv={id:87,name:"Dry Skin",description:"Heals from Water moves; takes extra Fire damage. Heals in rain; hurt by sun.",onTryHit:t=>{if(t.move?.type?.toLowerCase()==="water"){const e=Math.floor(t.pokemon.currentStats.hp/4);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+e,t.pokemon.currentStats.hp),!1}return!0},onSourceModifyDamage:(t,e)=>t.move?.type?.toLowerCase()==="fire"?Math.floor(e*1.25):e,onTurnEnd:t=>{const e=t.battleContext.battleField.weather;if(e===k.RAIN){const r=Math.floor(t.pokemon.currentStats.hp/8);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+r,t.pokemon.currentStats.hp),!0}else if(e===k.SUN){const r=Math.floor(t.pokemon.currentStats.hp/8);return t.pokemon.currentHp=Math.max(t.pokemon.currentHp-r,0),!0}}},xv={id:61,name:"Shed Skin",description:"30% chance to cure status condition at the end of each turn.",onTurnEnd:t=>{if(t.pokemon.status&&Math.random()<.3)return t.pokemon.status=void 0,!0}},Rv={id:93,name:"Hydration",description:"Cures status conditions in rain.",onTurnEnd:t=>{if(t.battleContext.battleField.weather===k.RAIN&&t.pokemon.status)return t.pokemon.status=void 0,!0}},Fv={id:131,name:"Healer",description:"30% chance to cure adjacent ally status at turn end.",onTurnEnd:t=>{const r=t.battleContext.playerSide.filter(n=>!!n&&!n.fainted&&n!==t.pokemon).filter(n=>!!n.status);if(r.length>0&&Math.random()<.3){const n=r[Math.floor(Math.random()*r.length)];return n.status=void 0,t.battleContext.addToStack(new I(`${t.pokemon.name}'s Healer cured ${n.name}'s status!`,t.pokemon)),!0}}},Nv={id:123,name:"Bad Dreams",description:"Damages sleeping foes 1/8 max HP at turn end.",onTurnEnd:t=>{const e=[...t.battleContext.oppSide].filter(n=>!!n&&!n.fainted);let r=!1;if(e.forEach(n=>{if(n.status?.abr==="SLP"){const s=Math.floor(n.currentStats.hp/8);n.currentHp=Math.max(n.currentHp-s,0),r=!0}}),r)return!0}},Bv={id:112,name:"Slow Start",description:"Halves Attack and Speed for 5 turns after entering battle.",onSwitchIn:t=>(t.pokemon.volatiles.add(ae.SLOW_START,5),!0),onTurnEnd:t=>{if(t.pokemon.volatiles.has(ae.SLOW_START)){const e=t.pokemon.volatiles.getTurns(ae.SLOW_START);if(e>0)t.pokemon.volatiles.setTurns(ae.SLOW_START,e-1);else return t.pokemon.volatiles.remove(ae.SLOW_START),!0}},onModifyAtk:(t,e)=>t.pokemon.volatiles.has(ae.SLOW_START)?Math.floor(e/2):e,onModifySpe:(t,e)=>t.pokemon.volatiles.has(ae.SLOW_START)?Math.floor(e/2):e},$v={id:54,name:"Truant",description:"Can only use a move every other turn; loafs around otherwise.",onSwitchIn:t=>(t.pokemon.volatiles.remove(ae.TRUANT),!0),onBeforeMove:t=>t.pokemon.volatiles.has(ae.TRUANT)?(t.pokemon.volatiles.remove(ae.TRUANT),!1):(t.pokemon.volatiles.add(ae.TRUANT,0),!0)},Lv={id:100,name:"Stall",description:"Always moves last.",priority:-6},Hv={id:17,name:"Immunity",description:"Prevents the pokemon from being poisoned.",onStatus:(t,e)=>!(e==="PSN"||e==="TOX")},Vv={id:7,name:"Limber",description:"Prevents the pokemon from being paralyzed.",onStatus:(t,e)=>e!=="PAR"},Wv={id:15,name:"Insomnia",description:"Prevents the pokemon from falling asleep.",onStatus:(t,e)=>e!=="SLP"},jv={id:72,name:"Vital Spirit",description:"Prevents the pokemon from falling asleep.",onStatus:(t,e)=>e!=="SLP"},Gv={id:12,name:"Oblivious",description:"Prevents Infatuation and Taunt.",onStatus:(t,e)=>!(e==="infatuation"||e==="taunt")},Uv={id:20,name:"Own Tempo",description:"Prevents the pokemon from becoming confused.",onStatus:(t,e)=>e!=="confused"},Yv={id:40,name:"Magma Armor",description:"Prevents the pokemon from being frozen.",onStatus:(t,e)=>e!=="FRZ"},Xv={id:41,name:"Water Veil",description:"Prevents the pokemon from being burned.",onStatus:(t,e)=>e!=="BRN"},Kv={id:102,name:"Leaf Guard",description:"Prevents status conditions during harsh sunlight.",onStatus:(t,e)=>t.battleContext.battleField.weather!==k.SUN},qv={id:213,name:"Comatose",description:"Always considered asleep but can still attack. Immune to status.",onStatus:(t,e)=>!1},zv={id:175,name:"Sweet Veil",description:"Prevents the pokemon and allies from falling asleep.",onStatus:(t,e)=>e!=="SLP"},Jv={id:165,name:"Aroma Veil",description:"Protects allies from attacks that limit move choices.",onStatus:(t,e)=>!["taunt","encore","torment","disable","heal_block"].includes(e)},Zv={id:28,name:"Synchronize",description:"Passes poison, paralysis, or burn to the pokemon that caused it.",onStatus:(t,e)=>(t.target&&!t.target.status&&(e==="PSN"||e==="PAR"||e==="BRN")&&(t.target.status={abr:e}),!0)},Qv={id:177,name:"Gale Wings",description:"Gives +1 priority to Flying-type moves when at full HP.",priority:1},e_={id:205,name:"Triage",description:"Gives +3 priority to healing moves.",priority:3},t_={id:139,name:"Harvest",description:"50% chance to restore used Berry at turn end (100% in sun).",onTurnEnd:t=>{t.battleContext.battleField.weather,k.SUN}},r_={id:53,name:"Pickup",description:"May pick up items after battle."},s_={id:106,name:"Aftermath",description:"Deals 1/4 max HP damage to attacker if KOed by contact move.",onFaint:t=>{if(t.target&&t.move?.category==="physical"){const e=Math.floor(t.pokemon.currentStats.hp/4);return t.target.currentHp=Math.max(t.target.currentHp-e,0),!0}}},n_={id:215,name:"Innards Out",description:"Deals damage equal to HP before fainting to attacker.",onFaint:t=>{if(t.target){const e=Math.floor(t.pokemon.currentStats.hp/4);return t.target.currentHp=Math.max(t.target.currentHp-e,0),!0}}},a_=[Av,Mv,Cv,Iv,Tv,Dv,xv,Rv,Fv,Nv,Bv,$v,Lv,Hv,Vv,Wv,jv,Gv,Uv,Yv,Xv,Kv,qv,zv,Jv,Zv,Qv,e_,t_,r_,s_,n_],be=["mold-breaker","teravolt","turboblaze"],i_=["trace","forecast","flower-gift","zen-mode","illusion","imposter","stance-change","power-of-alchemy","receiver","schooling","comatose","shields-down","disguise","battle-bond","power-construct","rks-system","gulp-missile","ice-face","hunger-switch","as-one","neutralizing-gas"],o_=["explosion","self-destruct","misty-explosion"];function Mo(t){return t?t.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):""}function Kt(t){return i_.includes(Mo(t))}const l_={id:104,name:"Mold Breaker",description:"Ignores the target's Ability when attacking.",onSwitchIn:t=>{}},c_={id:164,name:"Teravolt",description:"Ignores the target's Ability when attacking.",onSwitchIn:t=>{}},d_={id:163,name:"Turboblaze",description:"Ignores the target's Ability when attacking.",onSwitchIn:t=>{}},h_={id:256,name:"Neutralizing Gas",description:"All other Abilities are suppressed while this Pokemon is on the field.",onSwitchIn:t=>(t.battleContext.battleField.neutralizingGasActive=!0,!0),onSwitchOut:t=>(t.battleContext.battleField.neutralizingGasActive=!1,!0)},u_={id:152,name:"Mummy",description:"Contact changes the attacker's Ability to Mummy.",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target)return t.target.currentAbility="Mummy",!0},suppressedBy:be},p_={id:298,name:"Lingering Aroma",description:"Contact changes the attacker's Ability to Lingering Aroma.",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target)return t.target.currentAbility="Lingering Aroma",!0},suppressedBy:be},f_={id:254,name:"Wandering Spirit",description:"Swaps Ability with the attacker on contact.",onDamagingHit:(t,e)=>{if(t.move?.category==="physical"&&t.target){const r=t.target.currentAbility,n=t.pokemon.currentAbility;if(r&&n&&!Kt(r))return t.target.currentAbility=n,t.pokemon.currentAbility=r,!0}},suppressedBy:be},m_={id:36,name:"Trace",description:"Copies a random opposing Pokemon's Ability on switch-in.",onSwitchIn:t=>{const e=t.battleContext.oppSide.filter(n=>!!n&&!n.fainted);if(e.length===0)return;const r=e.filter(n=>n.currentAbility&&!Kt(n.currentAbility));if(r.length>0){const n=r[Math.floor(Math.random()*r.length)];return t.pokemon.currentAbility=n.currentAbility,!0}}},g_={id:222,name:"Receiver",description:"Copies a fainted ally's Ability.",onFaint:t=>{const e=t.battleContext.faintedAlly;if(e&&e.currentAbility&&!Kt(e.currentAbility))return t.pokemon.currentAbility=e.currentAbility,!0}},w_={id:223,name:"Power of Alchemy",description:"Copies a fainted ally's Ability.",onFaint:t=>{const e=t.battleContext.faintedAlly;if(e&&e.currentAbility&&!Kt(e.currentAbility))return t.pokemon.currentAbility=e.currentAbility,!0}},v_={id:6,name:"Damp",description:"Prevents Explosion, Self-Destruct, and Aftermath.",onTryHit:t=>{if(t.move){const e=Mo(t.move.name);if(o_.includes(e))return!1}return!0},suppressedBy:be},__={id:212,name:"Corrosion",description:"Can poison Steel and Poison-type Pokemon."},y_={id:299,name:"Mycelium Might",description:"Status moves always go last but ignore target Abilities.",onBeforeMove:t=>!0},b_={id:260,name:"Unseen Fist",description:"Contact moves bypass Protect-like moves."},S_={id:302,name:"Mind's Eye",description:"Ignores evasion and hits Ghost-types with Normal/Fighting moves."},E_={id:113,name:"Scrappy",description:"Normal and Fighting moves can hit Ghost-types."},O_={id:296,name:"Armor Tail",description:"Opponent cannot use priority moves.",suppressedBy:be},P_={id:214,name:"Queenly Majesty",description:"Opponent cannot use priority moves.",suppressedBy:be},k_={id:219,name:"Dazzling",description:"Opponent cannot use priority moves.",suppressedBy:be},A_={id:39,name:"Inner Focus",description:"Prevents flinching and Intimidate."},M_={id:155,name:"Rattled",description:"Boosts Speed when hit by Bug, Dark, or Ghost moves, or Intimidated.",onStatChange:(t,e,r)=>(e==="attack"&&r<0&&t.pokemon.changeBattleStats("speed",1),r)},C_={id:174,name:"Competitive",description:"Boosts Sp. Atk by 2 stages when any stat is lowered.",onStatChange:(t,e,r)=>(r<0&&t.pokemon.changeBattleStats("specialAttack",2),r)},I_={id:128,name:"Defiant",description:"Boosts Attack by 2 stages when any stat is lowered.",onStatChange:(t,e,r)=>(r<0&&t.pokemon.changeBattleStats("attack",2),r)},T_={id:240,name:"Mirror Armor",description:"Reflects stat-lowering effects back to the attacker.",onStatChange:(t,e,r)=>r<0&&t.target?(t.target.changeBattleStats(e,r),0):r,suppressedBy:be},D_={id:29,name:"Clear Body",description:"Prevents stat reduction by other Pokemon.",onStatChange:(t,e,r)=>r<0?0:r,suppressedBy:be},x_={id:73,name:"White Smoke",description:"Prevents stat reduction by other Pokemon.",onStatChange:(t,e,r)=>r<0?0:r,suppressedBy:be},R_={id:230,name:"Full Metal Body",description:"Prevents stat reduction by other Pokemon (cannot be suppressed).",onStatChange:(t,e,r)=>r<0?0:r},F_=[l_,c_,d_,h_,u_,p_,f_,m_,g_,w_,v_,__,y_,b_,S_,E_,O_,P_,k_,A_,M_,C_,I_,T_,D_,x_,R_],Te=["mold-breaker","teravolt","turboblaze"],Zi=6,Qi=-6,N_={id:126,name:"Contrary",description:"Makes stat changes have an opposite effect.",onStatChange:(t,e,r)=>r===0?0:-r,suppressedBy:Te},B_={id:86,name:"Simple",description:"Doubles the effect of stat changes.",onStatChange:(t,e,r)=>{const n=r*2;return n>Zi?Zi:n<Qi?Qi:n},suppressedBy:Te},$_={id:109,name:"Unaware",description:"Ignores stat changes of the opposing Pokemon when dealing or receiving damage.",suppressedBy:Te},L_={id:144,name:"Regenerator",description:"Restores 1/3 of max HP upon switching out.",onSwitchOut:t=>{const e=t.pokemon.currentStats.hp,r=Math.floor(e/3);return t.pokemon.currentHp=Math.min(t.pokemon.currentHp+r,e),!0}},H_={id:30,name:"Natural Cure",description:"All status conditions are healed upon switching out.",onSwitchOut:t=>(t.pokemon.status=void 0,!0)},V_=30,W_=new Set(["all-opponents","all-other-pokemon","all-pokemon","user-and-allies"]),j_={id:185,name:"Parental Bond",description:"Attacks twice. The second hit deals 25% damage.",onModifyDamage:(t,e)=>{const r=t.move;return!r||r.effect?.move_effect_id===V_||W_.has(r.target)?e:Math.floor(e*1.25)}},G_={id:92,name:"Skill Link",description:"Multi-hit moves always hit 5 times."},U_={id:209,name:"Disguise",description:"The shroud that covers the Pokemon can protect it from an attack once.",onDamagingHit:(t,e)=>{if(!t.pokemon.disguiseBroken)return t.pokemon.disguiseBroken=!0,!0},suppressedBy:Te},Y_={id:176,name:"Stance Change",description:"Changes between Blade and Shield Forme based on moves used."},X_={id:161,name:"Zen Mode",description:"Changes to Zen Mode when HP drops below half."},K_={id:210,name:"Battle Bond",description:"Transforms into Ash-Greninja after defeating an opposing Pokemon."},q_={id:197,name:"Shields Down",description:"Changes form when HP drops below half."},z_={id:208,name:"Schooling",description:"Changes to School Form if level 20+ and HP above 25%."},J_={id:211,name:"Power Construct",description:"Changes to Complete Forme when HP drops below half."},Z_={id:98,name:"Magic Guard",description:"Only takes damage from attacks."},Q_={id:156,name:"Magic Bounce",description:"Reflects status moves back at the user.",suppressedBy:Te},e1={id:158,name:"Prankster",description:"Gives priority to status moves.",priority:1},t1={id:151,name:"Infiltrator",description:"Ignores screens, Substitute, Mist, and Safeguard."},r1={id:136,name:"Multiscale",description:"Halves damage when at full HP.",onSourceModifyDamage:(t,e)=>t.pokemon.currentHp===t.pokemon.currentStats.hp?Math.floor(e/2):e,suppressedBy:Te},s1={id:231,name:"Shadow Shield",description:"Halves damage when at full HP (cannot be suppressed).",onSourceModifyDamage:(t,e)=>t.pokemon.currentHp===t.pokemon.currentStats.hp?Math.floor(e/2):e},n1={id:232,name:"Prism Armor",description:"Reduces super-effective damage."},a1={id:116,name:"Solid Rock",description:"Reduces super-effective damage by 25%.",suppressedBy:Te},i1={id:111,name:"Filter",description:"Reduces super-effective damage by 25%.",suppressedBy:Te},o1={id:110,name:"Tinted Lens",description:"Not very effective moves deal double damage."},l1={id:233,name:"Neuroforce",description:"Powers up super-effective moves by 25%."},c1=[N_,B_,$_,L_,H_,j_,G_,U_,Y_,X_,K_,q_,z_,J_,Z_,Q_,e1,t1,r1,s1,n1,a1,i1,o1,l1],je={};function gi(t){return t?t.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):""}function d1(){Rw.forEach(e=>{const r=gi(e.names);je[r]={id:e.id,name:e.names,description:e.description}});const t=[...M0,...av,...kv,...a_,...F_,...c1];for(const e of t){const r=gi(e.name);je[r]?je[r]={...je[r],...e}:je[r]=e}}d1();function h1(t){if(!t)return;const e=gi(t),r=je[e];return r||console.warn(`Unknown ability: ${t}`),r}function u1(){const{subscribe:t,update:e}=N([]);let r=0;return{subscribe:t,showPopup:(n,s,a,i)=>{const c={pokemonName:n,abilityName:s,id:r++,side:a,index:i};e(o=>[...o,c]),setTimeout(()=>{e(o=>o.filter(d=>d.id!==c.id))},3e3)},clear:()=>{e(()=>[])}}}const p1=u1(),f1=["mold-breaker","teravolt","turboblaze"],m1=new Set(["onTryHit","onBeforeMove","onStatus"]),g1=new Set(["onModifyAtk","onModifyDef","onModifySpA","onModifySpD","onModifySpe","onModifyDamage","onSourceModifyDamage","onStatChange"]),w1={[V.ON_SWITCH_IN]:"onSwitchIn",[V.ON_SWITCH_OUT]:"onSwitchOut",[V.ON_BEFORE_MOVE]:"onBeforeMove",[V.ON_AFTER_MOVE]:"onAfterMove",[V.ON_DAMAGE_CALC]:"onModifyAtk",[V.ON_CONTACT]:"onDamagingHit",[V.ON_TRY_HIT]:"onTryHit",[V.ON_TURN_END]:"onTurnEnd",[V.ON_TURN_START]:"onTurnStart",[V.ON_FAINT]:"onFaint",[V.ON_STATUS]:"onStatus",[V.ON_STAT_CHANGE]:"onStatChange",[V.ON_MODIFY_ATK]:"onModifyAtk",[V.ON_MODIFY_DEF]:"onModifyDef",[V.ON_MODIFY_SPA]:"onModifySpA",[V.ON_MODIFY_SPD]:"onModifySpD",[V.ON_MODIFY_SPE]:"onModifySpe",[V.ON_MODIFY_DAMAGE]:"onModifyDamage",[V.ON_SOURCE_MODIFY_DAMAGE]:"onSourceModifyDamage"};function eo(t){return t?t.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):""}class v1{runEvent(e,r,n,s,...a){if(!r.currentAbility)return;const i=h1(r.currentAbility);if(!i||this.isSuppressed(i,s)||n.battleField.neutralizingGasActive&&eo(i.name)!=="neutralizing-gas")return;const c=this.triggerToHook(e),o=i[c];if(typeof o!="function")return;const d={battleContext:n,pokemon:r,target:s,move:a.find(u=>u instanceof Pi)},h=o(d,...a);if(this.shouldShowPopup(c,h)){const u=n.getPokemonSide(r),p=(u==="ally"?n.playerSide:n.oppSide).indexOf(r);p1.showPopup(r.name,i.name,u,p>=0?p:0),n.addToStack(new I(`${r.name}'s ${i.name}!`,r))}return h}runEventForAll(e,r,n,s,...a){const i=new Map,c=this.sortBySpeed(r);for(const o of c){const d=this.runEvent(e,o,n,s,...a);i.set(o,d)}return i}sortBySpeed(e){return[...e].sort((r,n)=>n.battleStats.speed-r.battleStats.speed)}shouldShowPopup(e,r){return g1.has(e)?!1:m1.has(e)?r===!1:!!r}triggerToHook(e){return w1[e]}isSuppressed(e,r){if(!r?.currentAbility)return!1;const n=eo(r.currentAbility);return f1.includes(n)}}function Co(t){return t?t.toLowerCase().trim().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""):""}const Io=new Map;function ie(t,e){if(!t)return;const r=Co(t);Io.set(r,e)}function _1(t){if(!t)return;const e=Co(t);return Io.get(e)}const y1={[X.ON_SWITCH_IN]:"onSwitchIn",[X.ON_MODIFY_ATK]:"onModifyAtk",[X.ON_MODIFY_DEF]:"onModifyDef",[X.ON_MODIFY_SPA]:"onModifySpa",[X.ON_MODIFY_SPD]:"onModifySpd",[X.ON_MODIFY_SPEED]:"onModifySpeed",[X.ON_MODIFY_DAMAGE]:"onModifyDamage",[X.ON_MODIFY_MOVE_POWER]:"onModifyMovePower",[X.ON_BEFORE_HIT]:"onBeforeHit",[X.ON_AFTER_HIT]:"onAfterHit",[X.ON_TURN_END]:"onTurnEnd",[X.ON_STATUS_INFLICTED]:"onStatusInflicted",[X.ON_HP_CHANGED]:"onHpChanged",[X.ON_MOVE_SELECTED]:"onMoveSelected"};class b1{runItemEvent(e,r){const{pokemon:n}=r;if(!n.heldItem)return;const s=_1(n.heldItem.name);if(!s)return;const a=y1[e],i=s[a];if(typeof i!="function")return;const c=i.call(s,r);return n.heldItem?.consumable&&c!==!1&&n.consumeHeldItem(),c}}const S1={name:"Choice Band",onModifyAtk(t){return Math.floor((t.statValue??0)*1.5)},onMoveSelected(t){!t.pokemon.choiceLockedMove&&t.move&&(t.pokemon.choiceLockedMove=t.move.name)}},E1={name:"Choice Specs",onModifySpa(t){return Math.floor((t.statValue??0)*1.5)},onMoveSelected(t){!t.pokemon.choiceLockedMove&&t.move&&(t.pokemon.choiceLockedMove=t.move.name)}},O1={name:"Choice Scarf",onModifySpeed(t){return Math.floor((t.statValue??0)*1.5)},onMoveSelected(t){!t.pokemon.choiceLockedMove&&t.move&&(t.pokemon.choiceLockedMove=t.move.name)}},P1={name:"Life Orb",onModifyDamage(t){return Math.floor((t.damage??0)*1.3)},onAfterHit(t){const e=Math.max(1,Math.floor(t.pokemon.currentStats.hp/10));t.pokemon.currentHp-=e,t.pokemon.currentHp<0&&(t.pokemon.currentHp=0)}},k1={name:"Expert Belt",onModifyDamage(t){return t.effectiveness!==void 0&&t.effectiveness>1?Math.floor((t.damage??0)*1.2):t.damage??0}},A1={name:"Leftovers",onTurnEnd(t){const e=Math.max(1,Math.floor(t.pokemon.currentStats.hp/16));t.pokemon.currentHp=Math.min(t.pokemon.currentStats.hp,t.pokemon.currentHp+e)}},M1={name:"Focus Sash",onModifyDamage(t){return t.pokemon.currentHp===t.pokemon.currentStats.hp&&(t.damage??0)>=t.pokemon.currentHp?t.pokemon.currentHp-1:t.damage??0}},C1={name:"Assault Vest",onModifySpd(t){return Math.floor((t.statValue??0)*1.5)}},I1={name:"Eviolite",onModifyDef(t){return t.pokemon.evolution&&t.pokemon.evolution.length>0?Math.floor((t.statValue??0)*1.5):t.statValue??0},onModifySpd(t){return t.pokemon.evolution&&t.pokemon.evolution.length>0?Math.floor((t.statValue??0)*1.5):t.statValue??0}},T1={name:"Mystic Water",onModifyMovePower(t){return t.move?.type==="water"?Math.floor((t.statValue??0)*1.2):t.statValue??0}},D1={name:"Charcoal",onModifyMovePower(t){return t.move?.type==="fire"?Math.floor((t.statValue??0)*1.2):t.statValue??0}},x1={name:"Magnet",onModifyMovePower(t){return t.move?.type==="electric"?Math.floor((t.statValue??0)*1.2):t.statValue??0}},R1={name:"Sitrus Berry",onHpChanged(t){const e=t.pokemon.currentStats.hp;t.pokemon.currentHp>0&&t.pokemon.currentHp<=Math.floor(e/2)&&(t.pokemon.currentHp=Math.min(e,t.pokemon.currentHp+Math.floor(e/4)))}},F1={name:"Lum Berry",onStatusInflicted(t){return t.pokemon.status=void 0,!0}},N1={name:"Rawst Berry",onStatusInflicted(t){return t.pokemon.status?.abr==="BRN"?(t.pokemon.status=void 0,!0):!1}},B1={name:"Chesto Berry",onStatusInflicted(t){return t.pokemon.status?.abr==="SLP"?(t.pokemon.status=void 0,!0):!1}};ie("Choice Band",S1);ie("Choice Specs",E1);ie("Choice Scarf",O1);ie("Life Orb",P1);ie("Expert Belt",k1);ie("Leftovers",A1);ie("Focus Sash",M1);ie("Assault Vest",C1);ie("Eviolite",I1);ie("Mystic Water",T1);ie("Charcoal",D1);ie("Magnet",x1);ie("Sitrus Berry",R1);ie("Lum Berry",F1);ie("Rawst Berry",N1);ie("Chesto Berry",B1);class $1{ITEMS=new Ke;battleField=new Cd;abilityEngine;itemEngine;hazardsVersion=N(0);weatherVersion=N(0);turnPhases=N(We.UPKEEP);player;opponent;playerSide=[];oppSide=[];actionIdx=0;battleType;settings;events;escapeAttempts=0;participants=new Set;leveledUpMonsterIds=new Set;opponentTurnActions=[];playerTurnActions=[];actionStack=new iw;turnCount=0;turnHistory=[];isPlayerTurn=N(!0);currentAction=N(void 0);currentMessage=N(void 0);battleResult=new bg(!1);sleep=e=>new Promise(r=>setTimeout(r,e));_actionCompleteResolve;waitForActionCompletion(e){return Promise.race([new Promise(r=>{this._actionCompleteResolve=r}),this.sleep(e)])}signalActionComplete(){this._actionCompleteResolve&&(this._actionCompleteResolve(),this._actionCompleteResolve=void 0)}getActionDuration(e){switch(e){case $.ATTACK:return 1600;case $.SWITCH:return 2e3;case $.MESSAGE:return 1e3;case $.XP_WIN:return 500;case $.LEVEL_UP:return 1e3;case $.PLAY_ANIMATION:return 2e3;case $.STAT_CHANGE:return 1500;case $.WEATHER_CHANGE:return 1e3;default:return 800}}hasCompletionSignal(e){return"needsCompletionSignal"in e&&e.needsCompletionSignal===!0}get isWild(){return this.opponent instanceof le}battleBg="beaches";legendaryTypes=[];constructor(e,r,n,s=ye.SINGLE,a="beaches"){ht.registerInstance("BattleField",this.battleField),this.player=e,this.opponent=r,this.settings=n,this.events=new yg,this.battleType=s,this.battleBg=a,a==="mountains"&&r instanceof le&&(this.legendaryTypes=r.types??[]),this.abilityEngine=new v1,this.itemEngine=new b1;let i=1;if(s===ye.DOUBLE&&r instanceof ce&&(i=2),this.playerSide=this.player.monsters.filter(c=>!c.fainted).slice(0,i),r instanceof le?this.oppSide=[r]:this.oppSide=r.monsters.filter(c=>!c.fainted).slice(0,i),this.playerSide?.length!==i||this.oppSide?.length!==i)throw new Error("Not enough pokemons to start the battle");this.playerSide?.filter(c=>!!c&&!c.fainted).forEach(c=>this.participants.add(c)),this.prepareNewTurn()}setPlayerAction(e){this.playerTurnActions.push(e);const r=this.playerSide?.filter(n=>!!n&&!n.fainted)||[];if(this.playerTurnActions.length<r.length){const n=this.playerSide.findIndex((s,a)=>a>this.actionIdx&&!!s&&!s.fainted);n!==-1&&(this.actionIdx=n,this.currentMessage.set(`What should ${this.playerSide[this.actionIdx]?.name} do ?`))}this.playerTurnActions.length===r.length&&this.startTurn()}cancelLastAction(){if(this.playerTurnActions.length>0){this.playerTurnActions.pop();const e=this.playerSide.map((r,n)=>({poke:r,idx:n})).filter(({poke:r,idx:n})=>n<this.actionIdx&&!!r&&!r.fainted).pop()?.idx;e!==void 0?this.actionIdx=e:this.actionIdx=this.playerSide.findIndex(r=>!!r&&!r.fainted),this.currentMessage.set(`What should ${this.playerSide[this.actionIdx]?.name} do ?`)}}startTurn(){this.isPlayerTurn.set(!1),this.actionIdx=this.playerSide.findIndex(n=>!!n&&!n.fainted),this.turnCount++,this.turnPhases.set(We.UPKEEP),this.battleField.tickTurn(),this.runAbilityEventForAll(V.ON_TURN_START,"all"),this.oppSide.filter(n=>!!n&&!n.fainted).forEach(n=>{const s=this.selectOpponentAction(n);s&&this.opponentTurnActions.push(s)});const e=this.sortActions(this.playerTurnActions,this.opponentTurnActions),r=this.playerSide.find(n=>n&&!n.fainted);r&&this.addToStack(new kw(r)),this.oppSide.filter(n=>!!n&&!n.fainted).forEach(n=>{n&&this.addToStack(new qi(n))}),this.playerSide.filter(n=>!!n&&!n.fainted).forEach(n=>{n&&this.addToStack(new qi(n))}),e.forEach(n=>{this.addToStack(n)}),this.playerTurnActions=[],this.opponentTurnActions=[],this.turnPhases.set(We.MAIN),this.executeAction(this.actionStack.pop())}sortActions(e,r){const n=[],s=e.find(g=>g.type===$.RUN),a=e.filter(g=>g.type===$.SWITCH),i=e.filter(g=>g.type===$.ITEM),c=e.filter(g=>g.type===$.ATTACK),o=r.filter(g=>g.type===$.SWITCH),d=r.filter(g=>g.type===$.ITEM),h=r.filter(g=>g.type===$.ATTACK);let u=c.concat(h),f=a.concat(o),p=i.concat(d);return f=f.sort((g,y)=>g.initiator.battleStats.speed-y.initiator.battleStats.speed),p=p.sort((g,y)=>g.initiator.battleStats.speed-y.initiator.battleStats.speed),u=u.sort((g,y)=>{const S=g.move?.priority||0,E=y.move?.priority||0;return S!==E?S-E:g.initiator.battleStats.speed-y.initiator.battleStats.speed}),n.push(...u),n.push(...p),n.push(...f),s!==void 0&&n.push(s),n}executeAction(e){if(this.currentAction.set(e),e!==void 0){e.type===$.END_CHECKS&&this.turnPhases.set(We.END),e.execute(this);const r=this.getActionDuration(e.type);(this.hasCompletionSignal(e)?this.waitForActionCompletion(r):this.sleep(r)).then(()=>{this.executeAction(this.actionStack?.pop())})}else this.events.battleEnded||this.prepareNewTurn()}async executeActionSequential(e){if(!e)return;this.currentAction.set(e),e.execute(this);const r=this.getActionDuration(e.type);this.hasCompletionSignal(e)?await this.waitForActionCompletion(r):await this.sleep(r)}prepareNewTurn(){this.turnPhases.set(We.UPKEEP),this.isPlayerTurn.set(!0),this.actionIdx=this.playerSide.findIndex(e=>!!e&&!e.fainted),this.currentMessage.set(`What should ${this.playerSide[this.actionIdx]?.name} do?`)}triggerInitialSwitchIn(){const e=this.playerSide.filter(s=>!!s&&!s.fainted),r=this.oppSide.filter(s=>!!s&&!s.fainted),n=[];for(const s of e)n.push({pokemon:s,isPlayer:!0});for(const s of r)n.push({pokemon:s,isPlayer:!1});n.sort((s,a)=>s.pokemon.battleStats.speed-a.pokemon.battleStats.speed);for(const{pokemon:s,isPlayer:a}of n){const i=a?r[0]:e[0];this.runAbilityEvent(V.ON_SWITCH_IN,s,i),this.runItemEvent(X.ON_SWITCH_IN,s,{opponent:i})}}async processInitialAbilityActions(){for(;!this.actionStack.isEmpty();){const e=this.actionStack.pop();await this.executeActionSequential(e)}this.prepareNewTurn()}runAbilityEvent(e,r,n,...s){return this.abilityEngine.runEvent(e,r,this,n,...s)}runAbilityEventForAll(e,r,...n){let s=[];r==="ally"?s=this.playerSide.filter(a=>!!a&&!a.fainted):r==="opponent"?s=this.oppSide.filter(a=>!!a&&!a.fainted):s=[...this.playerSide,...this.oppSide].filter(a=>!!a&&!a.fainted),this.abilityEngine.runEventForAll(e,s,this,void 0,...n)}runItemEvent(e,r,n={}){return this.itemEngine.runItemEvent(e,{pokemon:r,battleCtx:this,...n})}addToStack(e){this.actionStack.push(e)}clearStack(){this.actionStack.clear()}calculateTypeEffectiveness(e,r){return r?.reduce((n,s)=>{const a=this.fromTypeChart(e,s);return n*a},1)||1}selectOpponentAction(e){if(e&&!e.fainted){const r=Math.floor(Math.random()*e.moves.length),n=e.moves[r];let s;const a=this.getPossibleTargets(e,n);if(a.selectOne){const i=Math.floor(Math.random()*a.slots.length);s=new St(n,[a.slots[i]],e)}else s=new St(n,a.slots,e);if(this.settings.difficulty!=="NORMAL"){let i=this.playerSide.find(d=>!!d&&!d.fainted);const c=e.moves.find(d=>this.playerSide.filter(h=>!!h&&!h.fainted).some(h=>this.calculateTypeEffectiveness(d.type,h.types)>1&&d.power>0?(i=h,!0):!1))||n,o=this.getPossibleTargets(e,c);if(o.selectOne){const d=i?this.playerSide.indexOf(i):-1,h=d!==-1?{side:"player",index:d}:o.slots[0];s=new St(c,h?[h]:[],e)}else s=new St(c,o.slots,e);if(this.opponent instanceof ce){const d=this.opponentTurnActions.find(g=>g.type===$.SWITCH),h=this.opponentTurnActions.find(g=>g.type===$.ITEM),u=this.havePotions(this.opponent),f=this.oppSide.some(g=>!!g&&g.currentHp<g.stats.hp/4),p=this.opponent.monsters.filter(g=>!!g&&!g.fainted&&!this.oppSide.includes(g)).find(g=>this.playerSide.some(y=>!!y&&!y.fainted&&this.isWeakAgainst(y,g)));if(f&&u&&!h){const g=this.opponent.bag.getPocketByCategory(27)?.[0];s=new xw(g,e,e,this.opponent)}else p&&!d&&(s=new Dw(e,p,this.opponent))}}return s}}findBestPokemon(e,r){return e.find(n=>!n.fainted&&!this.oppSide.includes(n)&&n.types.some(s=>r?.weaknesses.includes(s)))}havePotions(e){return Object.keys(e.bag?.potions)?.length>0&&Object.values(e.bag?.potions)?.length>0}isWeakAgainst(e,r){return e.weaknesses.some(n=>r?.types.includes(n))}checkFainted(e,r){const n=[];if(isNaN(e.currentHp)||e.currentHp<=0){if(e.currentHp=0,e.fainted=!0,e.status=void 0,e.resetBattleStats(),this.actionStack.stack=this.actionStack.stack.filter(s=>s.initiator!==e),this.battleType===ye.DOUBLE){const s=this.playerSide.includes(e)?"player":"opponent",a=s==="player"?this.playerSide:this.oppSide,i=a.indexOf(e);this.actionStack.stack=this.actionStack.stack.filter(c=>{if(c.type===$.ATTACK){const o=c;if(o.target.some(h=>h.side===s&&h.index===i)){const h=a.findIndex((u,f)=>f!==i&&!!u&&!u.fainted);return h!==-1?(o.target=o.target.map(u=>u.side===s&&u.index===i?{side:s,index:h}:u),!0):!1}}return!0})}if(this.oppSide.includes(e)){this.events.opponentPokemonFaint.set(e);const s=qe.howMuchIGet(e,this.participants.size,!this.isWild,this.settings.xpShare),a=this.player.getMasteryBonus(U.XP),i=Math.floor(s*(1+a/100));this.player.playerMasteries.addExp(i);const c=this.player.getMasteryBonus(U.EV);if(this.settings.xpShare){const o=this.player.monsters.filter(d=>!this.participants.has(d));if(o.length>0){const d=Math.floor(i/2);for(const h of o)if(!h.fainted){let u=d;h.heldItem?.name==="Lucky Egg"&&(u=Math.floor(d*1.5)),n.push(new mi(h,u,c))}n.push(new I(`The others received ${d} experience via XP-Share!`,r))}}for(const o of this.participants)if(!o.fainted){let d=i;o.heldItem?.name==="Lucky Egg"&&(d=Math.floor(i*1.5)),n.push(new mi(o,d,c)),n.push(new I(`${o.name} gets ${d} experience!`,o))}}else this.events.playerPokemonFaint.set(e);n.push(new I(e.name+" fainted!",r))}return n}fromTypeChart(e,r){return di[e.toLowerCase()][r.toLowerCase()]}getPokemonSide(e){return this.playerSide.includes(e)?"ally":"opponent"}getPossibleTargets(e,r){let n=[],s=!1;if(e){let i=this.getPokemonSide(e)==="ally"?this.playerSide:this.oppSide,c=this.getPokemonSide(e)==="ally"?this.oppSide:this.playerSide;if(i=i.filter(o=>!!o&&!o.fainted),c=c.filter(o=>!!o&&!o.fainted),r.target==="all-opponents")n=c;else if(r.target==="all-allies")n=i;else if(r.target==="user-and-allies")n=i;else if(r.target==="random-opponent"){const o=c[Math.floor(Math.random()*c.length)];n=o?[o]:[]}else r.target==="all-other-pokemon"?n=[...c,...i].filter(o=>o!==e):r.target==="ally"?n=i.filter(o=>o!==e):r.target==="all-pokemon"?n=[...c,...i]:r.target==="user"?n=[e]:r.target==="specific-move"?r.name==="curse"?e.types.includes("ghost")?(n=c,s=!0):n=[e]:n=[e]:r.target==="user-or-ally"?(n=i,s=!0):r.target==="selected-pokemon"&&(n=c,s=!0)}return s=s&&n.length>1,{slots:n.map(i=>{const c=this.playerSide.indexOf(i);return c!==-1?{side:"player",index:c}:{side:"opponent",index:this.oppSide.indexOf(i)}}),displayTargets:n,selectOne:s}}}class ut{id;item;name;visible;position;spriteSrc;pickedUp=!1;scripts;constructor(e,r,n,s,a,i){this.name=e,this.item=a,this.visible=r,this.position=n,this.spriteSrc=s,this.scripts=i}isBehindCounter(){return!1}isBlocking(){return!this.pickedUp&&this.visible}interact(e,r){return this.pickedUp?[]:(this.pickedUp=!0,this.scripts?this.scripts:[])}}var Tt={exports:{}},L1=Tt.exports,to;function H1(){return to||(to=1,(function(t){(function(e,r,n){function s(o){var d=this,h=c();d.next=function(){var u=2091639*d.s0+d.c*23283064365386963e-26;return d.s0=d.s1,d.s1=d.s2,d.s2=u-(d.c=u|0)},d.c=1,d.s0=h(" "),d.s1=h(" "),d.s2=h(" "),d.s0-=h(o),d.s0<0&&(d.s0+=1),d.s1-=h(o),d.s1<0&&(d.s1+=1),d.s2-=h(o),d.s2<0&&(d.s2+=1),h=null}function a(o,d){return d.c=o.c,d.s0=o.s0,d.s1=o.s1,d.s2=o.s2,d}function i(o,d){var h=new s(o),u=d&&d.state,f=h.next;return f.int32=function(){return h.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,u&&(typeof u=="object"&&a(u,h),f.state=function(){return a(h,{})}),f}function c(){var o=4022871197,d=function(h){h=String(h);for(var u=0;u<h.length;u++){o+=h.charCodeAt(u);var f=.02519603282416938*o;o=f>>>0,f-=o,f*=o,o=f>>>0,f-=o,o+=f*4294967296}return(o>>>0)*23283064365386963e-26};return d}r&&r.exports?r.exports=i:this.alea=i})(L1,t)})(Tt)),Tt.exports}var Dt={exports:{}},V1=Dt.exports,ro;function W1(){return ro||(ro=1,(function(t){(function(e,r,n){function s(c){var o=this,d="";o.x=0,o.y=0,o.z=0,o.w=0,o.next=function(){var u=o.x^o.x<<11;return o.x=o.y,o.y=o.z,o.z=o.w,o.w^=o.w>>>19^u^u>>>8},c===(c|0)?o.x=c:d+=c;for(var h=0;h<d.length+64;h++)o.x^=d.charCodeAt(h)|0,o.next()}function a(c,o){return o.x=c.x,o.y=c.y,o.z=c.z,o.w=c.w,o}function i(c,o){var d=new s(c),h=o&&o.state,u=function(){return(d.next()>>>0)/4294967296};return u.double=function(){do var f=d.next()>>>11,p=(d.next()>>>0)/4294967296,g=(f+p)/(1<<21);while(g===0);return g},u.int32=d.next,u.quick=u,h&&(typeof h=="object"&&a(h,d),u.state=function(){return a(d,{})}),u}r&&r.exports?r.exports=i:this.xor128=i})(V1,t)})(Dt)),Dt.exports}var xt={exports:{}},j1=xt.exports,so;function G1(){return so||(so=1,(function(t){(function(e,r,n){function s(c){var o=this,d="";o.next=function(){var u=o.x^o.x>>>2;return o.x=o.y,o.y=o.z,o.z=o.w,o.w=o.v,(o.d=o.d+362437|0)+(o.v=o.v^o.v<<4^(u^u<<1))|0},o.x=0,o.y=0,o.z=0,o.w=0,o.v=0,c===(c|0)?o.x=c:d+=c;for(var h=0;h<d.length+64;h++)o.x^=d.charCodeAt(h)|0,h==d.length&&(o.d=o.x<<10^o.x>>>4),o.next()}function a(c,o){return o.x=c.x,o.y=c.y,o.z=c.z,o.w=c.w,o.v=c.v,o.d=c.d,o}function i(c,o){var d=new s(c),h=o&&o.state,u=function(){return(d.next()>>>0)/4294967296};return u.double=function(){do var f=d.next()>>>11,p=(d.next()>>>0)/4294967296,g=(f+p)/(1<<21);while(g===0);return g},u.int32=d.next,u.quick=u,h&&(typeof h=="object"&&a(h,d),u.state=function(){return a(d,{})}),u}r&&r.exports?r.exports=i:this.xorwow=i})(j1,t)})(xt)),xt.exports}var Rt={exports:{}},U1=Rt.exports,no;function Y1(){return no||(no=1,(function(t){(function(e,r,n){function s(c){var o=this;o.next=function(){var h=o.x,u=o.i,f,p;return f=h[u],f^=f>>>7,p=f^f<<24,f=h[u+1&7],p^=f^f>>>10,f=h[u+3&7],p^=f^f>>>3,f=h[u+4&7],p^=f^f<<7,f=h[u+7&7],f=f^f<<13,p^=f^f<<9,h[u]=p,o.i=u+1&7,p};function d(h,u){var f,p=[];if(u===(u|0))p[0]=u;else for(u=""+u,f=0;f<u.length;++f)p[f&7]=p[f&7]<<15^u.charCodeAt(f)+p[f+1&7]<<13;for(;p.length<8;)p.push(0);for(f=0;f<8&&p[f]===0;++f);for(f==8?p[7]=-1:p[f],h.x=p,h.i=0,f=256;f>0;--f)h.next()}d(o,c)}function a(c,o){return o.x=c.x.slice(),o.i=c.i,o}function i(c,o){c==null&&(c=+new Date);var d=new s(c),h=o&&o.state,u=function(){return(d.next()>>>0)/4294967296};return u.double=function(){do var f=d.next()>>>11,p=(d.next()>>>0)/4294967296,g=(f+p)/(1<<21);while(g===0);return g},u.int32=d.next,u.quick=u,h&&(h.x&&a(h,d),u.state=function(){return a(d,{})}),u}r&&r.exports?r.exports=i:this.xorshift7=i})(U1,t)})(Rt)),Rt.exports}var Ft={exports:{}},X1=Ft.exports,ao;function K1(){return ao||(ao=1,(function(t){(function(e,r,n){function s(c){var o=this;o.next=function(){var h=o.w,u=o.X,f=o.i,p,g;return o.w=h=h+1640531527|0,g=u[f+34&127],p=u[f=f+1&127],g^=g<<13,p^=p<<17,g^=g>>>15,p^=p>>>12,g=u[f]=g^p,o.i=f,g+(h^h>>>16)|0};function d(h,u){var f,p,g,y,S,E=[],b=128;for(u===(u|0)?(p=u,u=null):(u=u+"\0",p=0,b=Math.max(b,u.length)),g=0,y=-32;y<b;++y)u&&(p^=u.charCodeAt((y+32)%u.length)),y===0&&(S=p),p^=p<<10,p^=p>>>15,p^=p<<4,p^=p>>>13,y>=0&&(S=S+1640531527|0,f=E[y&127]^=p+S,g=f==0?g+1:0);for(g>=128&&(E[(u&&u.length||0)&127]=-1),g=127,y=512;y>0;--y)p=E[g+34&127],f=E[g=g+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,E[g]=p^f;h.w=S,h.X=E,h.i=g}d(o,c)}function a(c,o){return o.i=c.i,o.w=c.w,o.X=c.X.slice(),o}function i(c,o){c==null&&(c=+new Date);var d=new s(c),h=o&&o.state,u=function(){return(d.next()>>>0)/4294967296};return u.double=function(){do var f=d.next()>>>11,p=(d.next()>>>0)/4294967296,g=(f+p)/(1<<21);while(g===0);return g},u.int32=d.next,u.quick=u,h&&(h.X&&a(h,d),u.state=function(){return a(d,{})}),u}r&&r.exports?r.exports=i:this.xor4096=i})(X1,t)})(Ft)),Ft.exports}var Nt={exports:{}},q1=Nt.exports,io;function z1(){return io||(io=1,(function(t){(function(e,r,n){function s(c){var o=this,d="";o.next=function(){var u=o.b,f=o.c,p=o.d,g=o.a;return u=u<<25^u>>>7^f,f=f-p|0,p=p<<24^p>>>8^g,g=g-u|0,o.b=u=u<<20^u>>>12^f,o.c=f=f-p|0,o.d=p<<16^f>>>16^g,o.a=g-u|0},o.a=0,o.b=0,o.c=-1640531527,o.d=1367130551,c===Math.floor(c)?(o.a=c/4294967296|0,o.b=c|0):d+=c;for(var h=0;h<d.length+20;h++)o.b^=d.charCodeAt(h)|0,o.next()}function a(c,o){return o.a=c.a,o.b=c.b,o.c=c.c,o.d=c.d,o}function i(c,o){var d=new s(c),h=o&&o.state,u=function(){return(d.next()>>>0)/4294967296};return u.double=function(){do var f=d.next()>>>11,p=(d.next()>>>0)/4294967296,g=(f+p)/(1<<21);while(g===0);return g},u.int32=d.next,u.quick=u,h&&(typeof h=="object"&&a(h,d),u.state=function(){return a(d,{})}),u}r&&r.exports?r.exports=i:this.tychei=i})(q1,t)})(Nt)),Nt.exports}var Bt={exports:{}};const J1={},Z1=Object.freeze(Object.defineProperty({__proto__:null,default:J1},Symbol.toStringTag,{value:"Module"})),Q1=qo(Z1);var ey=Bt.exports,oo;function ty(){return oo||(oo=1,(function(t){(function(e,r,n){var s=256,a=6,i=52,c="random",o=n.pow(s,a),d=n.pow(2,i),h=d*2,u=s-1,f;function p(D,x,F){var R=[];x=x==!0?{entropy:!0}:x||{};var P=E(S(x.entropy?[D,A(r)]:D??b(),3),R),T=new g(R),H=function(){for(var j=T.g(a),G=o,W=0;j<d;)j=(j+W)*s,G*=s,W=T.g(1);for(;j>=h;)j/=2,G/=2,W>>>=1;return(j+W)/G};return H.int32=function(){return T.g(4)|0},H.quick=function(){return T.g(4)/4294967296},H.double=H,E(A(T.S),r),(x.pass||F||function(j,G,W,Y){return Y&&(Y.S&&y(Y,T),j.state=function(){return y(T,{})}),W?(n[c]=j,G):j})(H,P,"global"in x?x.global:this==n,x.state)}function g(D){var x,F=D.length,R=this,P=0,T=R.i=R.j=0,H=R.S=[];for(F||(D=[F++]);P<s;)H[P]=P++;for(P=0;P<s;P++)H[P]=H[T=u&T+D[P%F]+(x=H[P])],H[T]=x;(R.g=function(j){for(var G,W=0,Y=R.i,B=R.j,Z=R.S;j--;)G=Z[Y=u&Y+1],W=W*s+Z[u&(Z[Y]=Z[B=u&B+G])+(Z[B]=G)];return R.i=Y,R.j=B,W})(s)}function y(D,x){return x.i=D.i,x.j=D.j,x.S=D.S.slice(),x}function S(D,x){var F=[],R=typeof D,P;if(x&&R=="object")for(P in D)try{F.push(S(D[P],x-1))}catch{}return F.length?F:R=="string"?D:D+"\0"}function E(D,x){for(var F=D+"",R,P=0;P<F.length;)x[u&P]=u&(R^=x[u&P]*19)+F.charCodeAt(P++);return A(x)}function b(){try{var D;return f&&(D=f.randomBytes)?D=D(s):(D=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(D)),A(D)}catch{var x=e.navigator,F=x&&x.plugins;return[+new Date,e,F,e.screen,A(r)]}}function A(D){return String.fromCharCode.apply(0,D)}if(E(n.random(),r),t.exports){t.exports=p;try{f=Q1}catch{}}else n["seed"+c]=p})(typeof self<"u"?self:ey,[],Math)})(Bt)),Bt.exports}var qa,lo;function ry(){if(lo)return qa;lo=1;var t=H1(),e=W1(),r=G1(),n=Y1(),s=K1(),a=z1(),i=ty();return i.alea=t,i.xor128=e,i.xorwow=r,i.xorshift7=n,i.xor4096=s,i.tychei=a,qa=i,qa}var sy=ry();const ny=zo(sy);class He{rng;constructor(e){this.rng=ny(e)}next(){return this.rng()}nextInt(e,r){return Math.floor(this.rng()*(r-e+1))+e}nextBool(e=.5){return this.rng()<e}shuffle(e){const r=[...e];for(let n=r.length-1;n>0;n--){const s=Math.floor(this.rng()*(n+1));[r[n],r[s]]=[r[s],r[n]]}return r}pick(e){if(e.length===0)throw new Error("Cannot pick from an empty array");return e[this.nextInt(0,e.length-1)]}}function qt(t,e){return`${t}-floor-${e}`}var To=(t=>(t[t.RUNNING_SHOES_UNLOCKED=0]="RUNNING_SHOES_UNLOCKED",t[t.COMBO_MOVES_UNLOCKED=1]="COMBO_MOVES_UNLOCKED",t))(To||{});class za{flags;constructor(e){e?(this.flags=e,Object.setPrototypeOf(this.flags,Map.prototype)):(this.flags=new Map,Object.values(To).forEach(r=>{this.flags.set(r,!1)}))}setFlag(e,r){this.flags.set(e,r)}getFlag(e){return this.flags.get(e)||!1}}class zt{id;completed;constructor(e,r){this.id=e,this.completed=r}}class ay{id;description;completed;constructor(e,r,n=!1){this.id=e,this.description=r,this.completed=n}complete(){this.completed=!0}}class iy{id;name;description;objectives;completed;area;leaveMessage;constructor(e,r,n,s,a,i="I shouldn't leave",c=!1){this.id=e,this.name=r,this.description=n,this.objectives=s,this.area=a,this.leaveMessage=i,this.completed=c}toState(){return new Jt(this.id,this.completed,this.objectives.map(e=>new zt(e.id,e.completed)))}}class Jt{id;completed;objectives;constructor(e,r,n){this.id=e,this.completed=r,this.objectives=n}}const Do=[];class oy{messages=[];observers=[];notify(e){this.messages.push(e),setTimeout(()=>{this.messages.shift(),this.notifyObservers()},5e3),this.notifyObservers()}subscribe(e){this.observers.push(e)}notifyObservers(){for(const e of this.observers)e(this.messages)}}class ly{sound;battleStartSound;battleSound;legendaryBattleSound;constructor(){this.battleStartSound=new Howl({src:["src/assets/audio/battle/battle-start.mp3"],autoplay:!1,loop:!1,volume:.5,html5:!0}),this.battleSound=new Howl({src:["src/assets/audio/battle/battle2.mp3"],autoplay:!1,loop:!0,volume:.5,html5:!0}),this.legendaryBattleSound=new Howl({src:["src/assets/audio/battle/PerituneMaterial_EpicBattle_J(chosic.com)-2.mp3"],autoplay:!1,loop:!0,volume:.5,html5:!0})}playMapSound(e){e&&(this.sound=new Howl({src:["src/assets/audio/"+e+".mp3"],autoplay:!0,loop:!0,volume:.5,html5:!0}))}fadeOutMapSound(e=900){this.sound&&(this.sound.fade(.5,0,e),setTimeout(()=>{this.sound?.stop(),this.sound=void 0},e))}isMapSoundPlaying(){return!!this.sound&&this.sound.playing()}startBattleTransition(){this.sound&&this.sound.playing()&&(this.sound.fade(.5,0,500),this.battleStartSound.play(),setTimeout(()=>{this.sound?.stop(),this.battleStartSound.fade(0,.5,500)},500))}playBattleMusic(){this.battleStartSound.stop(),this.battleSound.volume(.5),this.battleSound.seek(0),this.battleSound.play()}playLegendaryBattleMusic(){this.battleStartSound.stop(),this.legendaryBattleSound.volume(.5),this.legendaryBattleSound.seek(0),this.legendaryBattleSound.play()}fadeOutBattleMusic(e=1e3){this.battleSound.playing()&&this.battleSound.fade(.5,0,e),this.legendaryBattleSound.playing()&&this.legendaryBattleSound.fade(.5,0,e)}stopBattleMusic(){this.battleSound.stop(),this.legendaryBattleSound.stop()}getCurrentSound(){return this.sound}}class cy{questStates=[];quests=[];currentQuest;flags;notifications;onObjectiveComplete;constructor(e,r,n){this.questStates=e,this.flags=r,this.notifications=n;const s=this.questStates.filter(a=>a.completed).sort((a,i)=>a.id-i.id).pop();this.quests=Do.map(a=>{const i=this.questStates.find(c=>c.id===a.id);return new iy(a.id,a.name,a.description,a.objectives.map(c=>new ay(c.id,c.description,i?.objectives.find(o=>o.id===c.id)?.completed||!1)),a.area,a.leaveMessage,i?.completed||!1)}),s?this.currentQuest=this.quests.find(a=>a.id===s.id+1)||this.quests[0]:this.currentQuest=this.quests[0]}validateObjective(e,r){const n=this.quests.find(a=>a.id===e),s=n?.objectives.find(a=>a.id===r);if(s){s.complete();const a=this.questStates.find(i=>i.id===e);if(a){const i=a.objectives.find(c=>c.id===r);i&&(i.completed=!0,this.notifications.notify(`Objective completed: ${s.description}`),this.onObjectiveComplete?.(),n&&a.objectives.every(c=>c.completed)&&(a.completed=!0,this.notifications.notify(`Quest completed: ${n.name}`),this.currentQuest=this.quests.find(c=>c.id===e+1)||void 0,this.currentQuest&&this.notifications.notify(`New quest: ${this.currentQuest.name}`)))}else n&&this.questStates.push(new Jt(e,!1,n.objectives.map(i=>new zt(i.id,i.completed))))}}isMenuAvailable(e){switch(e){case q.POKEMON_LIST:case q.BOX:return this.questStates.find(r=>r.id===0)?.objectives[0].completed||!1;case q.POKEDEX:return this.questStates.find(r=>r.id===0)?.objectives[1].completed||!1;case q.TRAINER:return this.questStates.find(r=>r.id===0)?.objectives[2].completed||!1;case q.BAG:return this.questStates.find(r=>r.id===0)?.objectives[3].completed||!1;default:return!1}}hasQuestLimit(e){return!!this.currentQuest&&!!this.currentQuest.area&&this.isOutsideQuestBounds(e,this.currentQuest.area)}isOutsideQuestBounds(e,r){return e.x<r.start.x||e.x>r.end.x||e.y<r.start.y||e.y>r.end.y}notifyCurrentQuest(){this.currentQuest&&this.notifications.notify("Current quest: "+this.currentQuest.name)}getQuestStates(){return this.questStates}getFlags(){return this.flags}}class dy{playingScript;playingScript$=N(void 0);scriptsByTrigger=new Map;constructor(){}indexScripts(e){e.forEach(r=>{this.scriptsByTrigger.has(r.triggerType)?this.scriptsByTrigger.get(r.triggerType)?.push(r):this.scriptsByTrigger.set(r.triggerType,[r])})}collectAllScripts(e,r){return e.concat(r.map(n=>n.mainScript).filter(n=>n!==void 0)).concat(r.map(n=>n.dialogScripts).flat().filter(n=>n!==void 0)).concat(r.map(n=>n.movingScript).filter(n=>n!==void 0))}play(e,r,n,s,a,i=!0){e&&!this.playingScript&&(e.onEnd=()=>{this.playingScript=void 0,this.playingScript$.set(void 0),n.setPaused(!1,"script-end gameContext"),s?(a&&(s.onEnd=a),s?.resume(r)):a&&a()},this.playingScript=e,this.playingScript$.set(e),n.setPaused(i,"script-start gameContext"),e.start(r))}playMovements(e,r){e.forEach(n=>{n?.movingScript?.start(r,!1)})}getByTrigger(e){return this.scriptsByTrigger.get(e)?.at(0)}interruptCurrent(){this.playingScript?.interrupt()}clear(){this.scriptsByTrigger.clear(),this.playingScript=void 0,this.playingScript$.set(void 0)}isPlaying(){return!!this.playingScript}}const hy={absorb:"Absorb",acid:"Acid","acid-armor":"Acid Armor","acid-spray":"Acid Spray",acrobatics:"Acrobatics",acupressure:"Acupressure","aerial-ace":"Aerial Ace",agility:"Agility","air-cutter":"Air Cutter","air-slash":"Air Slash","ally-switch":"Ally Switch",amnesia:"Amnesia","ancient-power":"Ancient Power","aqua-jet":"Aqua Jet","aqua-ring":"Aqua Ring","aqua-tail":"Aqua Tail",aromatherapy:"Aromatherapy",assist:"Assist",astonish:"Astonish",attract:"Attract","aura-sphere":"Aura Sphere","aurora-beam":"Aurora Beam","aurora-veil":"Aurora Veil",autotomize:"Autotomize",avalanche:"Avalanche",barrier:"Barrier","baton-pass":"Baton Pass","belly-drum":"Belly Drum",bestow:"Bestow",bind:"Bind",bite:"Bite","blaze-kick":"Blaze Kick",blizzard:"Blizzard",block:"Block","body-slam":"Body Slam","bone-club":"Bone Club",boomburst:"Boomburst",bounce:"Bounce","brave-bird":"Brave Bird","brick-break":"Brick Break",brine:"Brine",bubble:"Bubble","bubble-beam":"Bubble Beam","bug-bite":"Bug Bite","bug-buzz":"Bug Buzz","bulk-up":"Bulk Up",bulldoze:"Bulldoze","bullet-punch":"Bullet Punch","calm-mind":"Calm Mind",camouflage:"Camouflage",captivate:"Captivate","charge-beam":"Charge Beam",charm:"Charm","chip-away":"Chip Away","circle-throw":"Circle Throw",clamp:"Clamp","clear-smog":"Clear Smog","close-combat":"Close Combat",coil:"Coil","confuse-ray":"Confuse Ray",confusion:"Confusion",constrict:"Constrict",copycat:"Copycat","cotton-guard":"Cotton Guard",covet:"Covet",crabhammer:"Crabhammer","cross-chop":"Cross Chop","cross-poison":"Cross Poison",crunch:"Crunch","crush-claw":"Crush Claw",curse:"Curse","dark-pulse":"Dark Pulse","dark-void":"Dark Void","dazzling-gleam":"Dazzling Gleam","defense-curl":"Defense Curl",defog:"Defog","destiny-bond":"Destiny Bond",detect:"Detect","diamond-storm":"Diamond Storm",dig:"Dig",disable:"Disable","disarming-voice":"Disarming Voice",discharge:"Discharge","double-edge":"Double-Edge","double-team":"Double Team","draco-meteor":"Draco Meteor","dragon-breath":"Dragon Breath","dragon-claw":"Dragon Claw","dragon-dance":"Dragon Dance","dragon-pulse":"Dragon Pulse","dragon-rage":"Dragon Rage","dragon-rush":"Dragon Rush","dragon-tail":"Dragon Tail","drain-punch":"Drain Punch","draining-kiss":"Draining Kiss","dream-eater":"Dream Eater","drill-peck":"Drill Peck","drill-run":"Drill Run","dynamic-punch":"Dynamic Punch","earth-power":"Earth Power",earthquake:"Earthquake","echoed-voice":"Echoed Voice","eerie-impulse":"Eerie Impulse","egg-bomb":"Egg Bomb","electric-terrain":"Electric Terrain",electrify:"Electrify","electro-ball":"Electro Ball",electroweb:"Electroweb",ember:"Ember",encore:"Encore",endeavor:"Endeavor",endure:"Endure","energy-ball":"Energy Ball",eruption:"Eruption",explosion:"Explosion",extrasensory:"Extrasensory",facade:"Facade","fairy-wind":"Fairy Wind","fake-out":"Fake Out","fake-tears":"Fake Tears","false-swipe":"False Swipe","feather-dance":"Feather Dance",feint:"Feint","feint-attack":"Feint Attack","fell-stinger":"Fell Stinger","fiery-dance":"Fiery Dance","final-gambit":"Final Gambit","fire-blast":"Fire Blast","fire-fang":"Fire Fang","fire-punch":"Fire Punch","fire-spin":"Fire Spin","first-impression":"First Impression",fissure:"Fissure",flail:"Flail","flame-burst":"Flame Burst","flame-charge":"Flame Charge","flame-wheel":"Flame Wheel",flamethrower:"Flamethrower","flare-blitz":"Flare Blitz","flash-cannon":"Flash Cannon",flatter:"Flatter","fleur-cannon":"Fleur Cannon",fling:"Fling",fly:"Fly","flying-press":"Flying Press","focus-energy":"Focus Energy","follow-me":"Follow Me","force-palm":"Force Palm","foul-play":"Foul Play","freeze-dry":"Freeze-Dry","frost-breath":"Frost Breath","fury-cutter":"Fury Cutter","future-sight":"Future Sight","gear-grind":"Gear Grind","giga-drain":"Giga Drain","giga-impact":"Giga Impact",glare:"Glare","grass-whistle":"Grass Whistle","grassy-terrain":"Grassy Terrain",gravity:"Gravity",growl:"Growl",growth:"Growth",guillotine:"Guillotine","gunk-shot":"Gunk Shot","gyro-ball":"Gyro Ball",hail:"Hail","hammer-arm":"Hammer Arm",harden:"Harden",haze:"Haze","head-smash":"Head Smash",headbutt:"Headbutt","heal-bell":"Heal Bell","heal-pulse":"Heal Pulse","healing-wish":"Healing Wish","heart-stamp":"Heart Stamp","heat-wave":"Heat Wave","heavy-slam":"Heavy Slam","helping-hand":"Helping Hand",hex:"Hex","hidden-power":"Hidden Power","high-horsepower":"High Horsepower","high-jump-kick":"High Jump Kick","hone-claws":"Hone Claws","horn-attack":"Horn Attack","horn-drill":"Horn Drill","horn-leech":"Horn Leech",howl:"Howl",hurricane:"Hurricane","hydro-pump":"Hydro Pump","hyper-beam":"Hyper Beam","hyper-fang":"Hyper Fang",hypnosis:"Hypnosis","ice-ball":"Ice Ball","ice-beam":"Ice Beam","ice-fang":"Ice Fang","ice-punch":"Ice Punch","ice-shard":"Ice Shard","icicle-crash":"Icicle Crash","icy-wind":"Icy Wind",incinerate:"Incinerate",infestation:"Infestation",ingrain:"Ingrain","iron-defense":"Iron Defense","iron-head":"Iron Head","iron-tail":"Iron Tail","jump-kick":"Jump Kick","karate-chop":"Karate Chop","knock-off":"Knock Off","lava-plume":"Lava Plume","leaf-blade":"Leaf Blade","leaf-storm":"Leaf Storm",leafage:"Leafage","leech-life":"Leech Life","leech-seed":"Leech Seed",leer:"Leer","light-screen":"Light Screen",liquidation:"Liquidation","lovely-kiss":"Lovely Kiss","low-kick":"Low Kick","low-sweep":"Low Sweep",lunge:"Lunge","mach-punch":"Mach Punch","magic-coat":"Magic Coat","magic-room":"Magic Room","magical-leaf":"Magical Leaf",magnitude:"Magnitude","mean-look":"Mean Look",meditate:"Meditate","mega-drain":"Mega Drain","mega-kick":"Mega Kick","mega-punch":"Mega Punch",megahorn:"Megahorn",memento:"Memento","metal-claw":"Metal Claw","metal-sound":"Metal Sound","meteor-mash":"Meteor Mash",metronome:"Metronome",mimic:"Mimic",minimize:"Minimize","mirror-coat":"Mirror Coat","mirror-shot":"Mirror Shot","misty-terrain":"Misty Terrain",moonblast:"Moonblast",moonlight:"Moonlight","morning-sun":"Morning Sun","mud-bomb":"Mud Bomb","mud-shot":"Mud Shot","mud-slap":"Mud-Slap","mud-sport":"Mud Sport","muddy-water":"Muddy Water","mystical-fire":"Mystical Fire","nasty-plot":"Nasty Plot","night-shade":"Night Shade","night-slash":"Night Slash",nightmare:"Nightmare",nuzzle:"Nuzzle","ominous-wind":"Ominous Wind",outrage:"Outrage",overheat:"Overheat","pain-split":"Pain Split","parabolic-charge":"Parabolic Charge","parting-shot":"Parting Shot","pay-day":"Pay Day",payback:"Payback",peck:"Peck","perish-song":"Perish Song","petal-blizzard":"Petal Blizzard","petal-dance":"Petal Dance","phantom-force":"Phantom Force","play-nice":"Play Nice","play-rough":"Play Rough",pluck:"Pluck","poison-fang":"Poison Fang","poison-gas":"Poison Gas","poison-jab":"Poison Jab","poison-powder":"Poison Powder","poison-sting":"Poison Sting","poison-tail":"Poison Tail","pollen-puff":"Pollen Puff",pound:"Pound",powder:"Powder","powder-snow":"Powder Snow","power-gem":"Power Gem","power-trick":"Power Trick","power-trip":"Power Trip","power-whip":"Power Whip",protect:"Protect",psybeam:"Psybeam","psych-up":"Psych Up",psychic:"Psychic","psychic-fangs":"Psychic Fangs","psychic-terrain":"Psychic Terrain","psycho-cut":"Psycho Cut","psycho-shift":"Psycho Shift",psyshock:"Psyshock",psywave:"Psywave",punishment:"Punishment",pursuit:"Pursuit",quash:"Quash","quick-attack":"Quick Attack","quiver-dance":"Quiver Dance","rain-dance":"Rain Dance","rapid-spin":"Rapid Spin","razor-leaf":"Razor Leaf","razor-shell":"Razor Shell","razor-wind":"Razor Wind",recover:"Recover",recycle:"Recycle",reflect:"Reflect",refresh:"Refresh",rest:"Rest",reversal:"Reversal",roar:"Roar","rock-climb":"Rock Climb","rock-polish":"Rock Polish","rock-slide":"Rock Slide","rock-smash":"Rock Smash","rock-throw":"Rock Throw","rock-tomb":"Rock Tomb","rock-wrecker":"Rock Wrecker","role-play":"Role Play","rolling-kick":"Rolling Kick",rollout:"Rollout",roost:"Roost",rototiller:"Rototiller","sacred-sword":"Sacred Sword","sand-attack":"Sand Attack","sand-tomb":"Sand Tomb",sandstorm:"Sandstorm",scald:"Scald","scary-face":"Scary Face",scratch:"Scratch",screech:"Screech","secret-power":"Secret Power","seed-bomb":"Seed Bomb","seismic-toss":"Seismic Toss","self-destruct":"Self-Destruct","shadow-ball":"Shadow Ball","shadow-bone":"Shadow Bone","shadow-claw":"Shadow Claw","shadow-punch":"Shadow Punch","shadow-sneak":"Shadow Sneak",sharpen:"Sharpen","sheer-cold":"Sheer Cold","shell-smash":"Shell Smash","shell-trap":"Shell Trap","shift-gear":"Shift Gear","shock-wave":"Shock Wave","signal-beam":"Signal Beam","silver-wind":"Silver Wind",sing:"Sing","skull-bash":"Skull Bash","sky-attack":"Sky Attack","sky-uppercut":"Sky Uppercut","slack-off":"Slack Off",slam:"Slam",slash:"Slash","sleep-powder":"Sleep Powder","sleep-talk":"Sleep Talk",sludge:"Sludge","sludge-wave":"Sludge Wave","smack-down":"Smack Down","smelling-salts":"Smelling Salts",smog:"Smog",smokescreen:"Smokescreen",snarl:"Snarl",snore:"Snore","soft-boiled":"Soft-Boiled","solar-beam":"Solar Beam","solar-blade":"Solar Blade","sonic-boom":"Sonic Boom",spark:"Spark","sparkling-aria":"Sparkling Aria","spectral-thief":"Spectral Thief","speed-swap":"Speed Swap","spider-web":"Spider Web",spikes:"Spikes","spit-up":"Spit Up",spite:"Spite",splash:"Splash",spore:"Spore","stealth-rock":"Stealth Rock",steamroller:"Steamroller","steel-wing":"Steel Wing","sticky-web":"Sticky Web",stockpile:"Stockpile",stomp:"Stomp","stomping-tantrum":"Stomping Tantrum","stone-edge":"Stone Edge","stored-power":"Stored Power","storm-throw":"Storm Throw","string-shot":"String Shot","struggle-bug":"Struggle Bug","stun-spore":"Stun Spore",submission:"Submission",substitute:"Substitute","sucker-punch":"Sucker Punch","sunny-day":"Sunny Day","super-fang":"Super Fang",superpower:"Superpower",supersonic:"Supersonic",surf:"Surf",swagger:"Swagger",swallow:"Swallow","sweet-kiss":"Sweet Kiss","sweet-scent":"Sweet Scent",swift:"Swift",switcheroo:"Switcheroo","swords-dance":"Swords Dance",synthesis:"Synthesis",tackle:"Tackle","tail-whip":"Tail Whip",tailwind:"Tailwind","take-down":"Take Down",taunt:"Taunt","tearful-look":"Tearful Look","teeter-dance":"Teeter Dance",teleport:"Teleport",thief:"Thief",thrash:"Thrash","throat-chop":"Throat Chop",thunder:"Thunder","thunder-fang":"Thunder Fang","thunder-punch":"Thunder Punch","thunder-shock":"Thunder Shock","thunder-wave":"Thunder Wave",thunderbolt:"Thunderbolt",tickle:"Tickle",torment:"Torment",toxic:"Toxic","toxic-spikes":"Toxic Spikes",transform:"Transform","tri-attack":"Tri Attack",trick:"Trick","trick-room":"Trick Room","trump-card":"Trump Card",twister:"Twister","u-turn":"U-turn",uproar:"Uproar","vacuum-wave":"Vacuum Wave","venom-drench":"Venom Drench",venoshock:"Venoshock","vice-grip":"Vice Grip","vine-whip":"Vine Whip","vital-throw":"Vital Throw","volt-switch":"Volt Switch","water-gun":"Water Gun","water-pulse":"Water Pulse",waterfall:"Waterfall","weather-ball":"Weather Ball",whirlpool:"Whirlpool",whirlwind:"Whirlwind","wild-charge":"Wild Charge","will-o-wisp":"Will-O-Wisp","wing-attack":"Wing Attack",wish:"Wish",withdraw:"Withdraw","wood-hammer":"Wood Hammer","work-up":"Work Up",wrap:"Wrap","wring-out":"Wring Out","x-scissor":"X-Scissor",yawn:"Yawn","zap-cannon":"Zap Cannon","zen-headbutt":"Zen Headbutt"},uy={"hit-normal":"Hit Normal Damage","hit-super-effective":"Hit Super Effective","hit-not-very-effective":"Hit Weak Not Very Effective",faint:"In-Battle Faint No Health","stat-rise":"Stat Rise Up","stat-fall":"Stat Fall Down","status-burned":"Status Burned","status-confused":"Status Confused","status-frozen":"Status Frozen","status-paralyzed":"Status Paralyzed","status-poisoned":"Status Poisoned","status-sleep":"Status Sleep","ability-activate":"In-Battle Ability Activate","eat-berry":"In-Battle Eat Berry",heal:"In-Battle Heal HP Restore","health-low":"In-Battle Health Low","held-item":"In-Battle Held Item Activate","switch-alive":"In-Battle Recall Switch Alive","switch-fainted":"In-Battle Recall Switch Fainted","switch-flee":"In-Battle Recall Switch Flee Run","switch-forced":"In-Battle Recall Switch Forced Retreat","switch-pokeball":"In-Battle Recall Switch Pokeball",recall:"In-Battle Recall Switch Pokeball"};function co(t){const e=hy[t.toLowerCase()];if(e)return`src/assets/audio/move-effects/${e}.mp3`}function py(t){const e=uy[t.toLowerCase()];if(e)return`src/assets/audio/move-effects/${e}.mp3`}const fy={"menu-open":"src/assets/audio/ui/menu.wav","menu-close":"src/assets/audio/ui/menu.wav","cursor-move":"src/assets/audio/ui/cursor-move.mp3",confirm:"src/assets/audio/ui/menu.wav",cancel:"src/assets/audio/ui/cancel.mp3","item-use":"src/assets/audio/ui/item-use.mp3","error-buzz":"src/assets/audio/ui/error-buzz.mp3"},ho=6;class my{settings;sfxCache=new Map;cryCache=new Map;activeSounds=[];sfxVolume;cryVolume;enabled;constructor(e){this.settings=e,this.sfxVolume=e.sfxVolume,this.cryVolume=e.cryVolume,this.enabled=e.soundEnabled}playMoveSFX(e){if(!this.enabled)return;const r=co(e);if(!r){console.warn(`[SoundManager] No SFX mapping for move: ${e}`);return}this.playSound(r,this.sfxVolume,this.sfxCache)}playMoveSFXAsync(e){if(!this.enabled)return Promise.resolve();const r=co(e);return r?this.playSoundAsync(r,this.sfxVolume,this.sfxCache):Promise.resolve()}playBattleSFX(e){if(!this.enabled)return;const r=py(e);if(!r){console.warn(`[SoundManager] Unknown battle SFX key: ${e}`);return}this.playSound(r,this.sfxVolume,this.sfxCache)}playCry(e){if(!this.enabled)return;const n=`src/assets/audio/cries/${e.toLowerCase().replace(/\s+/g,"-")}.mp3`;this.playSound(n,this.cryVolume,this.cryCache)}playUISFX(e){if(!this.enabled)return;const r=fy[e];if(!r){console.warn(`[SoundManager] Unknown UI SFX key: ${e}`);return}this.playSound(r,this.sfxVolume,this.sfxCache)}stopAll(){for(const e of this.activeSounds)e.howl.stop();this.activeSounds=[]}setMusicVolume(e){this.settings.musicVolume=e}setSfxVolume(e){this.sfxVolume=e,this.settings.sfxVolume=e;for(const[,r]of this.sfxCache)r.volume(e)}setCryVolume(e){this.cryVolume=e,this.settings.cryVolume=e;for(const[,r]of this.cryCache)r.volume(e)}setEnabled(e){this.enabled=e,this.settings.soundEnabled=e,e||this.stopAll()}playSound(e,r,n){this.activeSounds.length>=ho&&this.activeSounds.shift()?.howl.stop();let s=n.get(e);s||(s=new ti.Howl({src:[e],autoplay:!1,loop:!1,volume:r}),n.set(e,s)),s.volume(r),s.play(),this.activeSounds.push({id:e,howl:s})}playSoundAsync(e,r,n){this.activeSounds.length>=ho&&this.activeSounds.shift()?.howl.stop();let s=n.get(e);return s||(s=new ti.Howl({src:[e],autoplay:!1,loop:!1,volume:r}),n.set(e,s)),s.volume(r),new Promise(a=>{s.once("end",()=>a()),s.play(),this.activeSounds.push({id:e,howl:s})})}}var O=(t=>(t[t.GRASS=0]="GRASS",t[t.PATH=1]="PATH",t[t.WATER=2]="WATER",t[t.SAND=3]="SAND",t[t.TREE_GROUND=4]="TREE_GROUND",t[t.FLOWER_GROUND=5]="FLOWER_GROUND",t[t.TALL_GRASS=6]="TALL_GRASS",t[t.BUILDING_FLOOR=7]="BUILDING_FLOOR",t[t.WALL=8]="WALL",t[t.DUNGEON_FLOOR=9]="DUNGEON_FLOOR",t[t.STAIRS_DOWN=10]="STAIRS_DOWN",t[t.BOSS_GATE=11]="BOSS_GATE",t[t.REST_FLOOR=12]="REST_FLOOR",t[t.SHOP_FLOOR=13]="SHOP_FLOOR",t[t.LAVA=14]="LAVA",t[t.SWAMP=15]="SWAMP",t[t.DARK_FLOOR=16]="DARK_FLOOR",t[t.CLIFF_ROCK=17]="CLIFF_ROCK",t[t.CAVE_ENTRANCE=18]="CAVE_ENTRANCE",t))(O||{});const uS=new Map([[0,0],[1,0],[2,-.15],[3,.05],[4,.1],[5,.1],[6,0],[7,0],[8,1],[9,0],[10,-.1],[11,.3],[12,0],[13,0],[14,-.2],[15,-.05],[16,0],[17,1],[18,.15]]),pS=new Map([[0,!0],[1,!0],[2,!1],[3,!0],[4,!1],[5,!0],[6,!0],[7,!1],[8,!1],[9,!0],[10,!0],[11,!0],[12,!0],[13,!0],[14,!1],[15,!0],[16,!0],[17,!1],[18,!0]]),fS=new Map([[0,5025616],[1,12364452],[2,2201331],[3,16635957],[4,3046706],[5,6732650],[6,3706428],[7,7901340],[8,7951688],[9,10395294],[10,16761095],[11,13840175],[12,8505220],[13,13538264],[14,16733986],[15,5606191],[16,4342338],[17,4868682],[18,16766720]]),gy=[{name:"GRASS_FOREST",monsterPool:[{id:19,name:"Sewaddle",weight:10},{id:20,name:"Swadloon",weight:5},{id:21,name:"Leavanny",weight:2},{id:22,name:"Venipede",weight:10},{id:23,name:"Whirlipede",weight:5},{id:24,name:"Scolipede",weight:1},{id:33,name:"Shroomish",weight:10},{id:34,name:"Breloom",weight:4},{id:37,name:"Hoppip",weight:10},{id:38,name:"Skiploom",weight:5},{id:39,name:"Jumpluff",weight:2},{id:12,name:"Starly",weight:10},{id:13,name:"Staravia",weight:5},{id:14,name:"Staraptor",weight:2},{id:40,name:"Teddiursa",weight:8},{id:41,name:"Ursaring",weight:4},{id:152,name:"Cutiefly",weight:8},{id:153,name:"Ribombee",weight:4}]},{name:"CAVE_ROCK",monsterPool:[{id:65,name:"Rhyhorn",weight:8},{id:66,name:"Rhydon",weight:4},{id:67,name:"Rhyperior",weight:1},{id:68,name:"Zubat",weight:10},{id:69,name:"Golbat",weight:5},{id:70,name:"Crobat",weight:2},{id:82,name:"Onix",weight:8},{id:83,name:"Steelix",weight:2},{id:79,name:"Aron",weight:10},{id:80,name:"Lairon",weight:5},{id:81,name:"Aggron",weight:1},{id:204,name:"Cubone",weight:10},{id:205,name:"Marowak",weight:4},{id:133,name:"Mankey",weight:8},{id:134,name:"Primeape",weight:4},{id:141,name:"Riolu",weight:8},{id:142,name:"Lucario",weight:4}]},{name:"WATER_SWAMP",monsterPool:[{id:121,name:"Tentacool",weight:10},{id:122,name:"Tentacruel",weight:4},{id:110,name:"Slowpoke",weight:8},{id:111,name:"Slowbro",weight:4},{id:15,name:"Shellder",weight:10},{id:16,name:"Cloyster",weight:4},{id:119,name:"Magikarp",weight:10},{id:120,name:"Gyarados",weight:1},{id:107,name:"Azurill",weight:8},{id:108,name:"Marill",weight:5},{id:109,name:"Azumarill",weight:2},{id:113,name:"Wimpod",weight:8},{id:114,name:"Golisopod",weight:4},{id:123,name:"Carvanha",weight:8},{id:124,name:"Sharpedo",weight:4},{id:125,name:"Feebas",weight:8},{id:126,name:"Milotic",weight:1}]},{name:"FIRE_VOLCANIC",monsterPool:[{id:7,name:"Fennekin",weight:8},{id:8,name:"Braixen",weight:4},{id:9,name:"Delphox",weight:2},{id:190,name:"Magby",weight:10},{id:191,name:"Magmar",weight:5},{id:192,name:"Magmortar",weight:2},{id:193,name:"Growlithe",weight:10},{id:194,name:"Arcanine",weight:4},{id:199,name:"Torkoal",weight:8},{id:198,name:"Turtonator",weight:4},{id:200,name:"Houndour",weight:8},{id:201,name:"Houndoom",weight:4},{id:202,name:"Larvesta",weight:8},{id:203,name:"Volcarona",weight:2},{id:195,name:"Litwick",weight:8},{id:196,name:"Lampent",weight:5},{id:197,name:"Chandelure",weight:2}]},{name:"DARK_HAUNTED",monsterPool:[{id:45,name:"Gastly",weight:10},{id:46,name:"Haunter",weight:5},{id:47,name:"Gengar",weight:2},{id:48,name:"Zorua",weight:8},{id:49,name:"Zoroark",weight:4},{id:86,name:"Shuppet",weight:10},{id:87,name:"Banette",weight:4},{id:160,name:"Mimikyu",weight:4},{id:43,name:"Phantump",weight:8},{id:44,name:"Trevenant",weight:4},{id:95,name:"Sneasel",weight:8},{id:96,name:"Weavile",weight:4},{id:217,name:"Absol",weight:4},{id:74,name:"Vullaby",weight:8},{id:75,name:"Mandibuzz",weight:4},{id:149,name:"Scraggy",weight:8},{id:150,name:"Scrafty",weight:4},{id:186,name:"Stunky",weight:8}]}],wy={biomes:gy},vy=wy,xo=new Map;vy.biomes.forEach(t=>{xo.set(t.name,t.monsterPool)});function pt(t){return xo.get(t)??[]}const _y={name:"Grass Forest",floorRange:[1,10],tileColorOverrides:{[O.DUNGEON_FLOOR]:5025616,[O.WALL]:3046706},monsterTable:pt("GRASS_FOREST").map(t=>({id:t.id,weight:t.weight})),levelRange:[5,12],encounterRate:.1,trainerCount:[2,4],itemCount:[2,4],floorSizeRange:[15,25]},yy={name:"Cave Rock",floorRange:[11,20],tileColorOverrides:{[O.DUNGEON_FLOOR]:10395294,[O.WALL]:6381921},monsterTable:pt("CAVE_ROCK").map(t=>({id:t.id,weight:t.weight})),levelRange:[12,22],encounterRate:.12,trainerCount:[3,5],itemCount:[3,5],floorSizeRange:[20,30]},by={name:"Water Swamp",floorRange:[21,30],tileColorOverrides:{[O.DUNGEON_FLOOR]:5606191,[O.WALL]:3369246,[O.SWAMP]:3046706},monsterTable:pt("WATER_SWAMP").map(t=>({id:t.id,weight:t.weight})),levelRange:[22,32],encounterRate:.15,trainerCount:[4,6],itemCount:[3,6],floorSizeRange:[25,35]},Sy={name:"Fire Volcanic",floorRange:[31,40],tileColorOverrides:{[O.DUNGEON_FLOOR]:12531212,[O.WALL]:4073251,[O.LAVA]:16733986},monsterTable:pt("FIRE_VOLCANIC").map(t=>({id:t.id,weight:t.weight})),levelRange:[32,42],encounterRate:.18,trainerCount:[4,7],itemCount:[4,6],floorSizeRange:[30,40]},Ey={name:"Dark Haunted",floorRange:[41,50],tileColorOverrides:{[O.DUNGEON_FLOOR]:4342338,[O.WALL]:2171169,[O.DARK_FLOOR]:0},monsterTable:pt("DARK_HAUNTED").map(t=>({id:t.id,weight:t.weight})),levelRange:[42,55],encounterRate:.2,trainerCount:[5,8],itemCount:[4,7],floorSizeRange:[35,50]},Ja=[_y,yy,by,Sy,Ey];function Ae(t){const e=(t-1)%50+1;return Ja.find(n=>e>=n.floorRange[0]&&e<=n.floorRange[1])??Ja[Ja.length-1]}function Ro(t,e){const r=(t-1)%50+1,[n,s]=e.floorSizeRange,[a,i]=e.floorRange,c=i-a,o=c===0?0:(r-a)/c,d=Math.floor(n+(s-n)*Math.min(1,Math.max(0,o)));return{width:d,height:d}}const Fo="openmon_dungeon_meta";function uo(){return{bestFloor:0,totalRuns:0,totalCurrency:0}}function No(){try{const t=localStorage.getItem(Fo);if(!t)return uo();const e=JSON.parse(t);return{bestFloor:typeof e.bestFloor=="number"?e.bestFloor:0,totalRuns:typeof e.totalRuns=="number"?e.totalRuns:0,totalCurrency:typeof e.totalCurrency=="number"?e.totalCurrency:0}}catch{return uo()}}function Oy(t){try{localStorage.setItem(Fo,JSON.stringify(t))}catch{}}function Py(t){const e=No(),r={bestFloor:Math.max(e.bestFloor,t.currentFloor),totalRuns:e.totalRuns+1,totalCurrency:e.totalCurrency+t.runCurrency};return Oy(r),r}const wi=[233,234,235,236,237,238,239,240];class vi{runSeed="";currentFloor=0;isDungeonMode=!1;isRunActive=!1;currentBiome;defeatedTrainers=new Set;pickedItems=new Set;bestFloor=0;runCurrency=0;starterPicked=!1;prologueCompleted=!1;legendaryFloors=new Map;encounteredLegendaries=new Set;constructor(){const e=No();this.bestFloor=e.bestFloor}assignLegendaryFloors(e){this.legendaryFloors.clear();const r=new He(e+"-legendaries"),n=[];for(let a=20;a<=49;a++)a%5!==0&&a%5!==4&&n.push(a);const s=r.shuffle(n);for(let a=0;a<wi.length&&a<s.length;a++)this.legendaryFloors.set(s[a],wi[a]);console.log("[Legendary] Floor assignments:",Object.fromEntries(this.legendaryFloors))}startRun(e){this.isDungeonMode=!0,this.isRunActive=!0,this.currentFloor=0,this.runSeed=e??Date.now().toString(),this.currentBiome=Ae(1),this.defeatedTrainers.clear(),this.pickedItems.clear(),this.runCurrency=0,this.starterPicked=!1,this.prologueCompleted=!1,this.encounteredLegendaries.clear(),this.assignLegendaryFloors(this.runSeed)}advanceFloor(){this.currentFloor++,this.currentBiome=Ae(this.currentFloor)}endRun(e){return this.isRunActive=!1,this.currentFloor>this.bestFloor&&(this.bestFloor=this.currentFloor),e||(this.isDungeonMode=!1),this.legendaryFloors.clear(),this.encounteredLegendaries.clear(),Py(this)}restoreRun(e){this.isDungeonMode=!0,this.isRunActive=!0,this.runSeed=e.dungeonSeed??Date.now().toString(),this.defeatedTrainers=new Set(e.dungeonDefeated??[]),this.pickedItems=new Set(e.dungeonItems??[]),this.runCurrency=e.dungeonCurrency??0,this.starterPicked=e.dungeonStarterPicked??!1,this.prologueCompleted=e.dungeonPrologueCompleted??!1,this.currentFloor=(e.dungeonFloor??1)-1,this.currentBiome=Ae(this.currentFloor>0?this.currentFloor:1),this.legendaryFloors=new Map(e.dungeonLegendaryFloors??[]),this.legendaryFloors.size===0&&this.runSeed&&this.assignLegendaryFloors(this.runSeed),this.encounteredLegendaries=new Set(e.dungeonEncounteredLegendaries??[])}getCurrentFloorType(){return this.isFloorBoss(this.currentFloor)?"boss":this.isFloorRest(this.currentFloor)?"rest":"normal"}isFloorBoss(e){return e%5===0&&e>0}isFloorRest(e){return e%5===4&&e>0}getFloorSeed(){return qt(this.runSeed,this.currentFloor)}}const te=N(void 0),mS=Object.freeze(Object.defineProperty({__proto__:null,DungeonContext:vi,LEGENDARY_IDS:wi,dungeonContext:te},Symbol.toStringTag,{value:"Module"})),jt=new Map;function ky(t){const{width:e,height:r}=t,n=[];for(let a=0;a<r;a++)n[a]=new Array(e).fill(O.GRASS);for(const a of t.waterZones){const{x:i,y:c}=a.position;c>=0&&c<r&&i>=0&&i<e&&(n[c][i]=O.WATER)}for(const a of t.collisionsZones){const{x:i,y:c}=a.position;c>=0&&c<r&&i>=0&&i<e&&(n[c][i]=O.TREE_GROUND)}for(const a of t.battleZones){const{x:i,y:c}=a.position;c>=0&&c<r&&i>=0&&i<e&&(n[c][i]=O.TALL_GRASS)}const s=new Set;for(const a of t.battleZones)s.add(a.position.y*e+a.position.x);return{mapId:t.mapId,name:`map-${t.mapId}`,width:e,height:r,tiles:n,playerStart:t.playerInitialPosition,jonctions:t.jonctions,npcs:t.npcs,items:t.items,monsters:t.monsters,levelRange:t.levelRange,battleTileIndices:s,sound:t.sound,biome:"Overworld"}}const lt=8,Ay={forest:[...Array(35).fill(O.TREE_GROUND),...Array(20).fill(O.TALL_GRASS),...Array(12).fill(O.WATER),...Array(8).fill(O.FLOWER_GROUND),...Array(15).fill(O.WALL),...Array(10).fill(O.CLIFF_ROCK)],cave:[...Array(45).fill(O.WALL),...Array(40).fill(O.CLIFF_ROCK),...Array(15).fill(O.DUNGEON_FLOOR)],swamp:[...Array(30).fill(O.SWAMP),...Array(22).fill(O.WATER),...Array(18).fill(O.TREE_GROUND),...Array(8).fill(O.TALL_GRASS),...Array(12).fill(O.WALL),...Array(10).fill(O.CLIFF_ROCK)],volcanic:[...Array(35).fill(O.LAVA),...Array(38).fill(O.WALL),...Array(27).fill(O.CLIFF_ROCK)],dark:[...Array(30).fill(O.DARK_FLOOR),...Array(40).fill(O.WALL),...Array(30).fill(O.CLIFF_ROCK)]},My={"Grass Forest":"forest","Cave Rock":"cave","Water Swamp":"swamp","Fire Volcanic":"volcanic","Dark Haunted":"dark"};function Cy(t){const e={};for(const o of t)for(const d of o)e[d]=(e[d]??0)+1;const r=o=>e[o]??0,n=t.length*(t[0]?.length??1)||1,s=r(O.LAVA)/n,a=(r(O.SWAMP)+r(O.WATER))/n,i=r(O.DARK_FLOOR)/n,c=(r(O.DUNGEON_FLOOR)+r(O.WALL))/n;return s>.05?"volcanic":i>.05?"dark":a>.15?"swamp":c>.4?"cave":"forest"}const Iy=new Set([O.WALL,O.CLIFF_ROCK]);function Ty(t,e,r,n,s,a){let i;if(a)i=a;else{const b=t.slice(r,s-r).map(A=>A.slice(r,n-r));i=Cy(b)}const c=Ay[i],o=new He(`pad-${e}`),d=r,h=r,u=n-r,f=s-r,p=1,g=(b,A)=>A<h||A>=f||b<d||b>=u;for(let b=p;b<s-p;b++)for(let A=p;A<n-p;A++)g(A,b)&&(t[b][A]=o.pick(c));const y=t.map(b=>[...b]);for(let b=p;b<s-p;b++)for(let A=p;A<n-p;A++){if(!g(A,b))continue;const x=[[y[b-1]?.[A],A,b-1],[y[b+1]?.[A],A,b+1],[y[b][A-1],A-1,b],[y[b][A+1],A+1,b]].filter(([R,P,T])=>R!==void 0&&g(P,T)).map(([R])=>R),F=new Map;for(const R of x)F.set(R,(F.get(R)??0)+1);for(const[R,P]of F)if(P>=2){t[b][A]=R;break}}const S=new Map,E=r-1;for(let b=p;b<s-p;b++)for(let A=p;A<n-p;A++){if(!g(A,b)||!Iy.has(t[b][A]))continue;const D=Math.min(b<h?h-b-1:b-f,A<d?d-A-1:A-u),x=E>0?D/E:0,F=o.next()*.6-.3,R=Math.max(1,1+x*2+F);S.set(b*n+A,R)}return S}function Ti(t,e=lt,r){const n=t.width+e*2,s=t.height+e*2,a=[];for(let p=0;p<s;p++)a.push(new Array(n).fill(O.WALL));for(let p=0;p<t.height;p++)for(let g=0;g<t.width;g++)a[p+e][g+e]=t.tiles[p][g];const i=r?My[r]:void 0,c=Ty(a,t.mapId,e,n,s,i),o=new C(t.playerStart.x+e,t.playerStart.y+e),d=t.jonctions.map(p=>{const g=p.positions.map(S=>new C(S.x+e,S.y+e)),y=new C(p.start.x+e,p.start.y+e);return new ni(p.id,p.mapIdx,g,y)}),h=t.npcs.map(p=>{const g=Object.assign(Object.create(Object.getPrototypeOf(p)),p);return g.position=Object.assign(Object.create(Object.getPrototypeOf(p.position)),p.position),g.position.positionOnMap=new C(p.position.positionOnMap.x+e,p.position.positionOnMap.y+e),g.position.targetPosition=new C(p.position.targetPosition.x+e,p.position.targetPosition.y+e),g}),u=t.items.map(p=>{const g=Object.assign(Object.create(Object.getPrototypeOf(p)),p);return g.position=new C(p.position.x+e,p.position.y+e),g}),f=new Set;for(const p of t.battleTileIndices){const g=p%t.width,S=(Math.floor(p/t.width)+e)*n+(g+e);f.add(S)}return{...t,width:n,height:s,tiles:a,playerStart:o,jonctions:d,npcs:h,items:u,battleTileIndices:f,paddingHeightScales:c}}function gS(t){const e=jt.get(t.mapId);if(e)return e;let r=ky(t);return t.mapId<1e3&&(r=Ti(r)),jt.set(t.mapId,r),r}function Dy(t,e){jt.set(t,e)}function xy(t){jt.delete(t)}function re(t){return t!==O.WALL&&t!==O.LAVA&&t!==O.WATER}function Zt(t,e,r,n){const s=n==="bottom"?r-1:0,a=n==="bottom"?-1:1;for(let i=s;i>=0&&i<r;i+=a){const c=Math.floor(e/2);for(let o=0;o<e;o++){const d=c+o,h=c-o;if(d<e&&re(t[i][d]))return new C(d,i);if(h>=0&&re(t[i][h]))return new C(h,i)}}return new C(Math.floor(e/2),Math.floor(r/2))}function Bo(t,e,r,n){const s=[{dx:1,dy:0},{dx:-1,dy:0},{dx:0,dy:1},{dx:0,dy:-1}];for(const{dx:c,dy:o}of s){const d=e.x+c,h=e.y+o;if(d>=0&&d<r&&h>=0&&h<n&&re(t[h][d]))return new C(d,h)}const a=e.x+1,i=e.y;return t[i][a]=O.DUNGEON_FLOOR,new C(a,i)}function $o(t,e,r,n,s,a){const i=n.nextInt(2,5),c=[],o=new Set;o.add(`${s.x},${s.y}`),o.add(`${a.x},${a.y}`);const d=[];for(let f=1;f<r-1;f++)for(let p=1;p<e-1;p++)t[f][p]===O.DUNGEON_FLOOR&&d.push(new C(p,f));if(d.length===0)return c;const h=n.shuffle(d);let u=0;for(let f=0;f<i&&u<h.length;f++){const p=n.nextInt(3,8),g=[],y=h[u++];if(o.has(`${y.x},${y.y}`))continue;const S=new Set,E=[y];for(S.add(`${y.x},${y.y}`);E.length>0&&g.length<p;){const b=E.shift();if(!b)break;const A=`${b.x},${b.y}`;if(o.has(A)||t[b.y][b.x]!==O.DUNGEON_FLOOR)continue;g.push(b),t[b.y][b.x]=O.TALL_GRASS,o.add(A);const D=n.shuffle([new C(b.x+1,b.y),new C(b.x-1,b.y),new C(b.x,b.y+1),new C(b.x,b.y-1)]);for(const x of D){const F=`${x.x},${x.y}`;x.x>0&&x.x<e-1&&x.y>0&&x.y<r-1&&!S.has(F)&&(S.add(F),E.push(x))}}if(g.length>=3)c.push(g);else for(const b of g)t[b.y][b.x]=O.DUNGEON_FLOOR,o.delete(`${b.x},${b.y}`)}return c}function Lo(t,e,r,n,s,a){const[i,c]=s.trainerCount,o=n.nextInt(i,c),d=[],h=[];for(let f=1;f<r-1;f++)for(let p=1;p<e-1;p++)t[f][p]===O.DUNGEON_FLOOR&&Math.abs(p-a.x)+Math.abs(f-a.y)>=3&&h.push(new C(p,f));const u=n.shuffle(h);for(const f of u){if(d.length>=o)break;d.some(g=>Math.abs(g.x-f.x)+Math.abs(g.y-f.y)<5)||Ry(t,f,e,r)&&d.push(f)}return d}function Ry(t,e,r,n){const s=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}];for(const a of s){let i=0,c=e.x+a.dx,o=e.y+a.dy;for(;c>=0&&c<r&&o>=0&&o<n&&t[o][c]!==O.WALL;){if(i++,i>=3)return!0;c+=a.dx,o+=a.dy}}return!1}function Ho(t,e,r,n,s,a){const i=n.nextInt(a.itemCount[0],a.itemCount[1]),c=[],o=[];for(let h=1;h<r-1;h++)for(let u=1;u<e-1;u++)t[h][u]===O.DUNGEON_FLOOR&&Math.abs(u-s.x)+Math.abs(h-s.y)>=3&&o.push(new C(u,h));const d=n.shuffle(o);for(const h of d){if(c.length>=i)break;c.push(h)}return c}function Di(t,e,r,n,s,a,i,c,o,d){const h=t.map(f=>[...f]),u=new Set;for(let f=0;f<r;f++)for(let p=0;p<e;p++)h[f][p]===O.TALL_GRASS&&u.add(f*e+p);return{mapId:n,name:`Floor ${s}`,width:e,height:r,tiles:h,playerStart:a,jonctions:[],npcs:[],items:[],monsters:i,levelRange:c,battleTileIndices:u,sound:o,biome:d}}function ft(t,e,r,n,s,a,i,c){const o=[],d=[],h=[];for(let f=0;f<r;f++)for(let p=0;p<e;p++){const g=t[f][p],y=f*e+p;g===O.WALL?o.push(y):(g===O.LAVA||g===O.WATER)&&d.push(y),g===O.TALL_GRASS&&h.push(y)}const u={collisionIndices:o,waterIndices:d,battleIndices:h};return pe.fromSparse(n,"dungeon",e,r,u,a,s,i,[],void 0,void 0,void 0,c)}function Et(t,e){const r=lt,n=Ti(t.threlteMap,r,e?.name),s=ft(n.tiles,n.width,n.height,n.mapId,n.playerStart,n.monsters,n.levelRange,n.sound),a=i=>new C(i.x+r,i.y+r);return{threlteMap:n,openMap:s,playerStart:a(t.playerStart),stairsPosition:a(t.stairsPosition),starterItemPosition:a(t.starterItemPosition),trainerPositions:t.trainerPositions.map(a),itemPositions:t.itemPositions.map(a),grassPatches:t.grassPatches.map(i=>i.map(a))}}function Fy(t,e,r){const n=qt(t,e),s=new He(n),a=Ro(e,r),i=po(a.width,r.floorSizeRange[1]),c=po(a.height,r.floorSizeRange[1]),o=(e-1)%50+1,d=Math.min(1,Math.max(0,(o-1)/49)),h=Ny(i,c,s);By(h,i,c,s,d),$y(h,i,c,s,d);const u=Zt(h,i,c,"bottom"),f=Ly(h,i,c,u);h[f.y][f.x]=O.STAIRS_DOWN;const p=Bo(h,u,i,c),g=$o(h,i,c,s,u,f),y=Lo(h,i,c,s,r,u),S=Ho(h,i,c,s,u,r),E=1e3+e,b=r.monsterTable.map(x=>x.id),A=Di(h,i,c,E,e,u,b,r.levelRange,r.ambientTrack,r.name),D=ft(h,i,c,E,u,b,r.levelRange,r.ambientTrack);return{threlteMap:A,openMap:D,playerStart:u,starterItemPosition:p,stairsPosition:f,trainerPositions:y,itemPositions:S,grassPatches:g}}function po(t,e){return t%2===1?t:t+1<=e?t+1:t-1}function Ny(t,e,r){const n=[];for(let u=0;u<e;u++)n.push(new Array(t).fill(O.WALL));const s=(t-1)/2,a=(e-1)/2,i=Array.from({length:a},()=>new Array(s).fill(!1)),c=r.nextInt(0,s-1),o=r.nextInt(0,a-1);i[o][c]=!0,n[o*2+1][c*2+1]=O.DUNGEON_FLOOR;const d=[[c,o]],h=[[0,-1],[0,1],[-1,0],[1,0]];for(;d.length>0;){const[u,f]=d[d.length-1],p=[];for(const[g,y]of h){const S=u+g,E=f+y;S>=0&&S<s&&E>=0&&E<a&&!i[E][S]&&p.push([S,E])}if(p.length>0){const[g,y]=r.pick(p);n[f*2+1+(y-f)][u*2+1+(g-u)]=O.DUNGEON_FLOOR,i[y][g]=!0,n[y*2+1][g*2+1]=O.DUNGEON_FLOOR,d.push([g,y])}else d.pop()}return n}function Ge(t,e,r){return t+(e-t)*r}function By(t,e,r,n,s){const a=[],i=[];for(let E=1;E<r-1;E++)for(let b=1;b<e-1;b++){if(!re(t[E][b]))continue;let A=0;re(t[E-1][b])&&A++,re(t[E+1][b])&&A++,re(t[E][b-1])&&A++,re(t[E][b+1])&&A++,A>=3?a.push([b,E]):A===1&&i.push([b,E])}const c=Ge(1,0,s),o=Math.round(Ge(3,1,s));for(const[E,b]of i){if(!n.nextBool(c))continue;const A=n.nextInt(2,o),D=Math.floor(A/2),x=Math.max(1,E-D),F=Math.max(1,b-D),R=Math.min(e-2,E+D),P=Math.min(r-2,b+D);for(let T=F;T<=P;T++)for(let H=x;H<=R;H++)t[T][H]=O.DUNGEON_FLOOR}const d=n.shuffle([...a,...i]),h=e*r,u=Math.round(Ge(80,150,s)),f=Math.round(Ge(4,2,s)),p=Math.max(f,Math.floor(h/u)),g=n.nextInt(f,p),y=new Set;let S=0;for(const[E,b]of d){if(S>=g)break;const A=Math.round(Ge(6,4,s)),D=n.nextInt(3,A),x=n.nextInt(3,A),F=Math.floor(D/2),R=Math.floor(x/2),P=E-F,T=b-R,H=E+F,j=b+R;if(P<1||T<1||H>=e-1||j>=r-1)continue;let G=!1;for(const W of y){const[Y,B]=W.split(",").map(Number);if(Math.abs(Y-E)<5&&Math.abs(B-b)<5){G=!0;break}}if(!G){for(let W=T;W<=j;W++)for(let Y=P;Y<=H;Y++)t[W][Y]=O.DUNGEON_FLOOR;y.add(`${E},${b}`),S++}}}function $y(t,e,r,n,s){const a=[];for(let d=2;d<r-2;d++){let h=-1;for(let u=1;u<e-1;u++)re(t[d][u])?h===-1&&(h=u):(h!==-1&&u-h>=3&&a.push({y:d,xStart:h,xEnd:u-1,dir:"h"}),h=-1);h!==-1&&e-1-h>=3&&a.push({y:d,xStart:h,xEnd:e-2,dir:"h"})}for(let d=2;d<e-2;d++){let h=-1;for(let u=1;u<r-1;u++)re(t[u][d])?h===-1&&(h=u):(h!==-1&&u-h>=3&&a.push({y:h,xStart:d,xEnd:u-1,dir:"v"}),h=-1);h!==-1&&r-1-h>=3&&a.push({y:h,xStart:d,xEnd:r-2,dir:"v"})}const i=Ge(.6,.2,s),c=n.shuffle(a),o=Math.floor(c.length*i);for(let d=0;d<o;d++){const h=c[d],u=n.nextBool()?-1:1;if(h.dir==="h"){const f=h.y+u;if(f<1||f>=r-1)continue;for(let p=h.xStart;p<=h.xEnd;p++)t[f][p]=O.DUNGEON_FLOOR}else{const f=h.xStart+u;if(f<1||f>=e-1)continue;for(let p=h.y;p<=h.xEnd;p++)t[p][f]=O.DUNGEON_FLOOR}}}function Ly(t,e,r,n){const s=Math.floor(e/3),a=[],i=[];for(let h=1;h<r-1;h++)for(let u=1;u<e-1;u++){if(!re(t[h][u])||Math.abs(u-n.x)+Math.abs(h-n.y)<s)continue;const p=new C(u,h);i.push(p);let g=0;u>0&&re(t[h][u-1])&&g++,u<e-1&&re(t[h][u+1])&&g++,h>0&&re(t[h-1][u])&&g++,h<r-1&&re(t[h+1][u])&&g++,g===1&&a.push(p)}const c=a.length>0?a:i;let o,d=-1;for(const h of c){const u=Math.abs(h.x-n.x)+Math.abs(h.y-n.y);u>d&&(d=u,o=h)}return o||Zt(t,e,r,"top")}const Hy=.5,Vy=4,Wy=5,fo=500,mo=10;function jy(t,e,r){if((r.generationType??"maze")==="maze")try{return Et(Fy(t,e,r),r)}catch{return Et(Gt(e,r),r)}const s=performance.now();try{const a=Gy(t,e,r,s);return Et(a,r)}catch{return Et(Gt(e,r),r)}}function Gt(t,e){const r=mo,n=mo,s=1e3+t,a=[];for(let f=0;f<n;f++){const p=[];for(let g=0;g<r;g++)g===0||g===r-1||f===0||f===n-1?p.push(O.WALL):p.push(O.DUNGEON_FLOOR);a.push(p)}const i=new C(1,1),c=new C(2,1),o=new C(8,8);a[o.y][o.x]=O.STAIRS_DOWN;const d=e.monsterTable.map(f=>f.id),h=Di(a,r,n,s,t,i,d,e.levelRange,e.ambientTrack,e.name),u=ft(a,r,n,s,i,d,e.levelRange,e.ambientTrack);return{threlteMap:h,openMap:u,playerStart:i,starterItemPosition:c,stairsPosition:o,trainerPositions:[],itemPositions:[],grassPatches:[]}}function Gy(t,e,r,n){const s=qt(t,e),a=new He(s),{width:i,height:c}=Ro(e,r),o=Uy(i,c,a);for(let A=0;A<Vy;A++)Yy(o,i,c);if(performance.now()-n>fo||(Ky(o,i,c),performance.now()-n>fo))return Gt(e,r);const d=Zt(o,i,c,"bottom"),h=zy(o,i,c,d);o[h.y][h.x]=O.STAIRS_DOWN;const u=Bo(o,d,i,c),f=$o(o,i,c,a,d,h),p=Lo(o,i,c,a,r,d),g=Ho(o,i,c,a,d,r),y=1e3+e,S=r.monsterTable.map(A=>A.id),E=Di(o,i,c,y,e,d,S,r.levelRange,r.ambientTrack,r.name),b=ft(o,i,c,y,d,S,r.levelRange,r.ambientTrack);return{threlteMap:E,openMap:b,playerStart:d,starterItemPosition:u,stairsPosition:h,trainerPositions:p,itemPositions:g,grassPatches:f}}function Uy(t,e,r){const n=[];for(let s=0;s<e;s++){const a=[];for(let i=0;i<t;i++)i===0||i===t-1||s===0||s===e-1||r.nextBool(Hy)?a.push(O.WALL):a.push(O.DUNGEON_FLOOR);n.push(a)}return n}function Yy(t,e,r){const n=t.map(s=>[...s]);for(let s=1;s<r-1;s++)for(let a=1;a<e-1;a++)Xy(n,a,s)>=Wy?t[s][a]=O.WALL:t[s][a]=O.DUNGEON_FLOOR}function Xy(t,e,r){let n=0;for(let s=-1;s<=1;s++)for(let a=-1;a<=1;a++){if(a===0&&s===0)continue;const i=e+a,c=r+s;(c<0||c>=t.length||i<0||i>=t[0].length||t[c][i]===O.WALL)&&n++}return n}function Ky(t,e,r){const n=Array.from({length:r},()=>Array.from({length:e},()=>!1)),s=[];for(let c=0;c<r;c++)for(let o=0;o<e;o++)if(!n[c][o]&&re(t[c][o])){const d=qy(t,n,o,c,e,r);s.push(d)}if(s.length===0){for(let c=1;c<e-1;c++)t[Math.floor(r/2)][c]=O.DUNGEON_FLOOR;return}let a=0;for(let c=1;c<s.length;c++)s[c].length>s[a].length&&(a=c);const i=new Set(s[a].map(c=>`${c.x},${c.y}`));for(let c=0;c<r;c++)for(let o=0;o<e;o++)re(t[c][o])&&!i.has(`${o},${c}`)&&(t[c][o]=O.WALL)}function qy(t,e,r,n,s,a){const i=[],c=[new C(r,n)];for(;c.length>0;){const o=c.pop(),{x:d,y:h}=o;d<0||d>=s||h<0||h>=a||e[h][d]||re(t[h][d])&&(e[h][d]=!0,i.push(o),c.push(new C(d+1,h)),c.push(new C(d-1,h)),c.push(new C(d,h+1)),c.push(new C(d,h-1)))}return i}function zy(t,e,r,n){const s=Math.floor(e/2);let a,i=1/0;for(let c=0;c<r;c++)for(let o=0;o<e;o++)!re(t[c][o])||Math.abs(o-n.x)+Math.abs(c-n.y)<s||c<i&&(i=c,a=new C(o,c));return a||Zt(t,e,r,"top")}const Jy=[{id:"boss_floor_5",name:"Ranger Oakley",biome:"GRASS_FOREST",floor:5,spriteId:3,dialogBefore:["Wait... I know you. You're the Champion who fell.","I heard rumors someone was down here. Didn't think they were true."],dialogAfter:["You still fight like a Champion. Something is wrong above, isn't it?"],team:[{speciesId:20,levelOffset:3,heldItemId:null},{speciesId:13,levelOffset:3,heldItemId:4013},{speciesId:34,levelOffset:4,heldItemId:null}]},{id:"boss_floor_10",name:"Warden Thorn",biome:"GRASS_FOREST",floor:10,spriteId:5,dialogBefore:["Former Champion. I have sealed orders from the League.","No one passes this floor. Those are my instructions."],dialogAfter:["The orders felt strange. Someone high up wants this dungeon sealed.","I don't know why."],team:[{speciesId:21,levelOffset:4,heldItemId:4005},{speciesId:24,levelOffset:4,heldItemId:null},{speciesId:41,levelOffset:4,heldItemId:4006},{speciesId:14,levelOffset:5,heldItemId:null}]},{id:"boss_floor_15",name:"Miner Slate",biome:"CAVE_ROCK",floor:15,spriteId:7,dialogBefore:["I'm under contract. Someone called V paid good money to watch these tunnels.","You keep going deeper, you'll find more of us."],dialogAfter:["V said you'd come eventually. Seemed scared of you, honestly."],team:[{speciesId:66,levelOffset:3,heldItemId:4007},{speciesId:80,levelOffset:3,heldItemId:null},{speciesId:134,levelOffset:4,heldItemId:4013}]},{id:"boss_floor_20",name:"Foreman Basalt",biome:"CAVE_ROCK",floor:20,spriteId:9,dialogBefore:["This dungeon wasn't always guarded. V reorganized everything after your defeat.","The whole structure changed. Guards on every floor, watchers in every tunnel."],dialogAfter:["V needed the Champion gone to access what's below. That's all I know."],team:[{speciesId:81,levelOffset:4,heldItemId:4001},{speciesId:70,levelOffset:4,heldItemId:null},{speciesId:83,levelOffset:5,heldItemId:4008},{speciesId:142,levelOffset:5,heldItemId:null}]},{id:"boss_floor_25",name:"Captain Coral",biome:"WATER_SWAMP",floor:25,spriteId:2,dialogBefore:["I was a League official once. Then I was reassigned down here.","The League didn't just look away from what happened to you. They helped V."],dialogAfter:["Your replacement as Champion? Handpicked by V.","The League is complicit in all of this."],team:[{speciesId:122,levelOffset:4,heldItemId:4010},{speciesId:114,levelOffset:4,heldItemId:null},{speciesId:111,levelOffset:5,heldItemId:4004}]},{id:"boss_floor_30",name:"Admiral Murk",biome:"WATER_SWAMP",floor:30,spriteId:4,dialogBefore:["There's an artifact at the bottom of this dungeon. Ancient. Powerful.","V wants it to rewrite the bond between trainers and Pokemon.","Every Pokemon in the region would answer to them."],dialogAfter:["If V gets that artifact, the world you knew is over."],team:[{speciesId:120,levelOffset:5,heldItemId:4007},{speciesId:124,levelOffset:5,heldItemId:null},{speciesId:109,levelOffset:5,heldItemId:null},{speciesId:126,levelOffset:5,heldItemId:4002}]},{id:"boss_floor_35",name:"Pyro Ember",biome:"FIRE_VOLCANIC",floor:35,spriteId:6,dialogBefore:["You don't recognize me, do you? We trained together once.","V was your ally. Your friend. The betrayal was personal, Champion."],dialogAfter:["You still fight like a Champion. That's why V didn't challenge you openly.","They knew they couldn't beat you fairly."],team:[{speciesId:194,levelOffset:5,heldItemId:4011},{speciesId:191,levelOffset:5,heldItemId:null},{speciesId:201,levelOffset:5,heldItemId:4004}]},{id:"boss_floor_40",name:"Inferno Rex",biome:"FIRE_VOLCANIC",floor:40,spriteId:8,dialogBefore:["V is waiting at Floor 50. The artifact chamber is real.","I'm V's final lieutenant. You won't get past me."],dialogAfter:["V changed after finding that inscription. Said the old ways of training were broken.","You were just in the way."],team:[{speciesId:9,levelOffset:5,heldItemId:4003},{speciesId:192,levelOffset:6,heldItemId:4008},{speciesId:197,levelOffset:6,heldItemId:4005},{speciesId:203,levelOffset:6,heldItemId:null}]},{id:"boss_floor_45",name:"Phantom Nyx",biome:"DARK_HAUNTED",floor:45,spriteId:1,dialogBefore:["I understand why V wants the artifact. Power no trainer should have.","But I stand here out of duty, not belief. The darkness demands balance."],dialogAfter:["V isn't evil. Just consumed by what they found below.","Five more floors. Then you'll understand everything."],team:[{speciesId:47,levelOffset:6,heldItemId:4002},{speciesId:96,levelOffset:6,heldItemId:4007},{speciesId:49,levelOffset:6,heldItemId:null},{speciesId:87,levelOffset:6,heldItemId:4014}]},{id:"boss_floor_50",name:"V",biome:"DARK_HAUNTED",floor:50,spriteId:10,dialogBefore:["So you crawled all the way down here. I left you on that cliff hoping you'd stay broken. You always were stubborn.","You want to know why? The bond between trainer and Pokemon is a cage. The artifact below us can shatter it. Every Pokemon, free. No more masters.","But you... you'd never understand. You were the perfect Champion -- loved, admired, blind. This ends now. One final battle."],dialogAfter:["...You're still the Champion. You always were. I thought if I took everything from you, you'd become like me. But you came back stronger.","The artifact is yours. Destroy it, keep it -- I don't care anymore. Maybe the old way wasn't so broken after all."],team:[{speciesId:150,levelOffset:7,heldItemId:4003},{speciesId:160,levelOffset:7,heldItemId:4004},{speciesId:94,levelOffset:7,heldItemId:4006},{speciesId:75,levelOffset:7,heldItemId:4007},{speciesId:47,levelOffset:7,heldItemId:null},{speciesId:130,levelOffset:8,heldItemId:4002}]}],Zy={bosses:Jy},Qy=Zy,Ot=Qy.bosses;function eb(t){if(t<=0||t%5!==0)return;const e=((t/5-1)%Ot.length+Ot.length)%Ot.length;return Ot[e]}const tb=Array.from({length:21},(t,e)=>38+e),rb=[...Array.from({length:22},(t,e)=>13+e),37,...Array.from({length:29},(t,e)=>61+e)],Za=[{minFloor:1,maxFloor:5,trainerCount:[1,1],pokemonPerTrainer:[1,2]},{minFloor:6,maxFloor:10,trainerCount:[2,2],pokemonPerTrainer:[1,2]},{minFloor:11,maxFloor:20,trainerCount:[2,3],pokemonPerTrainer:[2,3]},{minFloor:21,maxFloor:30,trainerCount:[3,4],pokemonPerTrainer:[2,4]},{minFloor:31,maxFloor:1/0,trainerCount:[3,5],pokemonPerTrainer:[3,5]}];function Vo(t){return Za.find(e=>t>=e.minFloor&&t<=e.maxFloor)??Za[Za.length-1]}function go(t,e,r,n,s,a=s.nextInt(1e3,9999)){const i=["Trainer","Dungeon Trainer","Explorer","Challenger","Hiker","Camper"],c=s.pick(i),o=s.pick(rb),d=s.nextInt(0,1)===0?"MALE":"FEMALE",h=Vo(r),u=s.nextInt(h.pokemonPerTrainer[0],h.pokemonPerTrainer[1]),f=r+2,p=[];for(let b=0;b<u;b++){const A=s.pick(n.monsterTable).id,D=Math.max(1,Math.min(f+s.nextInt(0,2),100));p.push({speciesId:A,level:D})}const g=p.map(b=>b.speciesId),y=Math.max(...p.map(b=>b.level)),S=new ee("onSight",[new Lt(a),new J([new L(s.pick(["I was looking for items, but a battle is better!","You won't get past me!","My Pokemon are ready for you!","A challenger! Finally!"]),c)]),new Ht(a),new hi(100+r*10+y),new J([new L(s.pick(["You are stronger than you look...","Well played!","I need more training.","Take your reward and go"]),c)]),new ui(a)]),E=new ce(a,c,o,t,e,d,g,void 0,S);return E.dungeonTeam=p,E}function Wo(t,e,r,n,s=n.nextInt(1e4,19999)){const a=eb(e);if(a){const g=e+2,y=a.team.map(T=>({speciesId:T.speciesId,level:Math.min(g+T.levelOffset,120),heldItemId:T.heldItemId??void 0})),S=a.name,E=y.map(T=>T.speciesId),b=Math.max(...y.map(T=>T.level)),D=(Array.isArray(a.dialogBefore)?a.dialogBefore:[a.dialogBefore]).map(T=>new L(T,S)),F=(Array.isArray(a.dialogAfter)?a.dialogAfter:[a.dialogAfter]).map(T=>new L(T,S)),R=new ee("onSight",[new Lt(s),new J(D),new Ht(s),new hi(500+e*50+b*5),new J(F),new ui(s)]),P=new ce(s,S,a.spriteId,t,"down","MALE",E,void 0,R);return P.dungeonTeam=y,P}const i="Floor Boss",c=e+2,o=n.nextInt(3,6),d=Math.max(1,Math.min(c+5,120)),h=[];for(let g=0;g<o;g++){const y=n.pick(r.monsterTable).id;h.push({speciesId:y,level:d})}const u=h.map(g=>g.speciesId),f=new ee("onSight",[new Lt(s),new J([new L("I am the guardian of this floor!",i),new L("Prove your worth in battle!",i)]),new Ht(s),new hi(500+e*50+d*5),new J([new L("Impressive. You may proceed to the next floor.",i)]),new ui(s)]),p=new ce(s,i,n.pick(tb),t,"down","MALE",u,void 0,f);return p.dungeonTeam=h,p}function sb(t,e,r,n){const s=[],a=e%5===0,i=t.trainerPositions,c=Vo(e),o=n.nextInt(c.trainerCount[0],c.trainerCount[1]);if(a&&i.length>0){const d=i[i.length-1],h=i.slice(0,-1),u=Math.min(h.length,o);for(let p=0;p<u;p++){const g=h[p],y=n.pick(["up","down","left","right"]),S=100+p;s.push(go(g,y,e,r,n,S))}const f=100+u;s.push(Wo(d,e,r,n,f))}else{const d=Math.min(i.length,o);for(let h=0;h<d;h++){const u=i[h],f=n.pick(["up","down","left","right"]),p=100+h;s.push(go(u,f,e,r,n,p))}}return s}const nb=10,ab=10,ib={4:200,17:200,33:600,28:1500},wo=[{id:"4001",price:3e3},{id:"4002",price:3e3},{id:"4003",price:3e3},{id:"4004",price:3500},{id:"4005",price:2e3},{id:"4006",price:2500},{id:"4007",price:2e3},{id:"4008",price:3e3}],vo={4:"The Champion fell silently. No one witnessed it. That was the point.",9:"Sealed orders from the League: 'Dungeon access restricted until further notice. By order of V.'",14:"Research log: The artifact resonates with Pokemon energy. It could amplify — or sever — the bond.",19:"V's journal: 'The Champion trusted me. That made it easy. I almost felt guilty. Almost.'",24:"League memo: 'The restructuring is proceeding as planned. The old Champion is no longer a concern.'",29:"The artifact was never meant to be wielded by a single trainer. The ancients sealed it for a reason.",34:"V's journal: 'I can feel it calling from below. Once I have it, no trainer will ever control a Pokemon by force again.'",39:"Final entry: 'If anyone reads this, I failed to stop V. The Champion — if you survived — please.'"};function ob(t,e){const r=nb,n=ab,s=1e3+t,a=[];for(let y=0;y<n;y++){const S=[];for(let E=0;E<r;E++)E===0||E===r-1||y===0||y===n-1?S.push(O.WALL):S.push(O.REST_FLOOR);a.push(S)}const i=new C(Math.floor(r/2),n-2),c=new C(Math.floor(r/2),1);a[c.y][c.x]=O.STAIRS_DOWN;const o=hb(t),d=ub(t),h=[o,d],u={mapId:s,name:`Rest Floor ${t}`,width:r,height:n,tiles:a.map(y=>[...y]),playerStart:i,jonctions:[],npcs:h,items:[],monsters:[],levelRange:[1,1],battleTileIndices:new Set},f=[];for(let y=0;y<n;y++)for(let S=0;S<r;S++)a[y][S]===O.WALL&&f.push(y*r+S);const p={collisionIndices:f,waterIndices:[],battleIndices:[]},g=pe.fromSparse(s,"dungeon",r,n,p,[],i,[1,1],[],void 0,h);if(vo[t]){const y=new C(7,5),S=new ut("Note",!0,y,"src/assets/menus/pokeball.png",void 0,[new ee("onInteract",[new J([new L(vo[t],"System")])])]);g.items.push(S),u.items.push(S)}return{threlteMap:u,openMap:g,playerStart:i,starterItemPosition:new C(0,0),stairsPosition:c,trainerPositions:[],itemPositions:[],grassPatches:[]}}const lb=15,cb=15;function db(t,e){const r=qt(e,t),n=new He(r),s=lb,a=cb,i=1e3+t,c=[];for(let E=0;E<a;E++){const b=[];for(let A=0;A<s;A++)A===0||A===s-1||E===0||E===a-1?b.push(O.BOSS_GATE):b.push(O.DUNGEON_FLOOR);c.push(b)}const o=new C(Math.floor(s/2),a-2),d=new C(Math.floor(s/2),1);c[d.y][d.x]=O.STAIRS_DOWN;const h=Ae(t),u=new C(Math.floor(s/2),Math.floor(a/2)),f=Wo(u,t,h,n),p={mapId:i,name:`Boss Floor ${t}`,width:s,height:a,tiles:c.map(E=>[...E]),playerStart:o,jonctions:[],npcs:[f],items:[],monsters:[],levelRange:h.levelRange,battleTileIndices:new Set},g=[];for(let E=0;E<a;E++)for(let b=0;b<s;b++)c[E][b]===O.BOSS_GATE&&g.push(E*s+b);const y={collisionIndices:g,waterIndices:[],battleIndices:[]},S=pe.fromSparse(i,"dungeon",s,a,y,[],o,h.levelRange,[],void 0,[f]);return{threlteMap:p,openMap:S,playerStart:o,starterItemPosition:new C(0,0),stairsPosition:d,trainerPositions:[u],itemPositions:[],grassPatches:[]}}function hb(t){const e=new ee("onInteract",[new J([new L("Welcome, weary traveler!"),new L("Would you like me to heal your team?","Healer",["Yes, please","No, thanks"])]),new So(0),new J([new L("Your team is fully healed! Good luck ahead.","Healer")])],void 0,!0);return new ce(9e3+t*10,"Healer",3,new C(3,4),"down","FEMALE",void 0,void 0,e,void 0,void 0,!0)}function ub(t){const e=Math.floor(t/5),r=wo[e%wo.length],n={...ib,[r.id]:r.price},s=new ee("onInteract",[new J([new L("Looking for supplies for your journey?","Merchant",["Browse shop","No, thanks"])]),new bo(n,0),new J([new L("Come back anytime!","Merchant")])],void 0,!0);return new ce(9001+t*10,"Merchant",3,new C(6,4),"down","MALE",void 0,void 0,s,void 0,void 0,!0)}const pb=10,fb=10,mb={233:"Articuno",234:"Zapdos",235:"Moltres",236:"Marshadow",237:"Magearna",238:"Zeraora",239:"Diancie",240:"Darkrai"},gb={233:144,234:145,235:146,236:802,237:801,238:807,239:719,240:491};function wb(t,e,r,n,s,a){const i=pb,c=fb,o=9500+t,d=[];for(let F=0;F<c;F++){const R=[];for(let P=0;P<i;P++)P===0||P===i-1||F===0||F===c-1?R.push(O.WALL):R.push(O.REST_FLOOR);d.push(R)}const h=new C(Math.floor(i/2),c-2),u=new C(Math.floor(i/2),c-1),f=new C(Math.floor(i/2),3),p=[];if(!a){const F=Math.min(t+5,100),R=mb[e]??"Legendary",P=gb[e]??e,T=new ce(9700+t,R,P,f,"down","MALE",void 0,void 0,new ee("onInteract",[new J([new L(`A wild ${R} appears!`,"System")]),new Eo(e,F,20)],void 0,!1));p.push(T)}const g={mapId:o,name:`Legendary Room (Floor ${t})`,width:i,height:c,tiles:d.map(F=>[...F]),playerStart:h,jonctions:[],npcs:p,items:[],monsters:[],levelRange:[t,Math.min(t+10,100)],battleTileIndices:new Set},y=Ti(g,lt),S=new C(u.x+lt,u.y+lt),E=new ni(8600+t,r,[S],n);y.jonctions.push(E),y.legendaryPortals||(y.legendaryPortals=[]),y.legendaryPortals.push({x:S.x,y:S.y});const b=ft(y.tiles,y.width,y.height,o,y.playerStart,[],y.levelRange);b.npcs=y.npcs,b.jonctions=y.jonctions;const A=S.y*y.width+S.x;b.removeCollisionAt(A);const D={threlteMap:y,openMap:b,playerStart:y.playerStart,stairsPosition:y.playerStart,starterItemPosition:y.playerStart,trainerPositions:[],itemPositions:[],grassPatches:[]},x=new ni(8500+t,o,[s],y.playerStart);return{sideRoomFloorData:D,mainFloorJonction:x}}const vb=[4,17],_b=[3,26],yb=[2,25,28];function bb(t,e,r){const n=[],s=r.shuffle(t),a=Sb(e);for(let i=0;i<s.length;i++){const c=r.pick(a),o=s[i],d=`${e}-${i}`,u=_e(te)?.pickedItems.has(d)??!1,f=new ut("Item",!0,o,"src/assets/menus/pokeball.png",void 0,[new ee("onInteract",[new ki(c,1),new Yt(()=>{const p=_e(te);p&&p.pickedItems.add(d)})])]);f.id=200+i,f.pickedUp=u,n.push(f)}return n}function Sb(t){return t<=10?vb:t<=25?_b:yb}function Qa(t,e,r){const n=e.getActiveSave();n&&(n.dungeonSeed=t.runSeed,n.dungeonFloor=t.currentFloor,n.dungeonDefeated=Array.from(t.defeatedTrainers),n.dungeonItems=Array.from(t.pickedItems),n.dungeonCurrency=t.runCurrency,n.dungeonActive=t.isRunActive,n.dungeonStarterPicked=t.starterPicked,n.dungeonPrologueCompleted=t.prologueCompleted,r?.explorationTracker&&(n.dungeonExplored=r.explorationTracker.exportVisited()),r?.playerX!==void 0&&(n.dungeonPlayerX=r.playerX),r?.playerY!==void 0&&(n.dungeonPlayerY=r.playerY),e.persist(n))}const xi=new Map;function Eb(t){return xi.get(t)}function Ue(t,e){xi.set(t,e)}function ei(t){xi.delete(t),xy(t)}function Ob(t,e,r=3){const n=[];for(let s=1;s<=r;s++){const a=new C(t.x,t.y);switch(e){case"up":a.y-=s;break;case"down":a.y+=s;break;case"left":a.x-=s;break;case"right":a.x+=s;break}n.push(a)}return n}const _i=99,Pb=8,kb=12,Ut=new C(3,3),Ab=new C(3,5),Mb=new C(5,3),dt=new C(4,9);function Cb(){return new ee("onEnter",[new J([new L("...Where am I? My body aches...","thought"),new L("How long have I been lying here?","thought"),new L("I remember... a battle.","thought"),new L("I lost.","thought"),new L("They took everything.","thought"),new L("My team... gone.","thought"),new L("There's something on the ground nearby. A Pokeball... ","thought"),new L("A Pokeball...")])])}function Ib(){return new ut("Note",!0,Ab,"src/assets/menus/pokeball.png",void 0,[new ee("onInteract",[new J([new L("A crumpled note, stained with dirt.","System"),new L("The handwriting is sharp, deliberate.","System"),new L("'You should have stayed down, Champion.'","System"),new L("'What lies below is not for you.'","System"),new L("'Do not follow me. — V'","System"),new L("V... That initial. I've seen it before.","thought")])])])}function Tb(){return new ut("Pokeball",!0,Mb,"src/assets/menus/pokeball.png",void 0,[new ee("onInteract",[new J([new L("A cracked Pokeball. It's still warm...","System")]),new Yt(t=>{const e=_e(te);if(!e)return;const r=t.POKEDEX.findById(50).result?.instanciate(5,25,!0);if(r){t.player.monsters.push(r),t.player.setFollower(r),t.POKEDEX.setCaught(50),e.starterPicked=!0,e.prologueCompleted=!0,t.updateMenuAvailability(),te.set(e);const n=t.map.scripts?.find(s=>s.triggerType==="onStep"&&s.stepPosition?.x===dt.x&&s.stepPosition?.y===dt.y);n&&(n.replayable=!1,n.played=!0)}}),new J([new L("Eevee !","self"),new L("Vee !","follower"),new L("Maybe there's a way out of here...","thought")])])])}function Db(){return new ee("onStep",[new J([new L("I can't go in there without a Pokemon.","thought"),new L("I need to look around first.","thought")]),new yo],dt,!0)}function xb(){const t=Pb,e=kb,r=_i,n=O.CLIFF_ROCK,s=O.DUNGEON_FLOOR,a=O.STAIRS_DOWN,i=[];for(let S=0;S<e;S++){const E=[];for(let b=0;b<t;b++)S<=1||S>=10||b<=1||b>=6?E.push(n):E.push(s);i.push(E)}i[dt.y][dt.x]=a;const c=new C(Ut.x,Ut.y),o=Cb(),d=Db(),h=Ib(),u=Tb(),f=[];for(let S=0;S<e;S++)for(let E=0;E<t;E++)i[S][E]===n&&f.push(S*t+E);const p={mapId:r,name:"Cliffside Prologue",width:t,height:e,tiles:i.map(S=>[...S]),playerStart:c,jonctions:[],npcs:[],items:[h,u],monsters:[],levelRange:[1,1],battleTileIndices:new Set},g={collisionIndices:f,waterIndices:[],battleIndices:[]};return{openMap:pe.fromSparse(r,"dungeon",t,e,g,[],c,[1,1],[],void 0,[],[o,d],void 0,[h,u]),threlteMap:p}}function Rb(t){const{openMap:e,threlteMap:r}=xb();return Ue(r.mapId,r),Dy(r.mapId,r),t[e.mapId]=e,{openMap:e,threlteMap:r}}const Fb=!0;class Nb{ITEMS=new Ke;POKEDEX=new oi;MAPS={};id;updated;created;isNewGame;player;boxes;map;settings;questStates=[];quests=[];currentQuest;flags;overWorldContext;battleContext=N(void 0);menuAvailability$=N({});playTimeStart=Date.now();savedPlayTime=0;audioManager;soundManager;questManager;scriptRunner;hasEvolutions=!1;spawned;savesHolder;viewedGuides;notifications=new oy;weather;constructor(e){this.id=e.id,this.POKEDEX=new oi(e.savedEntry),this.player=Q.fromInstance(e.player),this.boxes=e.boxes.map(s=>new fi(s.name,s.values.map(a=>a||void 0))),Rb(this.MAPS);const r=this.MAPS[e.currentMap.mapId]??pe.empty();this.map=pe.fromInstance(r,e.isNewGame?r.playerInitialPosition:e.player.position.positionOnMap),this.map.items=this.map.items.filter(s=>!e.currentMap.pickedItems.includes(s.id||0)),this.settings=e.settings,this.isNewGame=e.isNewGame,this.created=e.created,this.updated=e.updated,this.overWorldContext=new aw(this.map),this.player.position=new Le(this.map.playerInitialPosition),this.viewedGuides=e.viewedGuides,this.audioManager=new ly,this.soundManager=new my(this.settings),this.questManager=new cy(e.questStates,e.flags,this.notifications),this.questManager.onObjectiveComplete=()=>this.updateMenuAvailability(),this.scriptRunner=new dy,this.savedPlayTime=e.playTime||0,this.playTimeStart=Date.now(),this.questStates=this.questManager.questStates,this.quests=this.questManager.quests,this.currentQuest=this.questManager.currentQuest,this.flags=this.questManager.flags;const n=this.scriptRunner.collectAllScripts(this.map.scripts,this.map.npcs);this.scriptRunner.indexScripts(n),this.bindKeys(),this.checkForGameStart(),this.loadMap(this.map),this.startWeatherLoop(),this.updateMenuAvailability()}startWeatherLoop(){this.weather={type:"RAIN",started:new Date,running:!0,intervalId:1}}validateQuestObjective(e,r){const n=this.quests.find(a=>a.id===e),s=n?.objectives.find(a=>a.id===r);if(s){s.complete();const a=this.questStates.find(i=>i.id===e);if(a){const i=a.objectives.find(c=>c.id===r);i&&(i.completed=!0,this.notifications.notify(`Objective completed: ${s.description}`),this.updateMenuAvailability(),n&&a.objectives.every(c=>c.completed)&&(a.completed=!0,this.notifications.notify(`Quest completed: ${n.name}`),this.currentQuest=this.quests.find(c=>c.id===e+1)||void 0,this.currentQuest&&this.notifications.notify(`New quest: ${this.currentQuest.name}`)))}else n&&this.questStates.push(new Jt(e,!1,n.objectives.map(i=>new zt(i.id,i.completed))))}}isMenuAvailable(e){const r=this.player.monsters.length>0;switch(e){case q.POKEMON_LIST:case q.BOX:case q.POKEDEX:case q.TRAINER:case q.BAG:return r;default:return!1}}updateMenuAvailability(){this.menuAvailability$.set({[q.MAIN]:!0,[q.POKEMON_LIST]:this.isMenuAvailable(q.POKEMON_LIST),[q.SWITCH]:!0,[q.BAG]:this.isMenuAvailable(q.BAG),[q.SUMMARY]:!0,[q.BOX]:this.isMenuAvailable(q.BOX),[q.POKEDEX]:this.isMenuAvailable(q.POKEDEX),[q.TRAINER]:this.isMenuAvailable(q.TRAINER),[q.MAP]:!0})}bindKeys(){this.overWorldContext.keys.a.subscribe(e=>{if(e&&!this.overWorldContext.getPaused()){const r=this.map?.elementInFront(this.player.position.positionOnMap,this.player.position.direction)||this.followerInFront();let n=r?.interact(this.player.position.positionOnMap,this);r||(n=this.map?.elementBehindCounter(this.player.position.positionOnMap,this.player.position.direction)?.interact(this.player.position.positionOnMap,this));const s=n?.[0],a=n?.[1];s?this.playScript(s,a):a?.resume(this)}}),this.overWorldContext.keys.up.subscribe(e=>{this.handleDirectionKey(e,"up")}),this.overWorldContext.keys.down.subscribe(e=>{this.handleDirectionKey(e,"down")}),this.overWorldContext.keys.left.subscribe(e=>{this.handleDirectionKey(e,"left")}),this.overWorldContext.keys.right.subscribe(e=>{this.handleDirectionKey(e,"right")})}followerInFront(){const e=new C(this.player.position.positionOnMap.x,this.player.position.positionOnMap.y);switch(this.player.position.direction){case"up":e.y-=1;break;case"down":e.y+=1;break;case"left":e.x-=1;break;case"right":e.x+=1;break}if(this.player.follower&&this.player.follower.position.positionOnMap.x===e.x&&this.player.follower.position.positionOnMap.y===e.y)return this.player.follower}handleDirectionKey(e,r){if(e&&!this.overWorldContext.getPaused()&&(this.player.position.targetDirection=r),!(this.player.position.positionOnMap.x!==this.player.position.targetPosition.x||this.player.position.positionOnMap.y!==this.player.position.targetPosition.y)&&e&&!this.overWorldContext.getPaused()){this.player.position.targetDirection!==this.player.position.direction&&(this.player.position.direction=this.player.position.targetDirection);const n=d=>this.player.position.direction==="left"?d-1:this.player.position.direction==="right"?d+1:d,s=d=>this.player.position.direction==="up"?d-1:this.player.position.direction==="down"?d+1:d,a=n(this.player.position.targetPosition.x),i=s(this.player.position.targetPosition.y);if(Math.abs(a-this.player.position.positionOnMap.x)>1||Math.abs(i-this.player.position.positionOnMap.y)>1)return;const c=new C(a,i),o={...this.player.position.positionOnMap};if(!this.map.hasBoundaryAt(c)){const d=this.map?.jonctionAt(c);if(d&&d.mapIdx>=9500){this.changeMap(d);return}this.currentQuest&&this.hasQuestLimit(c)?this.playScript(new ee("onStep",[new J([new L(this.currentQuest.leaveMessage)])])):(this.player.moving=!0,this.player.position.setFuturePosition(a,i,()=>{this.checkForStepInScript(),this.checkForJunction(),this.checkForStairs(),this.checkForBattle(),this.checkForInSight(),this.player.follower&&(this.player.follower.stepCounter+=1,this.player.follower.position.direction=this.player.position.direction,this.player.follower.moving=!0,this.player.follower.position.setFuturePosition(o.x,o.y));const h=this.overWorldContext.keys.getHeldDirection();h&&this.handleDirectionKey(!0,h)}))}}}hasQuestLimit(e){return!!this.currentQuest&&!!this.currentQuest.area&&this.isOutsideQuestBounds(e,this.currentQuest.area)}isOutsideQuestBounds(e,r){return e.x<r.start.x||e.x>r.end.x||e.y<r.start.y||e.y>r.end.y}checkForGameStart(){if(this.isNewGame&&!this.overWorldContext.scenes.wakeUp){const e=_e(te);if(e&&!e.prologueCompleted){const n=this.MAPS[_i];return n&&(this.map=pe.fromInstance(n,Ut),this.player.position=new Le(Ut)),this.overWorldContext.startScene(et.PROLOGUE),setTimeout(()=>{this.overWorldContext.endScene(et.PROLOGUE),this.isNewGame=!1},5e3),!0}const r=this.scriptRunner.getByTrigger("onGameStart");return this.overWorldContext.startScene(et.WAKE_UP),setTimeout(()=>{this.overWorldContext.endScene(et.WAKE_UP),this.isNewGame=!1,r&&this.playScript(r,void 0,()=>{this.questManager.notifyCurrentQuest()})},5e3),!0}else this.questManager.notifyCurrentQuest();return!1}checkForJunction(){if(this.map===void 0)return;const e=this.map.jonctionAt(this.player.position.positionOnMap);e!==void 0&&this.changeMap(e)}changeMap(e){const r=e.mapIdx>=9500;this.audioManager.fadeOutMapSound(),this.scriptRunner.interruptCurrent(),this.map?.npcs.forEach(s=>s.movingScript?.interrupt()),this.scriptRunner.clear();const n=()=>{const s=pe.fromInstance(this.MAPS[e.mapIdx],new C(0,0));this.player.position.setPosition(e.start||new C(0,0)),this.loadMap(s)};r?(this.overWorldContext.setPaused(!0,"portal-animation"),this.overWorldContext.portalAnimating=!0,setTimeout(()=>{this.overWorldContext.changingMap=!0},550),setTimeout(()=>{this.overWorldContext.portalAnimating=!1,this.overWorldContext.setPaused(!1,"portal-animation"),n()},900)):n()}playMapSound(){this.audioManager.playMapSound(this.map?.sound)}loadMap(e){this.overWorldContext.changingMap=!0;let r;e.scripts&&e.scripts?.length>0&&(r=e.scripts?.find(a=>a.triggerType==="onEnter"));const n=e.npcs?.filter(a=>a.movingScript);this.map=e,this.overWorldContext.map=e;const s=this.scriptRunner.collectAllScripts(e.scripts,e.npcs);this.scriptRunner.indexScripts(s),setTimeout(()=>{this.overWorldContext.changingMap=!1,this.playMapSound(),r&&this.playScript(r),n?.length>0&&this.scriptRunner.playMovements(n,this)},1800),setTimeout(()=>{},2e3)}checkForStepInScript(){let e;return this.map?.scripts&&this.map.scripts?.length>0&&!this.scriptRunner.isPlaying()&&(e=this.map.scripts.find(r=>r.triggerType==="onStep"&&r.stepPosition?.x===this.player.position.positionOnMap.x&&r.stepPosition?.y===this.player.position.positionOnMap.y)),(e!==void 0&&!e?.played||e?.replayable)&&this.playScript(e),e}checkForBattle(){const e=_e(te),r=e?.isDungeonMode&&e?.isRunActive?Ae(e.currentFloor).encounterRate:.07;if(this.map&&this.map.hasBattleZoneAt(this.player.position.positionOnMap)&&Math.random()<r){const n=this.map.randomMonster();let s;if(e?.isDungeonMode&&e?.isRunActive){const a=Math.floor(Math.random()*3)-1;s=Math.max(1,Math.min(e.currentFloor+2+a,100))}else s=Math.floor(this.player.monsters.reduce((a,i)=>a+i.level,0)/this.player.monsters.length)-1;this.startBattle(this.POKEDEX.findById(n.id).result.instanciate(s),ye.SINGLE)}}checkForStairs(){const e=_e(te);if(!e?.isDungeonMode)return;const r=Eb(this.map.mapId);if(!r)return;const n=this.player.position.positionOnMap.x,s=this.player.position.positionOnMap.y;if(s>=0&&s<r.tiles.length&&n>=0&&n<r.tiles[s].length&&r.tiles[s][n]===O.STAIRS_DOWN){if(e.isFloorBoss(e.currentFloor)){const a=`boss_floor_${e.currentFloor}`;if(!e.defeatedTrainers.has(a)){this.playScript(new ee("onStep",[new J([new L("The way forward is blocked. Defeat the boss first!")])]));return}}this.changeDungeonFloor(e)}}generateDungeonFloorData(e){const r=e.currentFloor;if(e.isFloorRest(r))return ob(r,e.runSeed);if(e.isFloorBoss(r))return db(r,e.runSeed);const n=Ae(r),s=jy(e.runSeed,r,n);if(r===1&&!e.starterPicked&&!e.prologueCompleted){const d=[1,4,7],u=new He(e.runSeed+"-starter").pick(d),f=new ut("Pokeball",!0,s.starterItemPosition,"src/assets/menus/pokeball.png",void 0,[new ee("onInteract",[new J([new L("You found a starter Pokemon!","System")]),new Yt(p=>{const g=p.POKEDEX.findById(u).result?.instanciate(5);g&&(p.player.monsters.push(g),p.player.setFollower(g),p.POKEDEX.setCaught(u),e.starterPicked=!0,p.updateMenuAvailability())})])]);s.openMap.items.push(f)}const a=new He(e.runSeed+"-populate-"+r),i=sb(s,r,n,a);s.openMap.npcs.push(...i);const c=bb(s.itemPositions,r,a);s.openMap.items.push(...c);const o=e.legendaryFloors.get(r);if(console.log(`[Legendary] floor=${r} legendaryId=${o}`),o!==void 0){const d=e.encounteredLegendaries.has(o),h=this.findLegendaryPortalPosition(s,a);if(console.log(`[Legendary] floor=${r} portalResult=`,h),h){const{pos:u,wallPos:f}=h,{sideRoomFloorData:p,mainFloorJonction:g}=wb(r,o,s.openMap.mapId,u,f,d);Ue(p.threlteMap.mapId,p.threlteMap),this.MAPS[p.openMap.mapId]=p.openMap,s.openMap.jonctions.push(g),s.openMap.removeCollisionAt(f.y*s.threlteMap.width+f.x),s.threlteMap.legendaryPortals||(s.threlteMap.legendaryPortals=[]),s.threlteMap.legendaryPortals.push({x:f.x,y:f.y})}}return s}findLegendaryPortalPosition(e,r){const{threlteMap:n,playerStart:s,stairsPosition:a}=e,{width:i,height:c,tiles:o}=n,d=[];for(let f=2;f<c-1;f++)for(let p=1;p<i-1;p++){const g=o[f][p];if(g!==O.DUNGEON_FLOOR&&g!==O.REST_FLOOR)continue;const y=Math.abs(p-s.x)+Math.abs(f-s.y),S=Math.abs(p-a.x)+Math.abs(f-a.y);if(y<5||S<3||o[f-1]?.[p]!==O.WALL)continue;const b=Math.min(p,f,i-1-p,c-1-f)<=2?2:1;d.push({pos:new C(p,f),wallPos:new C(p,f-1),score:b})}if(d.length===0)return;const h=d.filter(f=>f.score>=2),u=h.length>0?h:d;return r.shuffle(u)[0]}changeDungeonFloor(e,r){if(r&&(this.savesHolder=r),!e.prologueCompleted&&this.map?.mapId===_i){e.advanceFloor();const n=this.generateDungeonFloorData(e);Ue(n.threlteMap.mapId,n.threlteMap),this.MAPS[n.openMap.mapId]=n.openMap,te.set(e),r&&Qa(e,r);return}this.overWorldContext.setPaused(!0,"dungeon-floor-transition"),this.audioManager.fadeOutMapSound(),this.scriptRunner.interruptCurrent(),this.map?.npcs.forEach(n=>n.movingScript?.interrupt()),this.scriptRunner.clear(),this.overWorldContext.changingMap=!0,setTimeout(()=>{const n=1e3+e.currentFloor;e.advanceFloor();const s=this.generateDungeonFloorData(e);ei(n),Ue(s.threlteMap.mapId,s.threlteMap),this.MAPS[s.openMap.mapId]=s.openMap,this.map=s.openMap,this.overWorldContext.map=s.openMap;const a=r?.getActiveSave?.(),i=a?.dungeonFloor===e.currentFloor&&a.dungeonPlayerX!==void 0&&a.dungeonPlayerY!==void 0?new C(a.dungeonPlayerX,a.dungeonPlayerY):null;this.player.position.setPosition(i??s.playerStart);const c=this.scriptRunner.collectAllScripts(s.openMap.scripts,s.openMap.npcs);this.scriptRunner.indexScripts(c),te.set(e),r&&Qa(e,r),setTimeout(()=>{this.overWorldContext.changingMap=!1,this.overWorldContext.setPaused(!1,"dungeon-floor-transition"),this.playMapSound()},500)},500)}jumpToFloor(e,r){r.isRunActive&&(this.overWorldContext.setPaused(!0,"dungeon-floor-transition"),this.audioManager.fadeOutMapSound(),this.scriptRunner.interruptCurrent(),this.map?.npcs.forEach(n=>n.movingScript?.interrupt()),this.scriptRunner.clear(),this.overWorldContext.changingMap=!0,setTimeout(()=>{const n=1e3+r.currentFloor;r.currentFloor=e,r.currentBiome=Ae(e);const s=this.generateDungeonFloorData(r);ei(n),Ue(s.threlteMap.mapId,s.threlteMap),this.MAPS[s.openMap.mapId]=s.openMap,this.map=s.openMap,this.overWorldContext.map=s.openMap,this.player.position.setPosition(s.playerStart);const a=this.scriptRunner.collectAllScripts(s.openMap.scripts,s.openMap.npcs);this.scriptRunner.indexScripts(a),te.set(r),setTimeout(()=>{this.overWorldContext.changingMap=!1,this.overWorldContext.setPaused(!1,"dungeon-floor-transition"),this.playMapSound()},500)},500))}restartDungeonFloor(e){this.overWorldContext.changingMap=!0,this.scriptRunner.interruptCurrent(),this.map?.npcs.forEach(a=>a.movingScript?.interrupt()),this.scriptRunner.clear();const r=1e3+e.currentFloor;e.defeatedTrainers.clear(),e.pickedItems.clear();const n=this.generateDungeonFloorData(e);ei(r),Ue(n.threlteMap.mapId,n.threlteMap),this.MAPS[n.openMap.mapId]=n.openMap,this.map=n.openMap,this.overWorldContext.map=n.openMap,this.player.position.setPosition(n.playerStart);const s=this.scriptRunner.collectAllScripts(n.openMap.scripts,n.openMap.npcs);this.scriptRunner.indexScripts(s),te.set(e),setTimeout(()=>{this.overWorldContext.changingMap=!1},500)}checkForInSightNpc(e){const r=this.map?.npcs.find(s=>s.id===e),n=!!r&&!!r?.mainScript&&(!r.mainScript.played||r.mainScript.replayable)&&r.mainScript.triggerType==="onSight";return!!r&&n&&this.haveInSight(r)}checkForInSight(){this.map?.npcs&&this.map?.npcs?.length>0&&this.map.npcs.filter(r=>r.mainScript&&(!r.mainScript.played||r.mainScript.replayable)&&r.mainScript.triggerType==="onSight"&&!r.alerted).forEach(r=>{if(this.haveInSight(r)){r.alerted=!0,r.alertedAt=Date.now(),this.overWorldContext.setPaused(!0,"npc-alert");const n={up:"down",down:"up",left:"right",right:"left"};this.player.position.direction=n[r.direction],setTimeout(()=>{r.alerted=!1;const s=r.movingScript?.interrupt();this.playScript(r.mainScript,s)},600)}})}haveInSight(e){const r=Ob(e.position.positionOnMap,e.direction,3),n=this.player.position.positionOnMap;for(const s of r){if(this.map.hasCollisionAt(s))return!1;if(s.x===n.x&&s.y===n.y)return!0}return!1}startBattle(e,r,n){this.overWorldContext.setPaused(!0,"battle-start gameContext");const s=e instanceof le&&!!this.POKEDEX.findById(e.id)?.result?.isLegendary;this.audioManager.startBattleTransition(),setTimeout(()=>{s?this.audioManager.playLegendaryBattleMusic():this.audioManager.playBattleMusic()},1500),r===ye.DOUBLE&&this.player.monsters.length<2&&(r=ye.SINGLE),e instanceof ce&&e?.monsterIds?.length>0&&(e.dungeonTeam&&e.dungeonTeam.length>0?e.monsters=e.dungeonTeam.map(o=>{const d=this.POKEDEX.findById(o.speciesId).result.instanciate(o.level);if(o.heldItemId){const h=this.ITEMS.getHeldItemById(o.heldItemId);h&&(d.heldItem=h)}return d}):e.monsters=e.monsterIds.map(o=>{let d=Math.floor(this.player.monsters.reduce((h,u)=>h+u.level,0)/this.player.monsters.length);return d+=Math.floor(Math.random()*4)-1,this.POKEDEX.findById(o).result.instanciate(d)}));const a=new $1(this.player,e,this.settings,r,s?"mountains":"beaches"),i=a.events.end.subscribe(o=>{if(o){this.audioManager.fadeOutBattleMusic(),a.events.ending.set(!0),e instanceof le?this.POKEDEX.setViewed(e.id):e.monsters.forEach(d=>this.POKEDEX.setViewed(d.id)),i();try{if(o.win){if(o.win&&e instanceof le&&!o.caught){const d=Math.floor(e.level*10+20);this.player.bag.money+=d}else if(o.win&&e instanceof ce){const d=_e(te);d?.isDungeonMode&&d?.isRunActive&&(d.isFloorBoss(d.currentFloor)?d.defeatedTrainers.add(`boss_floor_${d.currentFloor}`):d.defeatedTrainers.add(`trainer_${d.currentFloor}_${e.id}`),te.set(d),this.savesHolder&&Qa(d,this.savesHolder))}}else{const d=_e(te);d?.isDungeonMode&&d?.isRunActive?(this.player.monsters.forEach(h=>{h.fullHeal()}),d.defeatedTrainers.clear(),d.pickedItems.clear(),d.currentFloor=1,d.currentBiome=Ae(1),te.set(d),this.restartDungeonFloor(d)):(this.player.position.positionOnMap=this.map.playerInitialPosition,this.player.monsters.forEach(h=>{h.fullHeal()}))}if(o.caught){if(this.POKEDEX.setCaught(o.caught.id),this.player.monsters.length<6)this.player.monsters.push(o.caught);else{const d=this.boxes.find(h=>!h.isFull());d&&d.add(o.caught)}this.player.follower||this.player.setFollower(o.caught)}}catch(d){console.error("Error during battle end handling:",d)}finally{setTimeout(()=>{this.playMapSound()},1e3),setTimeout(()=>{this.overWorldContext.setPaused(!1,"battle-end gameContext"),this.battleContext.set(void 0),this.audioManager.stopBattleMusic(),this.hasEvolutions=this.player.monsters.some(d=>a.leveledUpMonsterIds.has(d.id)&&d.canEvolve()),n&&n()},2e3)}}}),c=setInterval(()=>{this.player.moving||(this.battleContext.set(a),a.events.starting.set(!0),clearInterval(c))},200)}playScript(e,r,n,s=!0){this.scriptRunner.play(e,this,this.overWorldContext,r,n,s)}playMvts(e){this.scriptRunner.playMovements(e,this)}followerAt(e){return this.behindPlayerPosition()?.x===e.x&&this.behindPlayerPosition()?.y===e.y}behindPlayerPosition(){const e=this.player.position.positionOnMap;if(e)switch(this.player.position.direction){case"up":return new C(e.x,e.y+1);case"down":return new C(e.x,e.y-1);case"left":return new C(e.x+1,e.y);case"right":return new C(e.x-1,e.y)}}toSaveContext(){const e=new yi(this.id,Date.now(),new Oo(this.map.mapId,this.map.items.filter(n=>n.pickedUp).map(n=>n.id||0)),this.player,this.boxes,this.settings,this.isNewGame,this.viewedGuides,this.POKEDEX.exportForSave(),this.questStates,this.flags,this.savedPlayTime+(Date.now()-this.playTimeStart)),r=_e(te);if(r?.isDungeonMode){e.dungeonSeed=r.runSeed,e.dungeonFloor=r.currentFloor,e.dungeonDefeated=Array.from(r.defeatedTrainers),e.dungeonItems=Array.from(r.pickedItems),e.dungeonCurrency=r.runCurrency,e.dungeonActive=r.isRunActive,e.dungeonStarterPicked=r.starterPicked,e.dungeonPrologueCompleted=r.prologueCompleted,e.dungeonLegendaryFloors=Array.from(r.legendaryFloors.entries()),e.dungeonEncounteredLegendaries=Array.from(r.encounteredLegendaries);const n=this.savesHolder?.getActiveSave();n&&(e.dungeonPlayerX=n.dungeonPlayerX,e.dungeonPlayerY=n.dungeonPlayerY,e.dungeonExplored=n.dungeonExplored)}return e}}class yi{id=0;version=1;created=Date.now();updated=Date.now();playTime=0;currentMap;player;boxes;settings;isNewGame;viewedGuides;savedEntry;questStates=[];flags;dungeonSeed;dungeonFloor;dungeonDefeated;dungeonItems;dungeonCurrency;dungeonActive;dungeonStarterPicked;dungeonPrologueCompleted;dungeonLegendaryFloors;dungeonEncounteredLegendaries;dungeonExplored;dungeonPlayerX;dungeonPlayerY;constructor(e,r,n,s,a,i,c=!1,o=[],d=[],h=[],u,f=0){this.id=e,this.updated=r,this.currentMap=n,this.player=s,this.boxes=a,this.settings=i,this.isNewGame=c,this.viewedGuides=o,this.savedEntry=d,this.questStates=h,this.flags=u,this.playTime=f}toGameContext(){return new Nb(this)}}class Ri{POKEDEX=new oi;saves=[];_selectedSave=void 0;selectedSave$=N(void 0);requestNexGame$=N(!1);currentVersion=1;constructor(){const e=localStorage.getItem("saves");this.saves=e?.length&&JSON.parse(e,this.reviver).filter(r=>r.version&&r.version===this.currentVersion)||[],this.saves.forEach(r=>{Object.setPrototypeOf(r,yi.prototype),Object.setPrototypeOf(r.player,Q.prototype),r.questStates=r.questStates?.map(n=>(Object.setPrototypeOf(n,Jt.prototype),n.objectives=n.objectives.map(s=>(Object.setPrototypeOf(s,zt.prototype),s)),n))||[],r.flags=r?.flags?new za(r?.flags?.flags):new za}),this.saves=this.saves.sort((r,n)=>n.updated-r.updated)}async init(){await this.POKEDEX.ensureLoaded(),this.saves.forEach(e=>{e.player.setPrototypes(this.POKEDEX),e.boxes=e.boxes.map(r=>(Object.setPrototypeOf(r,fi.prototype),r.values=r.values.map(n=>(n&&(Object.setPrototypeOf(n,le.prototype),n.rehydrate(this.POKEDEX)),n)),r))})}removeSave(e){const r=this.saves.findIndex(n=>n.id===e);r!==-1&&(this.saves.splice(r,1),this.persist())}selectSave(e){this._selectedSave=this.saves[e],this.selectedSave$.set(this.saves[e])}getActiveSave(){return _e(this.selectedSave$)}newGame(e,r,n){const s=new Array(32);let a=1;for(let o=0;o<32;o++){const d=new Array(20);for(let h=0;h<20;h++){const u=this.POKEDEX.findById(a).result;u instanceof Qe?d[h]=void 0:d[h]=u.instanciate(75,30,!1),a++}s[o]=new fi("Box "+(o+1),d)}const i=this.saves.length>0?Math.max(...this.saves.map(o=>o.id))+1:0,c=new yi(i,Date.now(),new Oo(0),Q.fromScratch(e,r,n),s,new Qg,!0,[],[],Do.map(o=>o.toState()),new za);return this.saves.push(c),this.persist(),this._selectedSave=c,this.selectedSave$.set(c),c}persist(e){if(e){const n=this.saves.findIndex(s=>s.id===e.id);n!==-1&&(this.saves[n]=e)}const r=JSON.stringify(this.saves,this.replacer);localStorage.setItem("saves",r)}static TRANSIENT_KEYS=new Set(["statCalc","xpMgr","moveMgr","lastAttacker"]);replacer(e,r){if(!Ri.TRANSIENT_KEYS.has(e))return r instanceof Map?{dataType:"Map",value:Array.from(r.entries())}:r}reviver(e,r){return typeof r=="object"&&r!==null&&r.dataType==="Map"?new Map(r.value):r}}var Bb=de('<div class="firefly"></div>'),$b=de('<i style="width: 100%; text-align: center">Continue !</i>'),Lb=de('<div class="actions svelte-9feaht"><button class="erase svelte-9feaht" aria-label="Delete save file"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M17 6H22V8H20V21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21V8H2V6H7V3C7 2.44772 7.44772 2 8 2H16C16.5523 2 17 2.44772 17 3V6ZM18 8H6V20H18V8ZM13.4142 13.9997L15.182 15.7675L13.7678 17.1817L12 15.4139L10.2322 17.1817L8.81802 15.7675L10.5858 13.9997L8.81802 12.232L10.2322 10.8178L12 12.5855L13.7678 10.8178L15.182 12.232L13.4142 13.9997ZM9 4V6H15V4H9Z"></path></svg></button></div>'),Hb=de("<img/>"),Vb=de('<div class="preview svelte-9feaht"><div class="save-wrapper svelte-9feaht"><button data-testid="save-slot"><p style="font-size: 2rem" class="svelte-9feaht"> </p> <p style="font-size: 1.5rem" class="svelte-9feaht"> </p> <!></button> <!></div> <div class="images svelte-9feaht" role="button" tabindex="0"><img/> <!></div></div>'),Wb=de('<div class="load-screen svelte-9feaht" data-testid="load-save-screen"><!> <div class="save-list svelte-9feaht"></div> <div class="new-game svelte-9feaht"><button aria-label="Start a new game" data-testid="new-game-button" class="svelte-9feaht">Start a new game</button></div></div>');function jb(t,e){bi(e,!0);let r=fe(null),n;function s(g){e.savesHolder.selectSave(e.savesHolder.saves.indexOf(g))}function a(g){e.savesHolder.removeSave(g.id),K(r,e.savesHolder.saves[0]||null,!0)}function i(){e.savesHolder.requestNexGame$.set(!0)}const c=g=>{if(M(r))if(g.key==="ArrowDown"){const y=e.savesHolder.saves.indexOf(M(r));K(r,e.savesHolder.saves[y+1]||M(r),!0)}else if(g.key==="ArrowUp"){const y=e.savesHolder.saves.indexOf(M(r));K(r,e.savesHolder.saves[y-1]||M(r),!0)}else g.key==="Enter"?s(M(r)):g.key==="Delete"&&a(M(r))};function o(){n=new Howl({src:["src/assets/audio/save.mp3"],autoplay:!0,loop:!0,volume:.5})}Si(()=>(o(),K(r,e.savesHolder.saves[0]||null,!0),window.addEventListener("keydown",c),()=>{window.removeEventListener("keydown",c),n.fade(.5,0,1e3),setTimeout(()=>{n.stop()},1e3)}));var d=Wb(),h=he(d);tt(h,16,()=>Array.from({length:8}),rt,(g,y)=>{var S=Bb();z(g,S)});var u=ne(h,2);tt(u,21,()=>e.savesHolder.saves,rt,(g,y)=>{var S=Vb(),E=he(S),b=he(E);let A;var D=he(b),x=he(D),F=ne(D,2),R=he(F),P=ne(F,2);{var T=B=>{var Z=$b();z(B,Z)};Pe(P,B=>{M(r)===M(y)&&B(T)})}var H=ne(b,2);{var j=B=>{var Z=Lb(),se=he(Z);Je("click",se,()=>a(M(y))),z(B,Z)};Pe(H,B=>{M(r)===M(y)&&B(j)})}var G=ne(E,2),W=he(G),Y=ne(W,2);tt(Y,17,()=>M(y).player.monsters,rt,(B,Z)=>{var se=Hb();$t(De=>{Ye(se,"src",De),Ye(se,"alt",M(Z).name)},[()=>M(Z).getSprite()]),z(B,se)}),$t(B=>{A=Zo(b,1,"save pixel-button svelte-9feaht",null,A,{selected:M(r)===M(y)}),ri(x,`${M(y).id??""} - ${M(y).player.name??""}`),ri(R,B),Ye(W,"src",M(y).player.sprite.face.source),Ye(W,"alt",M(y).player.name)},[()=>new Date(M(y).updated).toUTCString()]),Je("click",b,()=>{M(r)===M(y)?s(M(y)):K(r,M(y),!0)}),si("focus",b,()=>K(r,M(y),!0)),Je("click",G,()=>{M(r)===M(y)?s(M(y)):K(r,M(y),!0)}),Je("keydown",G,B=>{(B.key==="Enter"||B.key===" ")&&(M(r)===M(y)?s(M(y)):K(r,M(y),!0))}),si("focus",G,()=>K(r,M(y),!0)),z(g,S)});var f=ne(u,2),p=he(f);Je("click",p,()=>i()),z(t,d),Ei()}Jo(["click","keydown"]);var Gb=de('<div class="firefly"></div>'),Ub=de("<option> </option>"),Yb=de(`<div class="create svelte-181dai4" data-testid="player-creation"><!> <img alt="player" class="preview svelte-181dai4"/> <img src="src/assets/monsters/pokedex/050.png" alt="player" class="preview-poke svelte-181dai4"/> <form class="svelte-181dai4"><h1 style="margin: 0!important;" class="svelte-181dai4">New game</h1> <label for="template">Are you a</label> <select id="template"></select> <label for="name">What's your name?</label> <input id="name" data-testid="name-input"/> <button type="submit" data-testid="confirm-button">Start</button></form></div>`);function Xb(t,e){bi(e,!0);let r=fe(1);const n=[1,2],s=Oe(()=>Ci.getSprite(M(r)));let a=fe(""),i;function c(){i=new Howl({src:["src/assets/audio/save.mp3"],autoplay:!0,loop:!0,volume:.5})}function o(){e.savesHolder.newGame(M(r),M(a),M(r)===0?"MALE":"FEMALE")}Si(()=>(c(),()=>{i.fade(.5,0,1e3),setTimeout(()=>{i.stop()},1e3)}));var d=Yb(),h=he(d);tt(h,16,()=>Array.from({length:15}),rt,(S,E)=>{var b=Gb();z(S,b)});var u=ne(h,2),f=ne(u,4),p=ne(he(f),4);tt(p,21,()=>n,rt,(S,E)=>{var b=Ub(),A=he(b),D={};$t(()=>{ri(A,M(E)===1?"Boy":"Girl"),D!==(D=M(E))&&(b.value=(b.__value=M(E))??"")}),z(S,b)});var g=ne(p,4),y=ne(g,2);$t(()=>{Ye(u,"src",M(s).full.source),Ye(g,"placeholder",M(s).name),y.disabled=M(a)?.length===0}),si("submit",f,S=>{S.preventDefault(),o()}),Qo(p,()=>M(r),S=>K(r,S)),el(g,()=>M(a),S=>K(a,S)),z(t,d),Ei()}var Kb=de('<div class="battleStart svelte-1n46o8q"></div>'),qb=de('<div class="battleEnd svelte-1n46o8q"></div>'),zb=de("<!> <!> <!> <!>",1),Jb=de('<div class="rotate svelte-1n46o8q"><img src="src/assets/common/rotate.gif" alt="Please rotate your device" class="svelte-1n46o8q"/></div>'),Zb=de('<div id="wrapper" class="svelte-1n46o8q"><!> <!></div>');function Qb(t,e){bi(e,!0);const r=new Ri;let n=fe(!1);r.init().then(()=>{K(n,!0)});let s=fe(void 0),a=fe(!1),i=fe(tl(Fb)),c=fe(!1);function o(){const P=window.location.hash;K(c,P==="#admin")}r.selectedSave$.subscribe(P=>{P&&(P.dungeonActive?h(P):d(P))}),r.requestNexGame$.subscribe(P=>{P&&K(a,!0)});function d(P){const T=new vi;T.startRun(),te.set(T),P.dungeonSeed=T.runSeed,P.dungeonFloor=T.currentFloor,P.dungeonDefeated=[],P.dungeonItems=[],P.dungeonCurrency=0,P.dungeonActive=!0,r.persist(P),K(s,P.toGameContext(),!0),K(i,!0),setTimeout(()=>{M(s)?.changeDungeonFloor(T,r)},100)}function h(P){const T=new vi;T.restoreRun(P),te.set(T),P.isNewGame=!1,K(s,P.toGameContext(),!0),K(i,!0),setTimeout(()=>{M(s)?.changeDungeonFloor(T,r)},100)}let u=fe(void 0);Ni(()=>{if(!M(s))return;const P=M(s).battleContext.subscribe(T=>{K(u,T,!0)});return()=>P()});const f=new ti.Howl({src:["src/assets/audio/battle/battle-start.mp3"],autoplay:!1,loop:!0,volume:.7});let p=fe(!1),g=fe(!1);Ni(()=>{if(!M(u))return;const P=M(u).events.starting.subscribe(H=>{H&&(K(p,H,!0),f.playing()||f.play(),setTimeout(()=>{f.fade(.5,0,500),M(u)?.events?.starting?.set(!1),K(p,!1),f.stop()},2e3))}),T=M(u).events.ending.subscribe(H=>{H&&(K(g,H,!0),setTimeout(()=>{M(u)?.events?.ending?.set(!1),K(g,!1)},4e3))});return()=>{P(),T()}});let y=fe(!1);/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.document.addEventListener("touchmove",P=>{P.scale!==1&&P.preventDefault()},{passive:!1});function S(){K(y,!window.matchMedia("(orientation: landscape)").matches||window.innerWidth<window.innerHeight,!0)}window.addEventListener("resize",()=>{S()}),Si(()=>{S(),o(),window.addEventListener("hashchange",o);const P=document.getElementById("wrapper");P?.requestFullscreen&&P.requestFullscreen().catch(()=>{})});var E=Zb(),b=he(E);{var A=P=>{var T=Ee(),H=ve(T);gt(H,()=>vt(()=>import("./AdminPage-AeQk0f5k.js"),__vite__mapDeps([0,1,2]),import.meta.url),null,(j,G)=>{var W=Oe(()=>{var{default:se}=M(G);return{AdminPage:se}}),Y=Oe(()=>M(W).AdminPage),B=Ee(),Z=ve(B);wt(Z,()=>M(Y),(se,De)=>{De(se,{onClose:()=>{K(c,!1),window.location.hash=""}})}),z(j,B)}),z(P,T)},D=P=>{var T=Ee(),H=ve(T);{var j=B=>{var Z=zb(),se=ve(Z);{var De=oe=>{var Se=Ee(),Qt=ve(Se);gt(Qt,()=>vt(()=>import("./ThrelteWorld-llSDVDs8.js"),__vite__mapDeps([0,3,4,2]),import.meta.url),null,(er,tr)=>{var rr=Oe(()=>{var{default:xe}=M(tr);return{World:xe}}),sr=Oe(()=>M(rr).World),ze=Ee(),nr=ve(ze);wt(nr,()=>M(sr),(xe,ar)=>{ar(xe,{get context(){return M(s)},get overWorldCtx(){return M(s).overWorldContext},get savesHolder(){return r}})}),z(er,ze)}),z(oe,Se)};Pe(se,oe=>{M(s).overWorldContext!==void 0&&oe(De)})}var mt=ne(se,2);{var jo=oe=>{var Se=Ee(),Qt=ve(Se);gt(Qt,()=>vt(()=>import("./Battle-Cq_-5aRl.js"),__vite__mapDeps([0,3,5,2]),import.meta.url),null,(er,tr)=>{var rr=Oe(()=>{var{default:xe}=M(tr);return{Battle:xe}}),sr=Oe(()=>M(rr).Battle),ze=Ee(),nr=ve(ze);wt(nr,()=>M(sr),(xe,ar)=>{ar(xe,{get context(){return M(s)},get overWorldCtx(){return M(s).overWorldContext},get battleCtx(){return M(u)}})}),z(er,ze)}),z(oe,Se)};Pe(mt,oe=>{M(u)!==void 0&&!M(p)&&oe(jo)})}var Fi=ne(mt,2);{var Go=oe=>{var Se=Kb();z(oe,Se)};Pe(Fi,oe=>{M(p)&&oe(Go)})}var Uo=ne(Fi,2);{var Yo=oe=>{var Se=qb();z(oe,Se)};Pe(Uo,oe=>{M(g)&&oe(Yo)})}z(B,Z)},G=B=>{},W=B=>{jb(B,{get savesHolder(){return r}})},Y=B=>{Xb(B,{get savesHolder(){return r}})};Pe(H,B=>{M(s)?B(j):M(n)?r.saves?.length>0&&!M(a)?B(W,2):B(Y,!1):B(G,1)})}z(P,T)},x=P=>{var T=Ee(),H=ve(T);gt(H,()=>vt(()=>import("./Intro-DbD5Ir9h.js"),__vite__mapDeps([0,6]),import.meta.url),null,(j,G)=>{var W=Oe(()=>{var{default:se}=M(G);return{Intro:se}}),Y=Oe(()=>M(W).Intro),B=Ee(),Z=ve(B);wt(Z,()=>M(Y),(se,De)=>{De(se,{get started(){return M(i)},set started(mt){K(i,mt,!0)}})}),z(j,B)}),z(P,T)};Pe(b,P=>{M(c)?P(A):M(i)?P(D,1):P(x,!1)})}var F=ne(b,2);{var R=P=>{var T=Jb();z(P,T)};Pe(F,P=>{M(y)&&P(R)})}z(t,E),Ei()}Zg();rl(Qb,{target:document.getElementById("app")});export{dS as A,it as B,Ci as C,J as D,nS as E,To as F,qg as G,ue as H,Ja as I,mS as J,ew as K,_o as M,ct as P,hS as R,et as S,O as T,lS as U,k as W,vt as _,q as a,cS as b,le as c,Rw as d,L as e,pS as f,uS as g,fS as h,te as i,Eb as j,gS as k,Po as l,ye as m,St as n,_t as o,Qa as p,Dw as q,xw as r,p1 as s,di as t,li as u,We as v,oi as w,Pi as x,Oi as y,me as z};
