import{p as V,G as _,z as I,i,B as z,C as E,m as F,c as A,f as W,h as B,H as D,K as q,s as H,a as K,t as N,r as j,y as m,l as G,j as Y}from"./threlte-CLL4P1-_.js";import{f as Z}from"./main-qJhSSQsi.js";import"./threejs-4A5RaTDs.js";import"./vendor-CHMVvq2h.js";/* empty css            */var J=G('<div class="dungeon-minimap svelte-753byz"><canvas class="svelte-753byz"></canvas> <div class="money-display svelte-753byz"> </div></div>');function ee(R,e){V(e,!0);const u=_(e,"visible",3,!0),X=_(e,"money",3,0),s=220,C="#ffffff",L="rgba(255, 255, 255, 0.5)",v=.3,S="#3a3a3a",w="#c8b89a";let o=B(void 0);const t=m(()=>Math.min(s/e.width,s/e.height)),h=m(()=>(s-e.width*i(t))/2),y=m(()=>(s-e.height*i(t))/2);function b(a){return Z.get(a)??!1?w:S}function O(a){a.clearRect(0,0,s,s),a.fillStyle="rgba(0, 0, 0, 0)",a.fillRect(0,0,s,s),a.globalAlpha=v;for(let l=0;l<e.height;l++)for(let n=0;n<e.width;n++)if(!e.explorationTracker.isVisible(n,l,e.playerX,e.playerY)&&e.explorationTracker.isVisited(n,l)){const c=e.tiles[l][n];a.fillStyle=b(c),a.fillRect(i(h)+n*i(t),i(y)+l*i(t),i(t),i(t))}a.globalAlpha=1;for(let l=0;l<e.height;l++)for(let n=0;n<e.width;n++)if(e.explorationTracker.isVisible(n,l,e.playerX,e.playerY)){const c=e.tiles[l][n];a.fillStyle=b(c),a.fillRect(i(h)+n*i(t),i(y)+l*i(t),i(t),i(t))}if(e.stairsX!==void 0&&e.stairsY!==void 0){const l=e.explorationTracker.isVisible(e.stairsX,e.stairsY,e.playerX,e.playerY),n=e.explorationTracker.isVisited(e.stairsX,e.stairsY);if(l||n){a.globalAlpha=l?1:v,a.fillStyle=L;const c=i(h)+e.stairsX*i(t)+i(t)/2,T=i(y)+e.stairsY*i(t)+i(t)/2,k=Math.max(i(t)*.6,2);a.beginPath(),a.arc(c,T,k,0,Math.PI*2),a.fill(),a.globalAlpha=1}}a.fillStyle=C;const r=i(h)+e.playerX*i(t)+i(t)/2,f=i(y)+e.playerY*i(t)+i(t)/2,d=Math.max(i(t)*.7,2.5);a.beginPath(),a.arc(r,f,d,0,Math.PI*2),a.fill(),a.fillStyle="#ffffff",a.font="10px monospace",a.textAlign="right",a.textBaseline="top",a.fillText(`F${e.floorNumber}`,24,4)}I(()=>{if(!i(o)||!u())return;const a=window.devicePixelRatio||1;i(o).width=s*a,i(o).height=s*a;const r=i(o).getContext("2d");if(!r)return;r.scale(a,a);let f,d=-1,l=-1;function n(){r&&((e.playerX!==d||e.playerY!==l)&&(d=e.playerX,l=e.playerY,O(r)),f=requestAnimationFrame(n))}return f=requestAnimationFrame(n),()=>{cancelAnimationFrame(f)}});var g=z(),M=E(g);{var P=a=>{var r=J(),f=Y(r);D(f,"width: 220px; height: 220px;"),q(f,n=>H(o,n),()=>i(o));var d=K(f,2),l=Y(d);N(()=>j(l,`${X()??""}$`)),A(a,r)};F(M,a=>{u()&&a(P)})}A(R,g),W()}export{ee as default};
