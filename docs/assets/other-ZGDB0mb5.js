import{g as u}from"./index-BeE2UgLB.js";const z={"player-0":{x:22,y:80,z:0,scale:1,opacity:1},"opponent-0":{x:75,y:37,z:200,scale:.85,opacity:1}},O={"player-0":{x:22,y:80,z:0,scale:.9,opacity:1},"player-1":{x:35,y:85,z:10,scale:.9,opacity:1},"opponent-0":{x:60,y:32,z:200,scale:.75,opacity:1},"opponent-1":{x:92,y:37,z:210,scale:.75,opacity:1}};class P{containerWidth=800;containerHeight=600;battleType="SINGLE";setContainerBounds(a,e){this.containerWidth=a,this.containerHeight=e}setLayout(a){this.battleType=a}getSlotPosition(a){const e=`${a.side}-${a.index}`,o=(this.battleType==="SINGLE"?z:O)[e];return o?{...o}:{x:50,y:50,z:100,scale:1,opacity:1}}toScreenCoords(a,e){const s=e*a.scale;return{left:a.x/100*this.containerWidth-s/2,top:a.y/100*this.containerHeight-s/2,width:s,height:s,opacity:a.opacity}}lerp(a,e,s){const o=Math.max(0,Math.min(1,s));return{x:a.x+(e.x-a.x)*o,y:a.y+(e.y-a.y)*o,z:a.z+(e.z-a.z)*o,scale:a.scale+(e.scale-a.scale)*o,opacity:a.opacity+(e.opacity-a.opacity)*o}}behind(a,e){return{...a,z:a.z+e}}above(a,e){return{...a,y:a.y-e}}getContainerBounds(){return{width:this.containerWidth,height:this.containerHeight}}}const I={impact:{path:"src/assets/battle/fx/impact-sprite.png",frames:4,frameWidth:192,frameHeight:192},fire:{path:"src/assets/battle/fx/fire-sprite.png",frames:8,frameWidth:192,frameHeight:192},thunder:{path:"src/assets/battle/fx/thunder-sprite.png",frames:6,frameWidth:192,frameHeight:192},slash:{path:"src/assets/battle/fx/slash-sprite.png",frames:5,frameWidth:192,frameHeight:192},water:{path:"src/assets/battle/fx/water-sprite.png",frames:6,frameWidth:192,frameHeight:192},ice:{path:"src/assets/battle/fx/ice-sprite.png",frames:6,frameWidth:192,frameHeight:192},fist:{path:"src/assets/battle/fx/fist-sprite.png",frames:5,frameWidth:192,frameHeight:192},foot:{path:"src/assets/battle/fx/foot-sprite.png",frames:5,frameWidth:192,frameHeight:192},claws:{path:"src/assets/battle/fx/claws-sprite.png",frames:5,frameWidth:192,frameHeight:192},crunch:{path:"src/assets/battle/fx/crunch-sprite.png",frames:5,frameWidth:192,frameHeight:192},heal:{path:"src/assets/battle/fx/heal-sprite.png",frames:6,frameWidth:192,frameHeight:192},buff:{path:"src/assets/battle/fx/buff-sprite.png",frames:6,frameWidth:192,frameHeight:192},debuff:{path:"src/assets/battle/fx/debuff-sprite.png",frames:6,frameWidth:192,frameHeight:192},psychic:{path:"src/assets/battle/fx/debuff-sprite.png",frames:6,frameWidth:192,frameHeight:192},rock:{path:"src/assets/battle/fx/rock-sprite.png",frames:5,frameWidth:192,frameHeight:192},leaf:{path:"src/assets/battle/fx/leaf-sprite.png",frames:6,frameWidth:192,frameHeight:192},poison:{path:"src/assets/battle/fx/poison-sprite.png",frames:6,frameWidth:192,frameHeight:192},wind:{path:"src/assets/battle/fx/wind-sprite.png",frames:6,frameWidth:192,frameHeight:192},shadowball:{path:"src/assets/battle/fx/shadowball-sprite.png",frames:6,frameWidth:192,frameHeight:192},lightball:{path:"src/assets/battle/fx/lightball-sprite.png",frames:8,frameWidth:192,frameHeight:192},drain:{path:"src/assets/battle/fx/drain-sprite.png",frames:8,frameWidth:192,frameHeight:192}};class H{pools=new Map;active=new Set;maxPoolSize;constructor(a=20){this.maxPoolSize=a}async preload(a){const e=a.map(s=>{const o=I[s];return o?new Promise(r=>{const i=new Image;i.onload=()=>r(),i.onerror=()=>r(),i.src=o.path}):Promise.resolve()});await Promise.all(e)}acquire(a){const e=I[a];if(!e)return null;const s=this.pools.get(a)||[];let o=s.pop();return o||(o=this.createElement(a,e)),this.active.add(o),this.pools.set(a,s),o}release(a){if(!this.active.has(a))return;this.active.delete(a);const e=a.dataset.effectName;if(!e)return;const s=this.pools.get(e)||[];s.length<this.maxPoolSize?(a.style.display="none",s.push(a),this.pools.set(e,s)):a.remove()}clear(){this.pools.forEach(a=>{a.forEach(e=>e.remove())}),this.pools.clear(),this.active.forEach(a=>a.remove()),this.active.clear()}getStats(){let a=0;return this.pools.forEach(e=>{a+=e.length}),{pooled:a,active:this.active.size}}createElement(a,e){const s=document.createElement("div");return s.dataset.effectName=a,s.style.cssText=`
			position: absolute;
			width: ${e.frameWidth}px;
			height: ${e.frameHeight}px;
			background-image: url(${e.path});
			background-repeat: no-repeat;
			pointer-events: none;
		`,s}}const B={ballistic:t=>1-Math.pow(2*t-1,2),ballisticUp:t=>-3*t*t+4*t,ballisticDown:t=>t*t,quadUp:t=>1-Math.pow(1-t,2),quadDown:t=>t*t,swing:t=>.5-Math.cos(t*Math.PI)/2};function Z(){Object.entries(B).forEach(([t,a])=>{u.registerEase(t,a)})}const M={normal:"#A8A878",fire:"#F08030",water:"#6890F0",electric:"#F8D030",grass:"#78C850",ice:"#98D8D8",fighting:"#C03028",poison:"#A040A0",ground:"#E0C068",flying:"#A890F0",psychic:"#F85888",bug:"#A8B820",rock:"#B8A038",ghost:"#705898",dragon:"#7038F8",dark:"#705848",steel:"#B8B8D0",fairy:"#EE99AC"},d={normal:0,fire:0,water:200,electric:50,grass:90,ice:180,fighting:-20,poison:280,ground:30,flying:250,psychic:320,bug:70,rock:35,ghost:260,dragon:270,dark:0,steel:220,fairy:330},L={normal:"impact",fire:"fire",water:"water",electric:"thunder",grass:"leaf",ice:"ice",fighting:"impact",poison:"poison",ground:"rock",flying:"wind",psychic:"lightball",bug:"leaf",rock:"rock",ghost:"shadowball",dragon:"fire",dark:"shadowball",steel:"impact",fairy:"lightball"};class he{container;positionSystem;effectPool;moveRegistry=new Map;activeTimelines=new Set;initialized=!1;constructor(a){this.container=a,this.positionSystem=new P,this.effectPool=new H}initialize(){if(this.initialized)return;const a=this.container.getBoundingClientRect();this.positionSystem.setContainerBounds(a.width,a.height),Z(),this.initialized=!0}setLayout(a){this.positionSystem.setLayout(a)}getEffectZIndex(a){return a.side==="player"?200:4}registerMove(a,e){this.moveRegistry.set(a.toLowerCase(),e)}async playMove(a){this.initialized||this.initialize();const e=this.moveRegistry.get(a.moveName.toLowerCase());e?await e(this,a):await this.playFallbackAnimation(a)}async playFallbackAnimation(a){const{attacker:e,defender:s,moveCategory:o,moveType:r}=a,i=Array.isArray(s)?s[0]:s,c=this.getTypeColor(r),n=this.getTypeHueAngle(r),l=L[r.toLowerCase()]??"impact";switch(o){case"physical":await this.dashAttack(e,i,c,n,l);break;case"special":await this.projectileAttack(e,i,c,n,l);break;case"status":await this.statusEffect(e,c,n);break}}async dashAttack(a,e,s,o,r){const i=a.element.getBoundingClientRect(),c=e.element.getBoundingClientRect(),n=c.left-i.left,l=c.top-i.top,h=Math.sqrt(n*n+l*l),p=Math.max(0,h-30),m=h>0?p/h:0,f=n*m,w=l*m,y=u.timeline();this.activeTimelines.add(y),y.to(a.element,{x:f,y:w,duration:.2,ease:"power2.in"}).add(()=>{this.showSpriteEffect(r,e,{hueRotate:o,scale:1,tint:s,zIndex:this.getEffectZIndex(a.slot)}),this.shake(e.element,8,150)}).to(a.element,{x:0,y:0,duration:.3,ease:"power2.out"}),await y.then(()=>{}),this.activeTimelines.delete(y),this.resetSpriteToHome(a)}async projectileAttack(a,e,s,o,r){await this.flashElement(e.element,s,150),await Promise.all([this.showSpriteEffect(r,e,{hueRotate:o,scale:1.2,tint:s,zIndex:100}),this.shake(e.element,6,150)])}async statusEffect(a,e,s){await this.flashElement(a.element,e,300),await this.showSpriteEffect("buff",a,{hueRotate:s,scale:.8,opacity:.7,tint:e,zIndex:100}),await this.shake(a.element,3,200)}async flashElement(a,e,s){const o=u.timeline();this.activeTimelines.add(o),o.to(a,{filter:`brightness(2) drop-shadow(0 0 10px ${e})`,duration:s/2e3}).to(a,{filter:"brightness(1) drop-shadow(0 0 0 transparent)",duration:s/2e3}),await o.then(()=>{}),this.activeTimelines.delete(o)}async showEffectAt(a,e,s={}){const o=this.effectPool.acquire(a);if(!o)return;const r=I[a];if(!r){this.effectPool.release(o);return}const i=this.positionSystem.toScreenCoords(e,r.frameWidth),c=s.duration||300,l=1e3/(r.fps||24);o.style.display="block",o.style.left=`${i.left}px`,o.style.top=`${i.top}px`,o.style.opacity=String(s.opacity??1),o.style.transform=`scale(${s.scale??1})`,this.container.appendChild(o),await this.animateSpriteSheet(o,r.frames,l,c),this.effectPool.release(o)}async moveEffect(a,e,s,o,r="linear"){const i=this.effectPool.acquire(a);if(!i)return;const c=I[a];if(!c){this.effectPool.release(i);return}const n=this.positionSystem.toScreenCoords(e,c.frameWidth),l=this.positionSystem.toScreenCoords(s,c.frameWidth);i.style.display="block",i.style.left=`${n.left}px`,i.style.top=`${n.top}px`,this.container.appendChild(i);const h=u.timeline();this.activeTimelines.add(h),h.to(i,{left:l.left,top:l.top,duration:o/1e3,ease:r}),await h.then(()=>{}),this.activeTimelines.delete(h),this.effectPool.release(i)}async shake(a,e,s){const o=u.timeline();this.activeTimelines.add(o);const r=Math.floor(s/50);for(let i=0;i<r;i++){const c=(Math.random()-.5)*e*2,n=(Math.random()-.5)*e*2;o.to(a,{x:c,y:n,duration:.05})}o.to(a,{x:0,y:0,duration:.05}),await o.then(()=>{}),this.activeTimelines.delete(o),u.set(a,{clearProps:"x,y"})}async backgroundFlash(a,e,s=.5){const o=document.createElement("div");o.style.cssText=`
			position: absolute;
			inset: 0;
			background-color: ${a};
			opacity: 0;
			pointer-events: none;
			z-index: 1000;
		`,this.container.appendChild(o);const r=u.timeline();this.activeTimelines.add(r),r.to(o,{opacity:s,duration:e/2e3}).to(o,{opacity:0,duration:e/2e3}),await r.then(()=>{}),this.activeTimelines.delete(r),o.remove()}async screenShake(a,e){await this.shake(this.container,a,e)}async wait(a){return new Promise(e=>setTimeout(e,a))}getPosition(a){return this.positionSystem.getSlotPosition(a)}behind(a,e){return this.positionSystem.behind(a,e)}above(a,e){return this.positionSystem.above(a,e)}async showSpriteEffect(a,e,s={}){const o=this.effectPool.acquire(a);if(!o)return;const r=I[a];if(!r){this.effectPool.release(o);return}const c=("element"in e?e.element:e).getBoundingClientRect(),n=this.container.getBoundingClientRect(),l=c.left-n.left+c.width/2,h=c.top-n.top+c.height/2,p=s.duration??400,m=s.scale??1,w=1e3/(r.fps??24);if(o.style.display="block",o.style.position="absolute",o.style.left=`${l-r.frameWidth*m/2}px`,o.style.top=`${h-r.frameHeight*m/2}px`,o.style.width=`${r.frameWidth}px`,o.style.height=`${r.frameHeight}px`,o.style.opacity=String(s.opacity??1),o.style.transform=`scale(${m})`,o.style.zIndex=String(s.zIndex??100),s.hueRotate!==void 0){const y=s.tint??"rgba(255, 255, 255, 0.8)";o.style.filter=`hue-rotate(${s.hueRotate}deg) drop-shadow(0 0 12px ${y}) drop-shadow(0 0 6px ${y}) brightness(1.2)`}else s.tint&&(o.style.filter=`drop-shadow(0 0 12px ${s.tint}) drop-shadow(0 0 6px ${s.tint}) brightness(1.2)`);this.container.appendChild(o),await this.animateSpriteSheet(o,r.frames,w,p),o.style.filter="",this.effectPool.release(o),s.onComplete?.()}async moveSpriteTo(a,e,s={}){const o=s.duration??.25,r=s.returnDuration??.3,i=s.easing??"power2.in",c=s.returnEasing??"power2.out",n=s.overshoot??30,l=a.element.getBoundingClientRect();let h,p;if("element"in e){const E=e.element.getBoundingClientRect();h=E.left,p=E.top}else h=e.x,p=e.y;const m=h-l.left,f=p-l.top,w=Math.sqrt(m*m+f*f),y=Math.max(0,w-n),S=w>0?y/w:0,T=m*S,v=f*S,b=u.timeline();this.activeTimelines.add(b),b.to(a.element,{x:T,y:v,duration:o,ease:i}).to(a.element,{x:0,y:0,duration:r,ease:c}),await b.then(()=>{}),this.activeTimelines.delete(b),this.resetSpriteToHome(a)}async showImpact(a,e={}){const s="element"in a?a.element:a,o=e.intensity??8,r=e.duration??200,i=e.color??"#ffffff";await Promise.all([this.showSpriteEffect("impact",a,{scale:1.2,duration:r,tint:i}),this.shake(s,o,r)])}async flashSprite(a,e,s=150){await this.flashElement(a.element,e,s)}async pulseScale(a,e,s=300){const o=u.timeline();this.activeTimelines.add(o);const r=a.homePosition?.scale??1;o.to(a.element,{scale:e,duration:s/2e3,ease:"power2.out"}).to(a.element,{scale:r,duration:s/2e3,ease:"power2.in"}),await o.then(()=>{}),this.activeTimelines.delete(o)}resetSpriteToHome(a){const e=a.homePosition?.scale??1;u.set(a.element,{x:0,y:0,scale:e})}getTypeColor(a){return M[a.toLowerCase()]??M.normal}getTypeHueAngle(a){return d[a.toLowerCase()]??d.normal}cancelAll(){this.activeTimelines.forEach(a=>a.kill()),this.activeTimelines.clear(),this.effectPool.clear()}async animateSpriteSheet(a,e,s,o){return new Promise(r=>{let i=0;const c=parseInt(a.style.width)||192,n=Date.now()+o,l=()=>{if(Date.now()>=n){r();return}a.style.backgroundPosition=`-${i*c}px 0`,i=(i+1)%e,setTimeout(l,s)};l()})}}const g={},R={normal:"impact",fire:"fire",water:"water",electric:"thunder",grass:"leaf",ice:"ice",fighting:"impact",poison:"poison",rock:"rock",ground:"rock",flying:"wind",psychic:"lightball",ghost:"shadowball",dragon:"fire",dark:"shadowball",fairy:"lightball",bug:"leaf",steel:"impact"};async function W(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o),n=R[o.toLowerCase()];await t.moveSpriteTo(e,r,{duration:.15,overshoot:25});const l=[t.showSpriteEffect("fist",r,{hueRotate:i,scale:1.2,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:10,color:c})];n&&n!=="impact"&&l.push(t.showSpriteEffect(n,r,{hueRotate:i,scale:1,tint:c,zIndex:t.getEffectZIndex(e.slot)-1})),await Promise.all(l)}async function D(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o),n=R[o.toLowerCase()];await t.moveSpriteTo(e,r,{duration:.2,easing:"power3.in",overshoot:20,returnDuration:.35,returnEasing:"bounce.out"});const l=[t.showSpriteEffect("foot",r,{hueRotate:i,scale:1.3,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:12,color:c})];n&&n!=="impact"&&l.push(t.showSpriteEffect(n,r,{hueRotate:i,scale:1.1,tint:c,zIndex:t.getEffectZIndex(e.slot)-1})),await Promise.all(l)}async function V(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o),n=R[o.toLowerCase()];await t.moveSpriteTo(e,r,{duration:.12,overshoot:35});const l=[t.showSpriteEffect("slash",r,{hueRotate:i,scale:1.5,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.flashSprite(r,c,100),t.shake(r.element,6,150)];n&&n!=="impact"&&l.push(t.showSpriteEffect(n,r,{hueRotate:i,scale:1.2,tint:c,zIndex:t.getEffectZIndex(e.slot)-1})),await Promise.all(l)}async function Y(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o),n=R[o.toLowerCase()];await t.moveSpriteTo(e,r,{duration:.1,overshoot:30}),await t.showSpriteEffect("claws",r,{hueRotate:i,scale:1.4,tint:c,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(50);const l=[t.showSpriteEffect("slash",r,{hueRotate:i,scale:1.2,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.shake(r.element,8,200)];n&&n!=="impact"&&l.push(t.showSpriteEffect(n,r,{hueRotate:i,scale:1,tint:c,zIndex:t.getEffectZIndex(e.slot)-1})),await Promise.all(l)}async function F(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o),n=R[o.toLowerCase()];await t.moveSpriteTo(e,r,{duration:.18,overshoot:15});const l=[t.showSpriteEffect("crunch",r,{hueRotate:i,scale:1.3,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:10,color:c})];n&&n!=="impact"&&l.push(t.showSpriteEffect(n,r,{hueRotate:i,scale:1,tint:c,zIndex:t.getEffectZIndex(e.slot)-1})),await Promise.all(l)}async function U(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=t.getTypeColor(o);await t.moveSpriteTo(e,r,{duration:.25,easing:"power4.in",overshoot:10,returnDuration:.4,returnEasing:"power2.out"}),await Promise.all([t.showSpriteEffect("impact",r,{scale:1.5,tint:i,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:15,color:i}),t.screenShake(10,200)])}async function q(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);await t.moveSpriteTo(e,r,{duration:.15,overshoot:25}),await Promise.all([t.showSpriteEffect("slash",r,{hueRotate:i,scale:1.3,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:8,color:c})])}async function G(t,a){const{attacker:e,defender:s}=a,o=Array.isArray(s)?s[0]:s,r=t.getTypeColor("water");await t.moveSpriteTo(e,o,{duration:.2,overshoot:20}),await Promise.all([t.showSpriteEffect("water",o,{scale:1.5,tint:r,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(o,{intensity:12,color:r})])}async function _(t,a){const{attacker:e,defender:s}=a,o=Array.isArray(s)?s[0]:s,r=t.getTypeColor("water"),i=d.water;await t.moveSpriteTo(e,o,{duration:.15,overshoot:25}),await Promise.all([t.showSpriteEffect("fist",o,{hueRotate:i,scale:1.2,tint:r,zIndex:t.getEffectZIndex(e.slot)}),t.showSpriteEffect("water",o,{scale:1.3,tint:r,zIndex:t.getEffectZIndex(e.slot)-1}),t.showImpact(o,{intensity:10,color:r})])}async function N(t,a){const{attacker:e,defender:s}=a,o=Array.isArray(s)?s[0]:s,r=t.getTypeColor("water");await t.moveSpriteTo(e,o,{duration:.18,overshoot:25,returnDuration:.35}),await Promise.all([t.showSpriteEffect("water",o,{scale:1.6,tint:r,zIndex:t.getEffectZIndex(e.slot)}),t.showSpriteEffect("slash",o,{hueRotate:d.water,scale:1.2,tint:r,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(o,{intensity:14,color:r})])}async function Q(t,a){const{attacker:e,defender:s}=a,o=Array.isArray(s)?s[0]:s,r=t.getTypeColor("water");await t.moveSpriteTo(e,o,{duration:.12,overshoot:15,returnDuration:.25}),await Promise.all([t.showSpriteEffect("water",o,{scale:1.4,tint:r,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(o,{intensity:10,color:r}),t.flashSprite(o,r,100)])}async function X(t,a){const{attacker:e,defender:s}=a,o=Array.isArray(s)?s[0]:s,r=t.getTypeColor("water");await t.moveSpriteTo(e,o,{duration:.25,overshoot:10,returnDuration:.4}),await t.backgroundFlash(r,100),await Promise.all([t.showSpriteEffect("water",o,{scale:2,duration:400,tint:r,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(o,{intensity:18,color:r}),t.screenShake(12,250)])}async function j(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);await t.screenShake(15,300),await Promise.all([t.showSpriteEffect("rock",r,{hueRotate:i,scale:1.8,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.showSpriteEffect("impact",r,{hueRotate:i,scale:1.5,tint:c,zIndex:t.getEffectZIndex(e.slot)-1}),t.screenShake(18,400),t.flashSprite(r,c,150)])}async function K(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o),n=e.homePosition?.scale??1,l=e.element.getBoundingClientRect(),h=r.element.getBoundingClientRect(),p=h.left-l.left,m=h.top-l.top,f=Math.sqrt(p*p+m*m),w=Math.max(0,f-15),y=f>0?w/f:0,S=p*y,T=m*y;await new Promise(E=>{u.to(e.element,{y:-80,scale:n*.9,duration:.25,ease:"power2.out",onComplete:E})}),await t.wait(80),await new Promise(E=>{u.to(e.element,{x:S,y:T,scale:n,duration:.12,ease:"power4.in",onComplete:E})});const v=Promise.all([t.showSpriteEffect("wind",r,{hueRotate:i,scale:1.4,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:12,color:c}),t.screenShake(8,200)]),b=new Promise(E=>{u.to(e.element,{x:0,y:0,scale:n,duration:.3,ease:"power2.out",onComplete:E})});await Promise.all([v,b]),t.resetSpriteToHome(e)}const J=["mega-punch","fire-punch","ice-punch","thunder-punch","mach-punch","focus-punch","dynamic-punch","drain-punch","power-up-punch","sky-uppercut","bullet-punch","shadow-punch","meteor-mash","hammer-arm","sucker-punch","plasma-fists"],$=["mega-kick","jump-kick","rolling-kick","hi-jump-kick","low-kick","blaze-kick","stomp","double-kick","low-sweep","high-horsepower","pyro-ball"],tt=["cut","slash","fury-cutter","night-slash","x-scissor","psycho-cut","leaf-blade","air-slash","razor-shell","sacred-sword","secret-sword","smart-strike","solar-blade","behemoth-blade","wicked-blow"],et=["scratch","shadow-claw","dragon-claw","metal-claw","crush-claw","fury-swipes","aerial-ace"],at=["bite","crunch","fire-fang","ice-fang","thunder-fang","poison-fang","hyper-fang","super-fang","psychic-fangs","fishious-rend","jaw-lock","clamp"],ot=["tackle","body-slam","take-down","double-edge","headbutt","slam","quick-attack","extreme-speed","rollout","rapid-spin","facade","return","frustration","horn-attack","peck","drill-peck","wing-attack","brave-bird","head-smash","iron-head","zen-headbutt","skull-bash","wild-charge","volt-tackle","flare-blitz","giga-impact","last-resort","retaliate","head-charge","raging-bull","collision-course","lunge","steamroller","first-impression","pursuit","payback","feint-attack","thief","punishment","reversal","seismic-toss","wake-up-slap","flying-press","submission","circle-throw","vital-throw","storm-throw","astonish","lick","shadow-bone","ice-ball","avalanche","flail","endeavor","rock-climb","feint","chip-away","thrash","fake-out","smelling-salts","secret-power","heart-stamp"],st=["karate-chop","brick-break","cross-chop","dual-chop","throat-chop"],rt=["liquidation","waterfall","flip-turn"],it=["crabhammer","jet-punch"],ct=["aqua-tail"],nt=["aqua-jet","aqua-step"],lt=["wave-crash","dive"],ht=["sand-tomb","dig","stomping-tantrum","bone-club","bonemerang"],ft=["fly","sky-attack"];J.forEach(t=>{g[t]=W});$.forEach(t=>{g[t]=D});tt.forEach(t=>{g[t]=V});et.forEach(t=>{g[t]=Y});at.forEach(t=>{g[t]=F});ot.forEach(t=>{g[t]=U});st.forEach(t=>{g[t]=q});rt.forEach(t=>{g[t]=G});it.forEach(t=>{g[t]=_});ct.forEach(t=>{g[t]=N});nt.forEach(t=>{g[t]=Q});lt.forEach(t=>{g[t]=X});ht.forEach(t=>{g[t]=j});ft.forEach(t=>{g[t]=K});function fe(t){Object.entries(g).forEach(([a,e])=>{t.registerMove(a,e)})}const A={},x={fire:"fire",water:"water",electric:"thunder",grass:"leaf",ice:"ice",psychic:"lightball",poison:"poison",rock:"rock",ghost:"shadowball",dragon:"fire",dark:"shadowball",fairy:"lightball",fighting:"impact",ground:"rock",flying:"wind",bug:"leaf",steel:"impact",normal:"impact"};async function pt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);await t.backgroundFlash(c,100);const n=x[o.toLowerCase()]??"impact";for(let l=0;l<3;l++)t.showSpriteEffect(n,r,{hueRotate:i,scale:1+l*.2,duration:150,tint:c,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(50);await t.wait(100),await Promise.all([t.shake(r.element,10,200),t.flashSprite(r,c,150)])}async function dt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=x[o.toLowerCase()]??"impact",n=t.getTypeColor(o);await t.showSpriteEffect(c,e,{hueRotate:i,scale:.8,duration:100,tint:n,zIndex:t.getEffectZIndex(e.slot)});const l=document.createElement("div");l.style.cssText=`
		position: absolute;
		width: 40px;
		height: 40px;
		border-radius: 50%;
		background: radial-gradient(circle, ${n} 0%, transparent 70%);
		filter: hue-rotate(${i}deg) blur(2px);
		z-index: 100;
	`;const h=e.element.getBoundingClientRect(),p=r.element.getBoundingClientRect(),m=e.element.closest(".battle-scene"),f=m?.getBoundingClientRect()??{left:0,top:0};l.style.left=`${h.left-f.left+h.width/2}px`,l.style.top=`${h.top-f.top+h.height/2}px`,m?.appendChild(l),await new Promise(w=>{u.to(l,{left:p.left-f.left+p.width/2,top:p.top-f.top+p.height/2,duration:.3,ease:"power2.in",onComplete:()=>{l.remove(),w()}})}),await Promise.all([t.showSpriteEffect(c,r,{hueRotate:i,scale:1.2,tint:n,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:8,color:n})])}async function mt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s:[s],i=d[o]??0,c=x[o.toLowerCase()]??"impact",n=t.getTypeColor(o);await t.backgroundFlash(n,150);const l=r.map(async h=>{await t.showSpriteEffect(c,h,{hueRotate:i,scale:2,duration:400,tint:n,zIndex:t.getEffectZIndex(e.slot)}),await t.showImpact(h,{intensity:15,color:n})});await Promise.all([...l,t.screenShake(12,300)])}async function ut(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=x[o.toLowerCase()]??"psychic",n=t.getTypeColor(o);for(let l=0;l<4;l++)t.showSpriteEffect(c,r,{hueRotate:i,scale:.8+l*.3,opacity:1-l*.2,duration:200,tint:n,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(80);await Promise.all([t.shake(r.element,8,250),t.flashSprite(r,n,100)])}async function wt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);await t.showSpriteEffect("psychic",r,{hueRotate:i,scale:1.2,tint:c,zIndex:t.getEffectZIndex(e.slot)}),await t.shake(r.element,6,150);for(let n=0;n<3;n++){const l=document.createElement("div");l.style.cssText=`
			position: absolute;
			width: 20px;
			height: 20px;
			border-radius: 50%;
			background: radial-gradient(circle, ${c} 0%, transparent 70%);
			z-index: 100;
		`;const h=r.element.getBoundingClientRect(),p=e.element.getBoundingClientRect(),m=r.element.closest(".battle-scene"),f=m?.getBoundingClientRect()??{left:0,top:0};l.style.left=`${h.left-f.left+h.width/2+(n-1)*20}px`,l.style.top=`${h.top-f.top+h.height/2}px`,m?.appendChild(l),u.to(l,{left:p.left-f.left+p.width/2,top:p.top-f.top+p.height/2,duration:.5,delay:n*.1,ease:"power2.inOut",onComplete:()=>l.remove()})}await t.wait(600),await t.flashSprite(e,"#66ff66",150)}async function yt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);for(let n=0;n<3;n++)t.showSpriteEffect("wind",e,{hueRotate:i,scale:1+n*.5,opacity:1-n*.25,duration:200,tint:c,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(100);await t.wait(50),await Promise.all([t.showSpriteEffect("wind",r,{hueRotate:i,scale:1.5,tint:c,zIndex:t.getEffectZIndex(e.slot)}),t.shake(r.element,10,250),t.flashSprite(r,c,100)])}async function gt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=x[o.toLowerCase()]??"fire",n=t.getTypeColor(o);await t.showSpriteEffect(c,e,{hueRotate:i,scale:.8,duration:150,tint:n,zIndex:t.getEffectZIndex(e.slot)}),await t.backgroundFlash(n,80);for(let l=0;l<4;l++)t.showSpriteEffect(c,r,{hueRotate:i,scale:1.2+l*.25,duration:180,tint:n,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(40);await Promise.all([t.shake(r.element,12,300),t.flashSprite(r,n,150)])}async function At(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=x[o.toLowerCase()]??"leaf",n=t.getTypeColor(o);t.showSpriteEffect(c,e,{hueRotate:i,scale:.7,opacity:.8,duration:200,tint:n,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(150);for(let l=0;l<3;l++)t.showSpriteEffect(c,r,{hueRotate:i,scale:.6+l*.2,opacity:.9-l*.2,duration:250,tint:n,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(120);await t.flashSprite(r,n,100)}async function Et(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=x[o.toLowerCase()]??"rock",n=t.getTypeColor(o);await t.showSpriteEffect(c,e,{hueRotate:i,scale:.6,duration:100,tint:n,zIndex:t.getEffectZIndex(e.slot)});const l=document.createElement("div");l.style.cssText=`
		position: absolute;
		width: 35px;
		height: 35px;
		border-radius: 50%;
		background: radial-gradient(circle, ${n} 0%, transparent 70%);
		filter: hue-rotate(${i}deg) blur(1px);
		z-index: 100;
	`;const h=e.element.getBoundingClientRect(),p=r.element.getBoundingClientRect(),m=e.element.closest(".battle-scene"),f=m?.getBoundingClientRect()??{left:0,top:0},w=h.left-f.left+h.width/2,y=h.top-f.top+h.height/2,S=p.left-f.left+p.width/2,T=p.top-f.top+p.height/2;l.style.left=`${w}px`,l.style.top=`${y}px`,m?.appendChild(l);const v=Math.min(y,T)-60;await new Promise(b=>{u.timeline({onComplete:()=>{l.remove(),b()}}).to(l,{left:(w+S)/2,top:v,duration:.2,ease:"power2.out"}).to(l,{left:S,top:T,duration:.15,ease:"power2.in"})}),await Promise.all([t.showSpriteEffect(c,r,{hueRotate:i,scale:1.3,tint:n,zIndex:t.getEffectZIndex(e.slot)}),t.showImpact(r,{intensity:10,color:n})])}const bt=["hyper-beam","solar-beam","ice-beam","aurora-beam","psybeam","bubble-beam","signal-beam","charge-beam","flash-cannon","dragon-pulse","dark-pulse","water-pulse","aura-sphere","focus-blast","energy-ball","shadow-ball","sludge-bomb","moonblast","dazzling-gleam","power-gem","tri-attack","techno-blast","judgment","doom-desire","origin-pulse","prismatic-laser","photon-geyser","meteor-beam","eternabeam","dragon-rage","fleur-cannon","earth-power","acid-spray","freezing-glare"],kt=["ember","flamethrower","fire-blast","water-gun","hydro-pump","thunderbolt","thunder","ice-shard","seed-bomb","sludge","acid","poison-jab","gunk-shot","rock-slide","stone-edge","ancient-power","muddy-water","surf","scald","brine","whirlpool","flame-burst","lava-plume","eruption","water-spout","draco-meteor","infestation","fairy-wind","mud-slap","mud-shot","icy-wind","wring-out","spit-up","trump-card","hidden-power","shell-side-arm","mirror-shot","powder-snow"],St=["explosion","self-destruct","mind-blown","misty-explosion","earthquake","magnitude","bulldoze","discharge","heat-wave","blizzard","hurricane","twister","ominous-wind","silver-wind","petal-blizzard","petal-dance","fiery-dance","shell-trap"],xt=["psychic","psyshock","stored-power","extrasensory","confusion","night-shade","hex","shadow-sneak","shadow-force","phantom-force","poltergeist","spirit-shackle","spectral-thief","mirror-coat","future-sight","psywave"],Ct=["absorb","mega-drain","giga-drain","leech-life","draining-kiss","horn-leech","parabolic-charge","oblivion-wing","dream-eater"],Tt=["snarl","disarming-voice","uproar","snore","echoed-voice","boomburst","eerie-spell","sparkling-aria"],vt=["fiery-wrath"],It=["electroweb"],Rt=["fling","mud-bomb","present","egg-bomb","rock-wrecker","diamond-storm"];bt.forEach(t=>{A[t]=pt});kt.forEach(t=>{A[t]=dt});St.forEach(t=>{A[t]=mt});xt.forEach(t=>{A[t]=ut});Ct.forEach(t=>{A[t]=wt});Tt.forEach(t=>{A[t]=yt});vt.forEach(t=>{A[t]=gt});It.forEach(t=>{A[t]=At});Rt.forEach(t=>{A[t]=Et});function pe(t){Object.entries(A).forEach(([a,e])=>{t.registerMove(a,e)})}const C={};async function Mt(t,a){const{attacker:e,moveType:s}=a,o=d[s]??0,r=t.getTypeColor(s);await t.pulseScale(e,1.15,300);for(let i=0;i<3;i++)t.showSpriteEffect("buff",e,{hueRotate:o,scale:.8+i*.2,opacity:1-i*.3,duration:250,tint:r,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(100);await t.flashSprite(e,r,150)}async function zt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);await t.showSpriteEffect("debuff",r,{hueRotate:i,scale:1.2,tint:c,zIndex:t.getEffectZIndex(e.slot)}),await new Promise(n=>{u.to(r.element,{filter:"brightness(0.7) saturate(0.8)",duration:.2,onComplete:()=>{u.to(r.element,{filter:"brightness(1) saturate(1)",duration:.3,onComplete:n})}})})}async function Ot(t,a){const{attacker:e}=a,s="#66ff88";for(let o=0;o<4;o++)t.showSpriteEffect("heal",e,{scale:.6+o*.15,opacity:1-o*.2,duration:200,tint:s,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(80);await t.flashSprite(e,s,200),await t.pulseScale(e,1.08,250)}async function Pt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);await t.showSpriteEffect("psychic",r,{hueRotate:i,scale:1.3,tint:c,zIndex:t.getEffectZIndex(e.slot)}),await new Promise(n=>{u.timeline({onComplete:n}).to(r.element,{filter:`drop-shadow(0 0 8px ${c}) brightness(1.3)`,duration:.15}).to(r.element,{filter:"none",duration:.15}).to(r.element,{filter:`drop-shadow(0 0 8px ${c}) brightness(1.3)`,duration:.15}).to(r.element,{filter:"none",duration:.15})})}async function Ht(t,a){const{attacker:e}=a,s=document.createElement("div");s.style.cssText=`
		position: absolute;
		width: 120px;
		height: 120px;
		border-radius: 50%;
		border: 4px solid rgba(100, 200, 255, 0.8);
		background: radial-gradient(circle, rgba(100, 200, 255, 0.3) 0%, transparent 70%);
		z-index: 100;
		transform: scale(0);
	`;const o=e.element.getBoundingClientRect(),r=e.element.closest(".battle-scene"),i=r?.getBoundingClientRect()??{left:0,top:0};s.style.left=`${o.left-i.left+o.width/2-60}px`,s.style.top=`${o.top-i.top+o.height/2-60}px`,r?.appendChild(s),await new Promise(c=>{u.timeline({onComplete:c}).to(s,{scale:1,opacity:1,duration:.2,ease:"back.out"}).to(s,{opacity:.6,duration:.3}).to(s,{scale:1.2,opacity:0,duration:.3,onComplete:()=>s.remove()})})}async function Bt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=d[o]??0,c=t.getTypeColor(o);await t.showSpriteEffect("leaf",e,{hueRotate:i,scale:.8,duration:150,tint:c,zIndex:t.getEffectZIndex(e.slot)});for(let n=0;n<2;n++)await t.showSpriteEffect("slash",r,{hueRotate:i,scale:1.2+n*.2,tint:c,zIndex:t.getEffectZIndex(e.slot)}),await t.wait(60);await Promise.all([t.shake(r.element,8,200),t.flashSprite(r,c,100)])}const Zt=["swords-dance","dragon-dance","calm-mind","bulk-up","nasty-plot","agility","rock-polish","shell-smash","quiver-dance","coil","hone-claws","work-up","curse","shift-gear","cotton-guard","iron-defense","acid-armor","barrier","amnesia","cosmic-power","defend-order","stockpile","double-team","autotomize","charge","focus-energy","meditate","sharpen","acupressure","geomancy","extreme-evoboost","switcheroo","tailwind","mirror-move","mud-sport","rototiller","copycat","camouflage","helping-hand","splash","psych-up","sleep-talk","bestow","pain-split","assist","metronome","recycle","follow-me","mimic","magic-room","role-play","ally-switch","power-trick","trick","speed-swap","teleport","gravity","trick-room","psycho-shift","heart-swap","aromatic-mist","haze"],Lt=["growl","leer","tail-whip","string-shot","sand-attack","smokescreen","flash","kinesis","sweet-scent","scary-face","cotton-spore","fake-tears","metal-sound","screech","charm","feather-dance","captivate","memento","parting-shot","noble-roar","play-nice","baby-doll-eyes","tearful-look","tickle","venom-drench","quash","roar"],Wt=["recover","soft-boiled","milk-drink","slack-off","roost","moonlight","morning-sun","synthesis","wish","heal-order","shore-up","rest","aqua-ring","ingrain","leech-seed","strength-sap","life-dew","floral-healing","heal-pulse","pollen-puff","jungle-healing","aromatherapy","refresh","swallow","healing-wish"],Dt=["thunder-wave","stun-spore","glare","nuzzle","zap-cannon","will-o-wisp","toxic","poison-powder","poison-gas","sleep-powder","hypnosis","sing","lovely-kiss","grass-whistle","spore","yawn","dark-void","confuse-ray","supersonic","swagger","flatter","teeter-dance","attract","encore","taunt","torment","disable","spite","grudge","destiny-bond","perish-song","sweet-kiss","nightmare","spider-web","block","mean-look"],Vt=["protect","detect","endure","wide-guard","quick-guard","kings-shield","spiky-shield","baneful-bunker","obstruct","max-guard","crafty-shield","mat-block","light-screen","reflect","aurora-veil","safeguard","mist","substitute","magic-coat"],Yt=["branch-poke","bind","constrict","wrap"];Zt.forEach(t=>{C[t]=Mt});Lt.forEach(t=>{C[t]=zt});Wt.forEach(t=>{C[t]=Ot});Dt.forEach(t=>{C[t]=Pt});Vt.forEach(t=>{C[t]=Ht});Yt.forEach(t=>{C[t]=Bt});function de(t){Object.entries(C).forEach(([a,e])=>{t.registerMove(a,e)})}const Ft=""+new URL("caltrop-B7Xq7-yd.png",import.meta.url).href,Ut=""+new URL("poisoncaltrop-BeMreEgE.png",import.meta.url).href,qt=""+new URL("web-BVRfnZd6.png",import.meta.url).href,Gt="data:image/png;base64,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",k={};async function _t(t,a){const{attacker:e,defender:s,moveType:o,hitCount:r}=a,i=Array.isArray(s)?s[0]:s,c=d[o]??0,n=t.getTypeColor(o),l=r??3;for(let h=0;h<l;h++)await t.moveSpriteTo(e,i,{duration:.1,overshoot:25}),await t.showSpriteEffect("impact",i,{hueRotate:c,scale:.8+h*.1,tint:n,zIndex:t.getEffectZIndex(e.slot)}),await t.shake(i.element,5,80),await t.wait(50)}async function Nt(t,a){const{attacker:e,defender:s,moveType:o}=a,r=Array.isArray(s)?s[0]:s,i=t.getTypeColor(o);await t.backgroundFlash("#ffffff",200),await t.moveSpriteTo(e,r,{duration:.3,easing:"power4.in",overshoot:5}),await Promise.all([t.showSpriteEffect("impact",r,{scale:2.5,duration:500,tint:i,zIndex:t.getEffectZIndex(e.slot)}),t.screenShake(20,500),t.flashSprite(r,i,300)]),await new Promise(c=>{u.to(r.element,{filter:"brightness(3) contrast(2)",duration:.2,onComplete:()=>{u.to(r.element,{filter:"none",duration:.3,onComplete:c})}})})}const Qt=["spikes","toxic-spikes","stealth-rock","sticky-web"],Xt={spikes:Ft,"stealth-rock":Gt,"toxic-spikes":Ut,"sticky-web":qt};async function jt(t,a){const{attacker:e,moveName:s}=a,o=s.toLowerCase(),r=Xt[o];if(!r)return;const i=document.querySelector(".battle-scene");if(!i)return;const c=i.getBoundingClientRect();let n,l;const h=e.slot.side==="player";if(e.element){const w=e.element.getBoundingClientRect();n=w.left-c.left+w.width/2,l=w.top-c.top+w.height/2}else n=h?c.width*.25:c.width*.75,l=c.height*.6;const p=h?c.width*.75:c.width*.25,m=c.height*.75,f=document.createElement("img");f.src=r,f.style.cssText=`
		position: absolute;
		left: ${n}px;
		top: ${l}px;
		width: 40px;
		height: 40px;
		pointer-events: none;
		z-index: 1000;
		transform: translate(-50%, -50%);
	`,i.appendChild(f),await new Promise(w=>{u.to(f,{left:p,top:m,duration:.4,ease:"power2.in",onComplete:()=>{f.remove(),w()}})}),await t.screenShake(3,150)}async function Kt(t,a){const{attacker:e,defender:s,moveType:o,moveName:r}=a,i=d[o]??0,c=t.getTypeColor(o),n=r.toLowerCase();if(Qt.includes(n)){await jt(t,a);return}const h=s&&!Array.isArray(s)?s:e;await t.showSpriteEffect("rock",h,{hueRotate:i,scale:1.5,tint:c,zIndex:t.getEffectZIndex(h.slot)}),await t.backgroundFlash(c,150),await t.screenShake(5,200)}async function Jt(t,a){const{attacker:e}=a,s=e.homePosition?.scale??1;await new Promise(o=>{u.timeline({onComplete:o}).to(e.element,{filter:"brightness(3)",scale:s*.8,duration:.2}).to(e.element,{filter:"brightness(5)",scale:s*1.2,duration:.15}).to(e.element,{filter:"brightness(1)",scale:s,duration:.25})})}async function $t(t,a){const{moveName:e}=a,o={"rain-dance":"#4488cc","sunny-day":"#ffaa33",sandstorm:"#ccaa66",hail:"#aaddff",snowscape:"#cceeFF"}[e]??"#888888";await t.backgroundFlash(o,400);for(let r=0;r<5;r++)await t.wait(80),await t.backgroundFlash(o,100)}async function te(t,a){const{moveName:e}=a,o={"electric-terrain":"#ffee55","grassy-terrain":"#66cc66","psychic-terrain":"#ff88cc","misty-terrain":"#ffaaff"}[e]??"#888888";await t.backgroundFlash(o,300),await t.screenShake(3,200),await t.backgroundFlash(o,200)}async function ee(t,a){const{attacker:e,moveName:s}=a,o=e.homePosition?.scale??1;["minimize"].includes(s)?await new Promise(i=>{u.timeline({onComplete:i}).to(e.element,{scale:o*.6,duration:.3,ease:"power2.in"}).to(e.element,{scale:o*.7,duration:.1}).to(e.element,{scale:o,duration:.2,ease:"power2.out"})}):(await t.pulseScale(e,o*1.25,400),await t.showSpriteEffect("buff",e,{scale:1.3,tint:"#ffcc00",zIndex:t.getEffectZIndex(e.slot)}))}const ae=["growth","belly-drum","minimize"],oe=["double-slap","comet-punch","fury-attack","pin-missile","spike-cannon","barrage","bone-rush","arm-thrust","bullet-seed","icicle-spear","rock-blast","water-shuriken","tail-slap","triple-kick","triple-axel","scale-shot","dual-wingbeat","surging-strikes","twineedle","gear-grind"],se=["guillotine","horn-drill","fissure","sheer-cold"],re=["spikes","toxic-spikes","stealth-rock","sticky-web","defog","court-change"],ie=["transform","ditto"],ce=["rain-dance","sunny-day","sandstorm","hail","snowscape"],ne=["electric-terrain","grassy-terrain","psychic-terrain","misty-terrain"];oe.forEach(t=>{k[t]=_t});se.forEach(t=>{k[t]=Nt});re.forEach(t=>{k[t]=Kt});ie.forEach(t=>{k[t]=Jt});ce.forEach(t=>{k[t]=$t});ne.forEach(t=>{k[t]=te});ae.forEach(t=>{k[t]=ee});function me(t){Object.entries(k).forEach(([a,e])=>{t.registerMove(a,e)})}export{he as A,M as T,pe as a,de as b,me as c,Gt as d,Ft as e,Ut as p,fe as r,qt as w};
